# 数组

之前介绍整数类型、浮点类型只能存储单个数据，C语言也提供聚合类型，编译器会为其分配一段连续的空间，用于存储多个数据。聚合类型分为数组和结构，这里只介绍数组。

声明一个数组后，编译器会根据数组的元素的大小与元素个数，分配一段连续的空间用于存储这个数组的元素，因此，数组只能用于存储相同数据类型。从逻辑上来讲，数组分为两类：

- 一维数组：逻辑上将多个元素排为一行。**画图**
- 多维数组：逻辑上将多个元素分为多个维度进行存储。**画图**

但是在内存中，不论多少个维度，其实际是一个以行为标准存储的一维数组。**画图**

## 一维数组

-  声明：`int arr[10];`，`int`代表数组中元素的类型，`10`代表数组中元素的个数，数组个数需要为一直常量表达式。
  - 通过这个声明，编译器会去分配一段能存储10个`int`型数据的内存，然后使用标识符`arr`来指向这段内存空间，这里需要重点声明一点，**数组名不是指针**，只是在某些情况下数组名会退化为指向数组第一个元素的指针。不会发生退化的情况如下：
    - `sizeof`：计算数组大小。
    - `&`：求地址。
    - 使用字符串字面量初始化数组
  - 验证：先提前引入定义指针的方法。

```c
#include<stdio.h>

int main(void){
    int arr[10];
    //创建一个指向整型数据的指针
    int * point;    
    printf("%lu\n",sizeof(arr));
    printf("%lu\n",sizeof(point));

    // 将指针point指向数组的第一个元素
    point = arr;
    printf("%d\n",arr[0]);
    printf("%d\n",point[0]);
}
```

- 数组访问：采用下标进行访问，**下标的起始值为0**，其界限为`0~n-1`，如果下标超出范围，则会出现不可位置的行为。

```c
#include<stdio.h>

int main(void){
    int arr[4];
    int i;
    for(i=0;i<4;i++){
        printf("%d\n",arr[i]);
    }
}

// 越界行为，极大可能性会出现无限循环
#include<stdio.h>

int main(void){
    int arr[4];
    int i;
// 这里由于编译器为i分配的空间在arr[3]元素之后
// 所以若数组arr和元素i分配在一端连续的空间上
// arr[4]访问的内存就是i所在的内存
    for(i=0;i<=4;i++){
        printf("%d\n",arr[i]);
        arr[i]=0;
    }
}
```

- 数组初始化：
  - 显示初始化：`int arr[5]={0,1,2,3,4}`
  - 不指定长度初始化：`int arr[]={0,1,2,3,4}`
  - 当初始化元素个数小于长度时，剩余值默认初始化为`0`：`int arr[5]={0}`
  - 采用初始化指示器：`int arr[5]={[3]=4}`，将`arr[3]`赋值为`4`

```c
#include<stdio.h>

int main(void){
    // 显示初始化
    int arr[5]={0,1,2,3,4};
    int i;
    printf("arr:\n");
    for(i=0;i<5;i++){
        printf("%d\n",arr[i]);
    }
    // 不指定长度
    int brr[]={0,1,2,3,4};
    printf("brr:\n");
    for(i=0;i<5;i++){
        printf("%d\n",brr[i]);
    }
    // 初始化元素个数小于长度
    int crr[5]={0,1};
    printf("crr:\n");
    for(i=0;i<5;i++){
        printf("%d\n",crr[i]);
    }
    // 初始化指示器
    int drr[5]={[3]=4};
    printf("drr:\n");
    for(i=0;i<5;i++){
        printf("%d\n",drr[i]);
    }
}
```

## 多维数组

- 声明(以二维数组为例)：`int arr[5][4]`
  - 说明：创建一个逻辑上5行4列的二维数组，其实际在内存中使用一段能存储20个`int`元素的连续空间。
- 初始化
  - 显示初始化：嵌套一维数组初始化。
  - 采用初始化指示器。

```c
#include<stdio.h>

int main(void){
    // 显示初始化
    int arr[2][4]={
        {0,1,2,3},
        {4,5,6,7}
        };
    int i,j;
    printf("arr:\n");
    for(i=0;i<2;i++){
        for(j=0;j<4;j++){
            printf("%d\t",arr[i][j]);
        }
        printf("\n");
    }
    // 行初始化元素个数小于行长度
    int brr[2][4]={
        {0,1,2},
        {4,5,}
        };
    printf("brr:\n");
    for(i=0;i<2;i++){
        for(j=0;j<4;j++){
            printf("%d\t",brr[i][j]);
        }
        printf("\n");
    }
    // 初始化指示器
    int crr[2][4]={
        [0][1]=3,[1][2]=2
        };
    printf("crr:\n");
    for(i=0;i<2;i++){
        for(j=0;j<4;j++){
            printf("%d\t",crr[i][j]);
        }
        printf("\n");
    }
}

```

- 访问：下标访问。

## 变长数组

- 前面两节要求数组的长度必须是一个常量表达式，但是如果由编程人员来指定长度，则可能出现长度过长浪费空间、长度太短不够用的情况，因此`C99`标准提供变长数组，在运行时创建。
- 声明：`int arr[n]`，`n`为变量或表达式。

