(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{3160:function(e,t,n){"use strict";n.r(t);var r={};n.d(r,"acquireNoteLock",function(){return y}),n.d(r,"authenticateToSharedNotebook",function(){return x}),n.d(r,"copyNote",function(){return N}),n.d(r,"createLinkedNotebook",function(){return L}),n.d(r,"createNote",function(){return j}),n.d(r,"createNotebook",function(){return U}),n.d(r,"createOrUpdateNotebookShares",function(){return W}),n.d(r,"createOrUpdateSharedNotes",function(){return M}),n.d(r,"createTag",function(){return B}),n.d(r,"deleteNote",function(){return Y}),n.d(r,"expungeLinkedNotebook",function(){return X}),n.d(r,"expungeNote",function(){return Z}),n.d(r,"expungeNotes",function(){return te}),n.d(r,"expungeNotebook",function(){return oe}),n.d(r,"expungeTag",function(){return ie}),n.d(r,"filteredSearch",function(){return pe}),n.d(r,"findNotesMetadata",function(){return he}),n.d(r,"findSearchSuggestionsV2",function(){return me}),n.d(r,"findNoteCounts",function(){return ye}),n.d(r,"getDefaultNotebook",function(){return xe}),n.d(r,"getUserNotebook",function(){return Ne}),n.d(r,"getFilteredSyncChunk",function(){return Le}),n.d(r,"getNoteTagNames",function(){return je}),n.d(r,"getNoteLockStatus",function(){return Ue}),n.d(r,"getNoteSnippets",function(){return We}),n.d(r,"getNoteWithResultSpec",function(){return Me}),n.d(r,"getNotebook",function(){return Be}),n.d(r,"getNotebookShares",function(){return Ye}),n.d(r,"getNoteShares",function(){return Xe}),n.d(r,"getOrCreateLinkedNotebook",function(){return Ze}),n.d(r,"getPreferences",function(){return tt}),n.d(r,"getSharedNotebookByAuth",function(){return ot}),n.d(r,"getSyncState",function(){return it}),n.d(r,"getSyncStateWithMetrics",function(){return pt}),n.d(r,"getWorkspaceUserInterfaceProperties",function(){return ht}),n.d(r,"setWorkspaceUserInterfaceLayoutStyle",function(){return mt}),n.d(r,"setNoteUserInterfaceDisplayOrder",function(){return yt}),n.d(r,"setNotebookUserInterfaceDisplayOrder",function(){return kt}),n.d(r,"setNotebookUserInterfaceColors",function(){return Nt}),n.d(r,"listAccessibleBusinessNotebooks",function(){return Lt}),n.d(r,"listLinkedNotebooks",function(){return jt}),n.d(r,"listNotebooks",function(){return Ut}),n.d(r,"listPublishedBusinessNotebooks",function(){return Wt}),n.d(r,"listSharedNotebooks",function(){return Mt}),n.d(r,"listTags",function(){return Bt}),n.d(r,"listTagsByNotebook",function(){return Yt}),n.d(r,"manageNotebookShares",function(){return Xt}),n.d(r,"manageNoteShares",function(){return Zt}),n.d(r,"releaseNoteLock",function(){return tn}),n.d(r,"renameNotebook",function(){return on}),n.d(r,"sendLogRequest",function(){return cn}),n.d(r,"setNotebookRecipientSettings",function(){return fn}),n.d(r,"shareNote",function(){return vn}),n.d(r,"stopSharingNote",function(){return gn}),n.d(r,"updateNoteIfUsnMatches",function(){return wn}),n.d(r,"updateNotebook",function(){return Rn}),n.d(r,"updatePreferences",function(){return Sn}),n.d(r,"updateTag",function(){return Tn});var o=n(370),a=n(655),u=n(74),i=n(22),c=n(488),s=n(389),p=n(107),f=n(566),l=n(1024);function h(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function v(e,t){var n=p.a.register("business.sso.start",function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){h(a,r,o,u,i,"next",e)}function i(e){h(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function r(){var o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=function(){p.a.publish("business.sso.invalid"),t(new Error("BusinessSecurityLoginFailure")),n()},o=function(){p.a.publish("business.sso.valid"),Object(f.b)(e,t),n()},Object(l.a)(o,a),r.abrupt("return",Promise.resolve());case 4:case"end":return r.stop()}},r)})))}var d=function(e){if(!(e instanceof s.EDAMUserException))return!0;switch(e.errorCode){case s.EDAMErrorCode.AUTH_EXPIRED:case s.EDAMErrorCode.INVALID_AUTH:return Object(o.e)(),!1;case s.EDAMErrorCode.BUSINESS_SECURITY_LOGIN_REQUIRED:return v(function(e){var t=e.shardId,n=e.id;p.a.publish("user","setvaultuser",n),p.a.publish("user","setBusinessShard",t)},function(e,t){return t===f.a.INACTIVE_BUSINESS&&p.a.publish("app.validuser","isValidUser",!1),!1}),!0;default:return!0}};var m=function(e,t,n){var r=Object(i.default)("ion:rpc:".concat(e,":").concat(t)),o="".concat(e,"#").concat(t);return new Promise(function(e,i){n(function(n,s){n?(r.error(n),Object(c.sendThriftErrorEvent)(o,n),n instanceof u.Exceptions.TransportException&&Object(a.a)(n),d(n)&&i(n)):(r.log(s),Object(a.c)(200),c.RPC_LOG_USAGE_BLACKLIST.includes(t)||Object(c.logUsageSession)(),e(s))})})};function g(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function b(){return(b=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){g(a,r,o,u,i,"next",e)}function i(e){g(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","acquireNoteLock",function(e){return t.acquireNoteLock(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var y=function(e,t,n){return b.apply(this,arguments)};function w(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function k(){return(k=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){w(a,r,o,u,i,"next",e)}function i(e){w(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","authenticateToSharedNotebook",function(e){return t.authenticateToSharedNotebook(n,r||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var x=function(e,t,n){return k.apply(this,arguments)};function R(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function P(){return(P=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){R(a,r,o,u,i,"next",e)}function i(e){R(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","copyNote",function(e){return t.copyNote(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=function(e,t,n,r){return P.apply(this,arguments)};function S(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function O(){return(O=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){S(a,r,o,u,i,"next",e)}function i(e){S(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createLinkedNotebook",function(e){return t.createLinkedNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var L=function(e,t,n){return O.apply(this,arguments)};function T(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function E(){return(E=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){T(a,r,o,u,i,"next",e)}function i(e){T(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createNote",function(e){return t.createNote(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var j=function(e,t,n){return E.apply(this,arguments)};function _(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function I(){return(I=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_(a,r,o,u,i,"next",e)}function i(e){_(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createNotebook",function(e){return t.createNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var U=function(e,t,n){return I.apply(this,arguments)};function C(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function G(){return(G=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){C(a,r,o,u,i,"next",e)}function i(e){C(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createOrUpdateNotebookShares",function(e){return t.createOrUpdateNotebookShares(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var W=function(e,t,n){return G.apply(this,arguments)};function D(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function A(){return(A=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){D(a,r,o,u,i,"next",e)}function i(e){D(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createOrUpdateSharedNotes",function(e){return t.createOrUpdateSharedNotes(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var M=function(e,t,n){return A.apply(this,arguments)};function F(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function q(){return(q=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){F(a,r,o,u,i,"next",e)}function i(e){F(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","createTag",function(e){return t.createTag(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var B=function(e,t,n){return q.apply(this,arguments)};function V(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function H(){return(H=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){V(a,r,o,u,i,"next",e)}function i(e){V(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","deleteNote",function(e){return t.deleteNote(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Y=function(e,t,n){return H.apply(this,arguments)};function J(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function K(){return(K=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){J(a,r,o,u,i,"next",e)}function i(e){J(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","expungeLinkedNotebook",function(e){return t.expungeLinkedNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var X=function(e,t,n){return K.apply(this,arguments)};function z(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Q(){return(Q=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){z(a,r,o,u,i,"next",e)}function i(e){z(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","expungeNote",function(e){return t.expungeNote(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Z=function(e,t,n){return Q.apply(this,arguments)};function $(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ee(){return(ee=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$(a,r,o,u,i,"next",e)}function i(e){$(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","expungeNotes",function(e){return t.expungeNotes(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var te=function(e,t,n){return ee.apply(this,arguments)};function ne(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function re(){return(re=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ne(a,r,o,u,i,"next",e)}function i(e){ne(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","expungeNotebook",function(e){return t.expungeNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var oe=function(e,t,n){return re.apply(this,arguments)};function ae(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ue(){return(ue=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ae(a,r,o,u,i,"next",e)}function i(e){ae(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","expungeTag",function(e){return t.expungeTag(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ie=function(e,t,n){return ue.apply(this,arguments)};function ce(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function se(){return(se=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ce(a,r,o,u,i,"next",e)}function i(e){ce(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","filteredSearch",function(e){return t.filteredSearch(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var pe=function(e,t,n,r){return se.apply(this,arguments)};function fe(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function le(){return(le=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){fe(a,r,o,u,i,"next",e)}function i(e){fe(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a,u,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","findNotesMetadata",function(e){return t.findNotesMetadata(i||Object(o.a)(),n,r,a,u,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var he=function(e,t,n,r,o,a){return le.apply(this,arguments)};function ve(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function de(){return(de=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ve(a,r,o,u,i,"next",e)}function i(e){ve(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","findSearchSuggestionsV2",function(e){return t.findSearchSuggestionsV2(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var me=function(e,t,n){return de.apply(this,arguments)};function ge(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function be(){return(be=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ge(a,r,o,u,i,"next",e)}function i(e){ge(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","findNoteCounts",function(e){return t.findNoteCounts(r||Object(o.a)(),n,!1,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ye=function(e,t,n){return be.apply(this,arguments)};function we(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ke(){return(ke=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){we(a,r,o,u,i,"next",e)}function i(e){we(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getDefaultNotebook",function(e){return t.getDefaultNotebook(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var xe=function(e,t){return ke.apply(this,arguments)};function Re(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Pe(){return(Pe=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Re(a,r,o,u,i,"next",e)}function i(e){Re(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getUserNotebook",function(e){return t.getUserNotebook(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ne=function(e,t){return Pe.apply(this,arguments)};function Se(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Oe(){return(Oe=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Se(a,r,o,u,i,"next",e)}function i(e){Se(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a,u){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getFilteredSyncChunk",function(e){return t.getFilteredSyncChunk(u||Object(o.a)(),n,r,a,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Le=function(e,t,n,r,o){return Oe.apply(this,arguments)};function Te(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ee(){return(Ee=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Te(a,r,o,u,i,"next",e)}function i(e){Te(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNoteTagNames",function(e){return t.getNoteTagNames(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var je=function(e,t,n){return Ee.apply(this,arguments)};function _e(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ie(){return(Ie=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_e(a,r,o,u,i,"next",e)}function i(e){_e(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNoteLockStatus",function(e){return t.getNoteLockStatus(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ue=function(e,t,n){return Ie.apply(this,arguments)};function Ce(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ge(){return(Ge=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ce(a,r,o,u,i,"next",e)}function i(e){Ce(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNoteSnippets",function(e){return t.getNoteSnippets(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var We=function(e,t,n,r){return Ge.apply(this,arguments)};function De(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ae(){return(Ae=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){De(a,r,o,u,i,"next",e)}function i(e){De(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNoteWithResultSpec",function(e){t.getNoteWithResultSpec(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Me=function(e,t,n,r){return Ae.apply(this,arguments)};function Fe(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function qe(){return(qe=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Fe(a,r,o,u,i,"next",e)}function i(e){Fe(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNotebook",function(e){return t.getNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Be=function(e,t,n){return qe.apply(this,arguments)};function Ve(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function He(){return(He=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ve(a,r,o,u,i,"next",e)}function i(e){Ve(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNotebookShares",function(e){return t.getNotebookShares(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ye=function(e,t,n){return He.apply(this,arguments)};function Je(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ke(){return(Ke=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Je(a,r,o,u,i,"next",e)}function i(e){Je(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getNoteShares",function(e){return t.getNoteShares(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Xe=function(e,t,n){return Ke.apply(this,arguments)};function ze(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Qe(){return(Qe=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ze(a,r,o,u,i,"next",e)}function i(e){ze(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getOrCreateLinkedNotebook",function(e){return t.getOrCreateLinkedNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ze=function(e,t,n){return Qe.apply(this,arguments)};function $e(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function et(){return(et=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$e(a,r,o,u,i,"next",e)}function i(e){$e(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getPreferences",function(e){return t.getPreferences(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tt=function(e,t,n){return et.apply(this,arguments)};function nt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function rt(){return(rt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){nt(a,r,o,u,i,"next",e)}function i(e){nt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getSharedNotebookByAuth",function(e){return t.getSharedNotebookByAuth(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ot=function(e,t){return rt.apply(this,arguments)};function at(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ut(){return(ut=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){at(a,r,o,u,i,"next",e)}function i(e){at(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getSyncState",function(e){return t.getSyncState(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var it=function(e,t){return ut.apply(this,arguments)};function ct(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function st(){return(st=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ct(a,r,o,u,i,"next",e)}function i(e){ct(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getSyncStateWithMetrics",function(e){return t.getSyncStateWithMetrics(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var pt=function(e,t,n){return st.apply(this,arguments)};function ft(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function lt(){return(lt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ft(a,r,o,u,i,"next",e)}function i(e){ft(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","getWorkspaceUserInterfaceProperties",function(e){return t.getWorkspaceUserInterfaceProperties(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ht=function(e,t,n){return lt.apply(this,arguments)};function vt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function dt(){return(dt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){vt(a,r,o,u,i,"next",e)}function i(e){vt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","setWorkspaceUserInterfaceLayoutStyle",function(e){return t.setWorkspaceUserInterfaceLayoutStyle(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var mt=function(e,t,n,r){return dt.apply(this,arguments)};function gt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function bt(){return(bt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){gt(a,r,o,u,i,"next",e)}function i(e){gt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","setNoteUserInterfaceDisplayOrder",function(e){return t.setNoteUserInterfaceDisplayOrder(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var yt=function(e,t,n,r){return bt.apply(this,arguments)};function wt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function kt(e,t,n,r){return xt.apply(this,arguments)}function xt(){return(xt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){wt(a,r,o,u,i,"next",e)}function i(e){wt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","setNotebookUserInterfaceDisplayOrder",function(e){return t.setNotebookUserInterfaceDisplayOrder(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Pt(){return(Pt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Rt(a,r,o,u,i,"next",e)}function i(e){Rt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","setNotebookUserInterfaceColors",function(e){return t.setNotebookUserInterfaceColors(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Nt=function(e,t,n,r){return Pt.apply(this,arguments)};function St(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ot(){return(Ot=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){St(a,r,o,u,i,"next",e)}function i(e){St(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listAccessibleBusinessNotebooks",function(e){return t.listAccessibleBusinessNotebooks(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Lt=function(e,t,n){return Ot.apply(this,arguments)};function Tt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Et(){return(Et=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Tt(a,r,o,u,i,"next",e)}function i(e){Tt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listLinkedNotebooks",function(e){return t.listLinkedNotebooks(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var jt=function(e,t){return Et.apply(this,arguments)};function _t(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function It(){return(It=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_t(a,r,o,u,i,"next",e)}function i(e){_t(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listNotebooks",function(e){return t.listNotebooks(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ut=function(e,t){return It.apply(this,arguments)};function Ct(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Gt(){return(Gt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ct(a,r,o,u,i,"next",e)}function i(e){Ct(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listPublishedBusinessNotebooks",function(e){return t.listPublishedBusinessNotebooks(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Wt=function(e,t){return Gt.apply(this,arguments)};function Dt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function At(){return(At=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Dt(a,r,o,u,i,"next",e)}function i(e){Dt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listSharedNotebooks",function(e){return t.listSharedNotebooks(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Mt=function(e,t){return At.apply(this,arguments)};function Ft(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function qt(){return(qt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ft(a,r,o,u,i,"next",e)}function i(e){Ft(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listTags",function(e){return t.listTags(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Bt=function(e,t){return qt.apply(this,arguments)};function Vt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ht(){return(Ht=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Vt(a,r,o,u,i,"next",e)}function i(e){Vt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","listTagsByNotebook",function(e){return t.listTagsByNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Yt=function(e,t,n){return Ht.apply(this,arguments)};function Jt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Kt(){return(Kt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Jt(a,r,o,u,i,"next",e)}function i(e){Jt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","manageNotebookShares",function(e){t.manageNotebookShares(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Xt=function(e,t,n){return Kt.apply(this,arguments)};function zt(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Qt(){return(Qt=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){zt(a,r,o,u,i,"next",e)}function i(e){zt(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","manageNoteShares",function(e){t.manageNoteShares(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Zt=function(e,t,n){return Qt.apply(this,arguments)};function $t(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function en(){return(en=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$t(a,r,o,u,i,"next",e)}function i(e){$t(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","releaseNoteLock",function(e){return t.releaseNoteLock(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tn=function(e,t,n){return en.apply(this,arguments)};function nn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function rn(){return(rn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){nn(a,r,o,u,i,"next",e)}function i(e){nn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","renameNotebook",function(e){t.renameNotebook(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var on=function(e,t,n,r){return rn.apply(this,arguments)};function an(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function un(){return(un=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){an(a,r,o,u,i,"next",e)}function i(e){an(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","sendLogRequest",function(e){return t.sendLogRequest(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var cn=function(e,t,n){return un.apply(this,arguments)};function sn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function pn(){return(pn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){sn(a,r,o,u,i,"next",e)}function i(e){sn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","setNotebookRecipientSettings",function(e){return t.setNotebookRecipientSettings(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var fn=function(e,t,n,r){return pn.apply(this,arguments)};function ln(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function hn(){return(hn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ln(a,r,o,u,i,"next",e)}function i(e){ln(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","shareNote",function(e){return t.shareNote(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var vn=function(e,t,n){return hn.apply(this,arguments)};function dn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function mn(){return(mn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){dn(a,r,o,u,i,"next",e)}function i(e){dn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","stopSharingNote",function(e){return t.stopSharingNote(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var gn=function(e,t,n){return mn.apply(this,arguments)};function bn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function yn(){return(yn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){bn(a,r,o,u,i,"next",e)}function i(e){bn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","updateNoteIfUsnMatches",function(e){return t.updateNoteIfUsnMatches(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var wn=function(e,t,n){return yn.apply(this,arguments)};function kn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function xn(){return(xn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){kn(a,r,o,u,i,"next",e)}function i(e){kn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","updateNotebook",function(e){t.updateNotebook(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Rn=function(e,t,n){return xn.apply(this,arguments)};function Pn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Nn(){return(Nn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Pn(a,r,o,u,i,"next",e)}function i(e){Pn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","updatePreferences",function(e){t.updatePreferences(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Sn=function(e,t,n){return Nn.apply(this,arguments)};function On(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ln(){return(Ln=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){On(a,r,o,u,i,"next",e)}function i(e){On(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("notestore","updateTag",function(e){return t.updateTag(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Tn=function(e,t,n){return Ln.apply(this,arguments)},En=n(383),jn=n(468),_n=n(29);function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Un=Object(_n.b)(),Cn=Un.thriftProtocol,Gn=Un.thriftTransport,Wn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.endpoint=void 0,this.InterfaceConstructor=void 0}return function(e,t,n){t&&In(e.prototype,t),n&&In(e,n)}(e,[{key:"create",value:function(e){var t=Gn(e),n=Cn(t);return this.InterfaceConstructor(n)}},{key:"fromLocator",value:function(e){return this.fromString(jn.a.fromLocator(e,this.endpoint))}},{key:"fromString",value:function(e){var t=this;return new Promise(function(n){n(t.create(e))})}}]),e}();function Dn(e){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function An(e,t){return!t||"object"!==Dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mn(e){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qn=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=An(this,(e=Mn(t)).call.apply(e,[this].concat(o)))).endpoint="notestore",n.InterfaceConstructor=function(e){return new En.NoteStore.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(t,Wn),t}()),Bn=n(372);function Vn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Hn(e){return Yn.apply(this,arguments)}function Yn(){return(Yn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Vn(a,r,o,u,i,"next",e)}function i(e){Vn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.notebookGuid,r=t.notebookIdentifier,o=t.shardId,e.prev=1,a=Bn.a.newPersonalLocator(!0,o,null),e.next=5,qn.fromLocator(a);case 5:return u=e.sent,e.next=8,x(u,r,null);case 8:return i=e.sent,e.abrupt("return",i.authenticationToken);case 12:e.prev=12,e.t0=e.catch(1),n&&p.a.publish("notebook","expungeNotebook",n);case 15:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}var Jn=Hn;function Kn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Xn(){return(Xn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Kn(a,r,o,u,i,"next",e)}function i(e){Kn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","addResource",function(e){return t.addResource(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.authenticateToSharedNotebook",function(e){return Hn(e)});var zn=function(e,t,n){return Xn.apply(this,arguments)};function Qn(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Zn(){return(Zn=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Qn(a,r,o,u,i,"next",e)}function i(e){Qn(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","createWorkspace",function(e){return t.createWorkspace(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $n=function(e,t,n){return Zn.apply(this,arguments)};function er(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function tr(){return(tr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){er(a,r,o,u,i,"next",e)}function i(e){er(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","fileSupportTicket",function(e){return t.fileSupportTicket(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var nr=function(e,t,n){return tr.apply(this,arguments)};function rr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function or(){return(or=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){rr(a,r,o,u,i,"next",e)}function i(e){rr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","getCrossPromotionInfo",function(e){return t.getCrossPromotionInfo(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ar=function(e,t){return or.apply(this,arguments)};function ur(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ir(){return(ir=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ur(a,r,o,u,i,"next",e)}function i(e){ur(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","getPromotionStatus",function(e){return t.getPromotionStatus(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var cr=function(e,t,n){return ir.apply(this,arguments)};function sr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function pr(){return(pr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){sr(a,r,o,u,i,"next",e)}function i(e){sr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","getTsdEligibility",function(e){return t.getTsdEligibility(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var fr=function(e,t,n){return pr.apply(this,arguments)};function lr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function hr(){return(hr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){lr(a,r,o,u,i,"next",e)}function i(e){lr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","getUserRestrictions",function(e){return t.getUserRestrictions(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var vr=function(e,t){return hr.apply(this,arguments)};function dr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function mr(){return(mr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){dr(a,r,o,u,i,"next",e)}function i(e){dr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","getWorkspace",function(e){return t.getWorkspace(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var gr=function(e,t,n,r){return mr.apply(this,arguments)};function br(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function yr(){return(yr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){br(a,r,o,u,i,"next",e)}function i(e){br(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","leaveWorkspace",function(e){t.leaveWorkspace(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var wr=function(e,t,n){return yr.apply(this,arguments)};function kr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function xr(){return(xr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){kr(a,r,o,u,i,"next",e)}function i(e){kr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","listNotebooksForIonOnly",function(e){t.listNotebooksForIonOnly(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Rr=function(e,t){return xr.apply(this,arguments)};function Pr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Nr(){return(Nr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Pr(a,r,o,u,i,"next",e)}function i(e){Pr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","listWorkspacesWithResultSpec",function(e){return t.listWorkspacesWithResultSpec(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Sr=function(e,t,n,r){return Nr.apply(this,arguments)};function Or(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Lr(){return(Lr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Or(a,r,o,u,i,"next",e)}function i(e){Or(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","manageWorkspaceSharing",function(e){return t.manageWorkspaceSharing(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Tr=function(e,t,n){return Lr.apply(this,arguments)};function Er(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function jr(){return(jr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Er(a,r,o,u,i,"next",e)}function i(e){Er(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","moveNotebookToAccount",function(e){return t.moveNotebookToAccount(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _r=function(e,t,n){return jr.apply(this,arguments)};function Ir(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ur(){return(Ur=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ir(a,r,o,u,i,"next",e)}function i(e){Ir(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","promotionOptedOut",function(e){return t.promotionOptedOut(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Cr=function(e,t,n){return Ur.apply(this,arguments)};function Gr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Wr(){return(Wr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Gr(a,r,o,u,i,"next",e)}function i(e){Gr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","promotionsShown",function(e){return t.promotionsShown(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Dr=function(e,t,n){return Wr.apply(this,arguments)};function Ar(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Mr(){return(Mr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ar(a,r,o,u,i,"next",e)}function i(e){Ar(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","sendWorkspaceViewedEvent",function(e){return t.sendWorkspaceViewedEvent(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Fr=function(e,t,n){return Mr.apply(this,arguments)};function qr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Br(){return(Br=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){qr(a,r,o,u,i,"next",e)}function i(e){qr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","sendVerificationEmail",function(e){return t.sendVerificationEmail(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Vr=function(e,t){return Br.apply(this,arguments)};function Hr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Yr(){return(Yr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Hr(a,r,o,u,i,"next",e)}function i(e){Hr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","updateNoteIfUsnMatches",function(e){return t.updateNoteIfUsnMatches(a||Object(o.a)(),n,r,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Jr=function(e,t,n,r){return Yr.apply(this,arguments)};function Kr(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Xr(){return(Xr=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Kr(a,r,o,u,i,"next",e)}function i(e){Kr(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("utility","updateWorkspace",function(e){return t.updateWorkspace(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var zr=function(e,t,n){return Xr.apply(this,arguments)},Qr=n(464);function Zr(e){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e,t){return!t||"object"!==Zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function to(e,t){return(to=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var no=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=$r(this,(e=eo(t)).call.apply(e,[this].concat(o)))).endpoint="utility",n.InterfaceConstructor=function(e){return new Qr.Utility.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&to(e,t)}(t,Wn),t}()),ro=n(384);function oo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ao(e){return uo.apply(this,arguments)}function uo(){return(uo=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){oo(a,r,o,u,i,"next",e)}function i(e){oo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qn.fromLocator(t);case 3:return n=e.sent,e.next=6,Mt(n,t.authenticationToken);case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}var io=ao;function co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){so(e,t,n[t])})}return e}function so(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function po(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function fo(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){po(a,r,o,u,i,"next",e)}function i(e){po(a,r,o,u,i,"throw",e)}u(void 0)})}}function lo(){return ho.apply(this,arguments)}function ho(){return(ho=fo(regeneratorRuntime.mark(function e(){var t,n,r,o,a,u,i,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]&&c[0],e.prev=1,e.next=4,Bn.a.getDefaultLocator();case 4:return n=e.sent,r=[],o=[],a=function(){var e=fo(regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(ro.d)()){e.next=9;break}return e.next=3,no.fromLocator(n);case 3:return t=e.sent,e.next=6,Rr(t,n.authenticationToken);case 6:r=e.sent,e.next=15;break;case 9:return e.next=11,qn.fromLocator(n);case 11:return o=e.sent,e.next=14,Ut(o,n.authenticationToken);case 14:r=e.sent;case 15:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=fo(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,io(n);case 2:o=e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),i=[a()],t&&i.push(u()),e.next=13,Promise.all(i);case 13:return n.isTrueOwner&&(r=r.map(function(e){return co({},e,{isTrueOwner:!0})})),p.a.publish("notebook","updateNotebooks",{notebooks:r,sharedNotebooks:o}),e.abrupt("return",r);case 18:throw e.prev=18,e.t0=e.catch(1),e.t0;case 21:case"end":return e.stop()}},e,null,[[1,18]])}))).apply(this,arguments)}p.a.register("notebook.actions.listShared",ao);var vo=lo;function mo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function go(){return bo.apply(this,arguments)}function bo(){return(bo=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){mo(a,r,o,u,i,"next",e)}function i(e){mo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vo());case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.list",lo);var yo=go;function wo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ko(e,t,n[t])})}return e}function ko(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ro(e){return Po.apply(this,arguments)}function Po(){return(Po=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){xo(a,r,o,u,i,"next",e)}function i(e){xo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.workspaceGuid,r=t.notebook,e.prev=1,null!=n&&null!=r&&null!=r.name){e.next=4;break}throw Error("#createNotebookInWorkspace requires a workspaceGuid and notebook object with a name");case 4:return e.next=6,Bn.a.getLocationForWorkspaceGuid();case 6:return o=e.sent,e.next=9,qn.fromLocator(o);case 9:return a=e.sent,e.next=12,U(a,wo({},r,{workspaceGuid:n}),o.authenticationToken);case 12:return u=e.sent,p.a.publish("notebook","updateNotebook",{notebook:u}),e.abrupt("return",u);case 17:throw e.prev=17,e.t0=e.catch(1),e.t0;case 20:case"end":return e.stop()}},e,null,[[1,17]])}))).apply(this,arguments)}p.a.register("notebook.actions.bootstrapAllNotebooks",go);var No=Ro;function So(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Oo(e,t,n[t])})}return e}function Oo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function To(e){return Eo.apply(this,arguments)}function Eo(){return(Eo=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Lo(a,r,o,u,i,"next",e)}function i(e){Lo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return n=e.sent,e.next=5,qn.fromLocator(n);case 5:return r=e.sent,delete(o=So({},t)).guid,e.next=10,U(r,o,n.authenticationToken);case 10:return a=e.sent,p.a.publish("notebook","updateNotebook",{notebook:So({},a,{isTrueOwner:n.isTrueOwner})}),e.abrupt("return",a);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.createnotebookinworkspace",Ro),p.a.register("notebook.actions.createNotebook",To);var jo=To;function _o(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Io(e){return Uo.apply(this,arguments)}function Uo(){return(Uo=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_o(a,r,o,u,i,"next",e)}function i(e){_o(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return(n=e.sent).personal=!0,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,X(r,t,n.authenticationToken);case 9:p.a.publish("linkednotebook","expungeLinkedNotebook",t);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.expungeLinkedNotebook",Io);var Co=Io,Go=n(377);function Wo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Do(e){return Ao.apply(this,arguments)}function Ao(){return(Ao=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wo(a,r,o,u,i,"next",e)}function i(e){Wo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return n=e.sent,e.next=5,qn.fromLocator(n);case 5:return r=e.sent,e.next=8,oe(r,t,n.authenticationToken);case 8:return o=e.sent,Go.a.isUpSyncDisabled()&&p.a.publish("notebook","expungeNotebook",t),e.abrupt("return",o);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.expungeNotebookService",Do);var Mo=Do;function Fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){qo(e,t,n[t])})}return e}function qo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Vo(e){return Ho.apply(this,arguments)}function Ho(){return(Ho=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Bo(a,r,o,u,i,"next",e)}function i(e){Bo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]&&c[1],e.prev=1,null!=t){e.next=4;break}throw new Error("#getNotebook Guid is required");case 4:return e.next=6,p.a.call("notebook.actions.getnotebook",t);case 6:if(null==(r=e.sent)||n&&!(r.dirtyFlags&&r.dirtyFlags.size>0)){e.next=9;break}return e.abrupt("return",r);case 9:return e.next=11,Bn.a.getLocationForNotebookGuid(t);case 11:return o=e.sent,e.next=14,qn.fromLocator(o);case 14:return a=e.sent,e.next=17,Be(a,t,o.authenticationToken);case 17:return u=e.sent,i=Fo({},u,{isTrueOwner:o.isTrueOwner}),p.a.publish("notebook","updateNotebook",{notebook:i}),e.abrupt("return",i);case 23:throw e.prev=23,e.t0=e.catch(1),e.t0;case 26:case"end":return e.stop()}},e,null,[[1,23]])}))).apply(this,arguments)}var Yo=Vo;function Jo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ko(e){return Xo.apply(this,arguments)}function Xo(){return(Xo=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Jo(a,r,o,u,i,"next",e)}function i(e){Jo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#getNotebookShares Guid is required");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNotebookGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,Ye(r,t,n.authenticationToken);case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(2),e.t0;case 17:case"end":return e.stop()}},e,null,[[2,14]])}))).apply(this,arguments)}p.a.register("notebook.actions.get",Vo);var zo=Ko;function Qo(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Zo(){return $o.apply(this,arguments)}function $o(){return($o=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Qo(a,r,o,u,i,"next",e)}function i(e){Qo(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return t=e.sent,e.next=6,qn.fromLocator(t);case 6:return n=e.sent,e.next=9,xe(n,t.authenticationToken);case 9:return r=e.sent,p.a.publish("notebook","defaultNotebook",r),e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("notebook.actions.getnotebookshares",Ko);var ea=Zo;function ta(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function na(){return ra.apply(this,arguments)}function ra(){return(ra=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ta(a,r,o,u,i,"next",e)}function i(e){ta(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return t=e.sent,e.next=6,qn.fromLocator(t);case 6:return n=e.sent,e.next=9,Ne(n,t.authenticationToken);case 9:return r=e.sent,p.a.publish("notebook","userNotebook",r),e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("notebook.actions.getDefaultNotebook",Zo);var oa=na;p.a.register("notebook.actions.getUserNotebook",na);var aa=n(57),ua=n.n(aa),ia=n(373),ca=n.n(ia);function sa(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function pa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){fa(e,t,n[t])})}return e}function fa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function la(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ha(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){la(a,r,o,u,i,"next",e)}function i(e){la(a,r,o,u,i,"throw",e)}u(void 0)})}}var va=Object(i.default)("ion:notebook:getLinkedNotebook"),da=250;function ma(e,t){return ga.apply(this,arguments)}function ga(){return(ga=ha(regeneratorRuntime.mark(function e(t,n){var r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qn.fromLocator(t);case 2:return r=e.sent,o=new En.NotesMetadataResultSpec({includeTitle:!0,includeUpdated:!0,includeDeleted:!0,includeNotebookGuid:!0,includeAttributes:!0,includeUpdateSequenceNum:!0,includeTagGuids:!0}),e.prev=4,e.next=7,he(r,new En.NoteFilter({order:ia.NoteSortOrder.UPDATED,ascending:!1,notebookGuid:n.guid,includeAllReadableNotebooks:!0,includeAllReadableWorkspaces:!1}),0,da,o,t.authenticationToken);case 7:a=e.sent,u=a.notes&&a.notes.map(function(e){var t=ua.a.omit(e,["largestResourceMime","largestResourceSize"]);return new ia.Note(pa({},t,{active:!t.deleted}))}),p.a.publish("note","updateNotes",{notes:u,locator:t,defaultResultSpec:o}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(4),va.error("".concat(e.t0," #Failed to get notes for linked notebook")),e.t0;case 16:case"end":return e.stop()}},e,null,[[4,12]])}))).apply(this,arguments)}function ba(e){return ya.apply(this,arguments)}function ya(){return(ya=ha(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,e.prev=1,null!=n){e.next=4;break}throw Error("#getLinkedNotebook requires a guid");case 4:return e.next=6,Bn.a.actuallyGetLocationForLinkedNotebookGuid({lnbGuid:n});case 6:return r=e.sent,e.next=9,qn.fromLocator(r);case 9:return o=e.sent,e.next=12,ot(o,r.authenticationToken);case 12:if(null!=(a=e.sent).notebookGuid){e.next=15;break}throw Error("#getLinkedNotebook: sharedNotebook.notebookGuid can not be null");case 15:return e.next=17,Be(o,a.notebookGuid,r.authenticationToken);case 17:if(null!=(u=e.sent).guid){e.next=20;break}throw Error("#getLinkedNotebook: serviceNotebook.guid can not be null");case 20:return e.next=22,fn(o,u.guid,new ia.NotebookRecipientSettings({recipientStatus:ia.RecipientStatus.IN_MY_LIST}));case 22:return i=e.sent,c=function(e,t){var n=e.guid,r=sa(e,["guid"]),o=t.sharedNotebooks,a=t.sharedNotebookIds;if(null==n)throw Error("invalid service notebook");return pa({},r,{guid:n,sharedNotebooks:o,sharedNotebookIds:a})}(i,u),f=pa({},c,{restrictions:u.restrictions,isTrueOwner:r.isTrueOwner,shardIdFromSharedAuth:r.shard||void 0,sharedNotebooks:u.sharedNotebooks}),p.a.publish("notebook","updateNotebook",{notebook:f}),p.a.publish("linkednotebook","updateLinkedNotebooktoAttachmentMap",{attachmentGuid:f.guid,linkedNotebookGuid:n}),e.next=29,ma(r,f);case 29:return e.abrupt("return",f);case 32:if(e.prev=32,e.t0=e.catch(1),e.t0.errorCode!==s.EDAMErrorCode.PERMISSION_DENIED&&!e.t0.identifier){e.next=41;break}return e.next=37,p.a.call("linkednotebook.actions.hasservicenotebook",n);case 37:return(l=e.sent)&&p.a.publish("notebook","expungeNotebook",l),e.next=41,p.a.call("notebook.actions.expungeLinkedNotebook",n);case 41:throw e.t0;case 42:case"end":return e.stop()}},e,null,[[1,32]])}))).apply(this,arguments)}var wa=ba;function ka(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("notebook.actions.getlinkednotebook",ba);var xa=Object(i.default)("ion:action:createLinkedNotebook");function Ra(){return(Ra=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ka(a,r,o,u,i,"next",e)}function i(e){ka(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return xa.log("creating LinkedNotebook:",t),e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,L(r,t);case 9:return o=e.sent,xa.log("created LinkedNotebook:",o),p.a.publish("linkednotebook","updateLinkedNotebook",o),e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Pa=function(e){return Ra.apply(this,arguments)};function Na(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var Sa=Object(i.default)("ion:action:getOrCreateLinkedNotebook");function Oa(){return(Oa=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Na(a,r,o,u,i,"next",e)}function i(e){Na(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Sa.log("gettingOrCreating LinkedNotebook:",t),e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,Ze(r,t);case 9:return o=e.sent,Sa.log("gotOrCreated LinkedNotebook:",o),p.a.publish("linkednotebook","updateLinkedNotebook",o),e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var La=function(e){return Oa.apply(this,arguments)};function Ta(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ea(e){return Bn.a.newPersonalLocator(!0,e,null)}function ja(e){return _a.apply(this,arguments)}function _a(){return(_a=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ta(a,r,o,u,i,"next",e)}function i(e){Ta(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,f,l,h,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,r=t.name,o=t.shardId,null!=n){e.next=3;break}throw new Error("#joinLinkedNotebook requires a notebook guid");case 3:return e.prev=3,a=Ea(o),e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,x(u,n,null);case 10:return i=e.sent,e.next=13,ot(u,i.authenticationToken);case 13:return c=e.sent,e.next=16,p.a.call("linkednotebook.actions.getFromGlobalId",c.globalId);case 16:if(!((f=e.sent).length>0)){e.next=23;break}return e.next=20,f[0];case 20:e.t0=e.sent,e.next=26;break;case 23:return e.next=25,La({shareName:r,username:i.user?i.user.username:"",shardId:o,sharedNotebookGlobalId:c.globalId});case 25:e.t0=e.sent;case 26:return l=e.t0,h=l.guid||"",e.next=30,wa({guid:h});case 30:return e.abrupt("return",e.sent);case 33:if(e.prev=33,e.t1=e.catch(3),e.t1.errorCode!==s.EDAMErrorCode.PERMISSION_DENIED&&!e.t1.identifier){e.next=43;break}return e.next=38,p.a.call("linkednotebook.actions.getlinkednotebookguids",n);case 38:if(v=e.sent,p.a.publish("notebook","expungeNotebook",n),!v||!v.length){e.next=43;break}return e.next=43,v.map(function(e){return p.a.call("notebook.actions.expungeLinkedNotebook",e)});case 43:throw e.t1;case 44:case"end":return e.stop()}},e,null,[[3,33]])}))).apply(this,arguments)}var Ia=ja;function Ua(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ca(){return(Ca=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ua(a,r,o,u,i,"next",e)}function i(e){Ua(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("userstore","authenticateToBusiness",function(e){return t.authenticateToBusiness(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.joinlinkednotebook",ja);var Ga=function(e,t){return Ca.apply(this,arguments)};function Wa(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Da(){return(Da=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wa(a,r,o,u,i,"next",e)}function i(e){Wa(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("userstore","getUser",function(e){return t.getUser(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Aa=function(e,t){return Da.apply(this,arguments)};function Ma(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Fa(){return(Fa=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ma(a,r,o,u,i,"next",e)}function i(e){Ma(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("userstore","listBusinessUsers",function(e){return t.listBusinessUsers(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qa=function(e,t,n){return Fa.apply(this,arguments)},Ba=n(654);function Va(e){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ha(e,t){return!t||"object"!==Va(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ya(e){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ja(e,t){return(Ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ka=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Ha(this,(e=Ya(t)).call.apply(e,[this].concat(o)))).endpoint="edam/user",n.InterfaceConstructor=function(e){return new Ba.UserStore.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ja(e,t)}(t,Wn),t}());function Xa(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function za(e){return Qa.apply(this,arguments)}function Qa(){return(Qa=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Xa(a,r,o,u,i,"next",e)}function i(e){Xa(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getBusinessLocator();case 3:return n=e.sent,e.next=6,Ka.fromLocator(n);case 6:return r=e.sent,e.next=9,qa(r,t,n.authenticationToken||"");case 9:return o=e.sent,p.a.publish("profile","set",o.reduce(function(e,t){return t.id&&(e[t.id]=t),e},{})),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}var Za=za;function $a(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function eu(){return(eu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$a(a,r,o,u,i,"next",e)}function i(e){$a(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("profile.actions.getbusinessusersupdatecount");case 2:if(!(e.sent<t)){e.next=7;break}return e.next=6,Za({});case 6:p.a.publish("profile","setbusinessusersupdatecount",t);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("user.actions.listBusinessUsers",za);var tu=function(e){return eu.apply(this,arguments)},nu=n(73);function ru(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ou(){return au.apply(this,arguments)}function au(){return(au=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ru(a,r,o,u,i,"next",e)}function i(e){ru(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nu.a.init();case 2:if(null!=(t=nu.a.getValue("user"))){e.next=5;break}return e.abrupt("return",null);case 5:return(n=new u.JSONProtocol).rstack=[JSON.parse(t)],n.rpos=[],e.abrupt("return",ia.User.read(n));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function uu(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function iu(){return cu.apply(this,arguments)}function cu(){return(cu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){uu(a,r,o,u,i,"next",e)}function i(e){uu(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r,o,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],e.prev=1,e.next=4,ou();case 4:if(null!=(n=e.sent)&&!t){e.next=13;break}return r=Bn.a.newPersonalLocator(),e.next=9,Ka.fromLocator(r);case 9:return o=e.sent,e.next=12,Aa(o,r.authenticationToken||"");case 12:n=e.sent;case 13:return p.a.publish("user","update",n),e.abrupt("return",n);case 17:throw e.prev=17,e.t0=e.catch(1),e.t0;case 20:case"end":return e.stop()}},e,null,[[1,17]])}))).apply(this,arguments)}var su=iu;function pu(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("user.actions.get",iu);var fu=function(e){p.a.publish("user","setUserLastUpdated",e),p.a.call("crosspromotion.actions.get",!0)};function lu(e){return hu.apply(this,arguments)}function hu(){return(hu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){pu(a,r,o,u,i,"next",e)}function i(e){pu(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=t,e.t0){e.next=6;break}return e.next=5,Bn.a.getDefaultLocator();case 5:e.t0=e.sent;case 6:return n=e.t0,e.next=9,qn.fromLocator(n);case 9:return r=e.sent,e.next=12,it(r,n.authenticationToken);case 12:return o=e.sent,e.next=15,p.a.call("user.actions.getUserLastUpdated");case 15:if(a=e.sent,null!=o.businessUsersUpdateCount&&tu(o.businessUsersUpdateCount),u=!n.personal||n.personal&&!Object(ro.d)(),!(n.personal&&Object(ro.e)()||n.personal&&!Object(ro.d)())||o.userLastUpdated===a){e.next=23;break}return fu(o.userLastUpdated),e.next=23,su(!0);case 23:return u&&p.a.publish("app.progress","syncstate",o),e.abrupt("return",o);case 27:throw e.prev=27,e.t1=e.catch(0),e.t1;case 30:case"end":return e.stop()}},e,null,[[0,27]])}))).apply(this,arguments)}var vu=lu;function du(e){return new gu(e)}function mu(e){var t,n;function r(t,n){try{var a=e[t](n),u=a.value,i=u instanceof gu;Promise.resolve(i?u.wrapped:u).then(function(e){i?r("next",e):o(a.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,o){return new Promise(function(a,u){var i={key:e,arg:o,resolve:a,reject:u,next:null};n?n=n.next=i:(t=n=i,r(e,o))})},"function"!=typeof e.return&&(this.return=void 0)}function gu(e){this.wrapped=e}p.a.register("sync.actions.get",lu),"function"==typeof Symbol&&Symbol.asyncIterator&&(mu.prototype[Symbol.asyncIterator]=function(){return this}),mu.prototype.next=function(e){return this._invoke("next",e)},mu.prototype.throw=function(e){return this._invoke("throw",e)},mu.prototype.return=function(e){return this._invoke("return",e)};var bu=Object(i.default)("ion:actions:filteredSyncChunkGenerator");function yu(){return(yu=function(e){return function(){return new mu(e.apply(this,arguments))}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,p,f,l,h,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.locator,r=t.afterUSN,o=void 0===r?0:r,a=t.maxEntries,u=void 0===a?255:a,i=t.syncChunkFilter,e.prev=1,e.t0=n,e.t0){e.next=7;break}return e.next=6,du(Bn.a.getBusinessLocator());case 6:e.t0=e.sent;case 7:return c=e.t0,e.next=10,du(qn.fromLocator(c));case 10:return s=e.sent,e.next=13,du(vu(c));case 13:if(p=e.sent,f=p.updateCount||0,bu.log("".concat(c.personal?"Personal":"Business"," filteredSyncChunkGenerator")),bu.log("First update count set: ".concat(f)),l=f,h=o,!(o>=f)){e.next=22;break}return bu.log("afterUSN: ".concat(o," has hit or exceed firstUpdateCount ").concat(f)),e.abrupt("return",Promise.resolve({chunk:null,firstUpdateCount:f}));case 22:if(h===l){e.next=32;break}return e.next=25,du(Le(s,h,u,i,c.authenticationToken));case 25:return v=e.sent,l=v.updateCount||0,h=v.chunkHighUSN||0,e.next=30,Promise.resolve({chunk:v,firstUpdateCount:f});case 30:e.next=22;break;case 32:e.next=37;break;case 34:throw e.prev=34,e.t1=e.catch(1),e.t1;case 37:case"end":return e.stop()}},e,null,[[1,34]])}))).apply(this,arguments)}var wu=function(e){return yu.apply(this,arguments)};function ku(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){xu(e,t,n[t])})}return e}function xu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ru(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Pu(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ru(a,r,o,u,i,"next",e)}function i(e){Ru(a,r,o,u,i,"throw",e)}u(void 0)})}}var Nu=Object(i.default)("ion:actions:processSyncChunk");function Su(e){return Ou.apply(this,arguments)}function Ou(){return(Ou=Pu(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.chunk,r=t.firstUpdateCount,o=t.shouldCatchup,a=void 0===o||o,u=t.locator,e.next=3,Promise.resolve();case 3:if(Nu.log("Processing a sync chunk",n,a),n.expungedNotes&&n.expungedNotes.length>0&&p.a.publish("note","expungeNotes",n.expungedNotes),n.expungedNotebooks&&n.expungedNotebooks.length>0&&p.a.publish("notebook","expungeNotebooks",n.expungedNotebooks),n.expungedTags&&n.expungedTags.length>0&&p.a.publish("tag","deleteTags",n.expungedTags),n.expungedWorkspaces&&n.expungedWorkspaces.length>0&&p.a.publish("workspace","expungeWorkspaces",n.expungedWorkspaces),n.notesNoLongerSharedWithMe&&n.notesNoLongerSharedWithMe.length>0&&p.a.publish("note","expungeNotesNoLongerSharedWithMe",{noteGuids:n.notesNoLongerSharedWithMe}),n.linkedNotebooks&&n.linkedNotebooks.length>0&&p.a.publish("linkednotebook","updateLinkedNotebooks",n.linkedNotebooks),n.notes&&n.notes.length>0&&p.a.publish("note","updateNotes",{notes:n.notes,resultSpec:new En.NoteResultSpec({includeSharedNotes:!0}),locator:u}),i=[],!(n.notebooks&&n.notebooks.length>0)){e.next=16;break}return e.next=15,Promise.all(n.notebooks.map(function(){var e=Pu(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t1=t.guid,!e.t1){e.next=5;break}return e.next=4,p.a.call("notebook.actions.hasnotebook",t.guid);case 4:e.t1=!e.sent;case 5:if(e.t0=e.t1,!e.t0){e.next=8;break}e.t0=a||null!=t.updateSequenceNum&&t.updateSequenceNum>r;case 8:if(!e.t0){e.next=10;break}i.push(t.guid);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 15:n.notebooks?(c=n.notebooks.map(function(e){return ku({},e,{isTrueOwner:u.isTrueOwner,isOwnedByMyVaultUser:!u.personal&&!u.globalId})}),s={notebooks:c,locator:u},p.a.publish("notebook","updateNotebooks",s)):Nu.error("notebooks array in sync chunk is removed!");case 16:if(f=[],!(n.workspaces&&n.workspaces.length>0)){e.next=21;break}return e.next=20,Promise.all(n.workspaces.map(function(){var e=Pu(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t1=t.workspace&&t.workspace.guid,!e.t1){e.next=6;break}return e.next=4,p.a.call("notebook.actions.hasnotebooks",t.notebookGuids||[]);case 4:e.t2=e.sent.length,e.t1=e.t2>0;case 6:if(e.t0=e.t1,!e.t0){e.next=9;break}e.t0=a||null!=t.workspace.updateSequenceNum&&t.workspace.updateSequenceNum>r;case 9:if(!e.t0){e.next=11;break}f.push(t.workspace.guid);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 20:p.a.publish("workspace","updateWorkspaces",n.workspaces);case 21:return i.length>0&&p.a.publish("notebook","needsCatchup",{guids:i,locator:u}),n.preferences&&p.a.publish("preference","updatePreferences",{preferences:n.preferences.preferences}),n.tags&&n.tags.length>0&&p.a.publish("tag","updateTags",n.tags),Nu.log("Notebooks that need to be caught up:",i),Nu.log("Workspaces that need to be caught up",f),e.abrupt("return",[i,f]);case 27:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Lu=Su;function Tu(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Eu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(r=(u=i.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ju(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("sync.actions.process",Su);var _u=Object(i.default)("ion:actions:getFilteredSyncChunk");function Iu(e){return Uu.apply(this,arguments)}function Uu(){return(Uu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ju(a,r,o,u,i,"next",e)}function i(e){ju(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h,v,d,m,g,b,y,w,k,x,R;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.locator,r=t.afterUSN,o=void 0===r?0:r,a=t.maxEntries,u=void 0===a?255:a,i=t.syncChunkFilter,e.prev=1,e.t0=n,e.t0){e.next=7;break}return e.next=6,Bn.a.getDefaultLocator();case 6:e.t0=e.sent;case 7:c=e.t0,s=wu({locator:c,afterUSN:o,maxEntries:u,syncChunkFilter:i}),f=!c.personal||c.personal&&!Object(ro.d)(),l=f&&!(i.notebookGuids||i.workspaceGuids),h=!(0===o||i.notebookGuids||i.workspaceGuids),v=[];case 13:return e.next=15,s.next();case 15:if(!(d=e.sent).value){e.next=22;break}if(g=d.value,b=g.chunk,!(null!=(y=g.firstUpdateCount)&&f&&o>=y)){e.next=21;break}return p.a.publish("app","synced",!0),e.abrupt("return",{updateCount:y,notebookGuids:[],workspaceGuids:[]});case 21:null!=b&&"number"==typeof b.chunkHighUSN?(o<b.chunkHighUSN&&v.push(Lu({chunk:b,firstUpdateCount:y,locator:c,shouldCatchup:h})),m=b.chunkHighUSN,l&&p.a.publish("app.progress","chunk",b.chunkHighUSN)):d.done||(_u.error("Bad sync chunk data from generator:",d),null==m&&(m=y));case 22:if(d&&!d.done){e.next=13;break}case 23:return e.t1=ua.a,e.next=26,Promise.all(v);case 26:return e.t2=e.sent,e.t3=function(e){return ua.a.union.apply(ua.a,Tu(e))},w=e.t1.unzip.call(e.t1,e.t2).map(e.t3),k=Eu(w,2),x=k[0],R=k[1],e.abrupt("return",{updateCount:m||0,notebookGuids:x,workspaceGuids:R});case 35:throw e.prev=35,e.t4=e.catch(1),e.t4;case 38:case"end":return e.stop()}},e,null,[[1,35]])}))).apply(this,arguments)}var Cu=Iu;function Gu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Wu(e,t,n[t])})}return e}function Wu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Du(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("sync.actions.filteredsyncchunk",Iu);var Au=Object(i.default)("ion:actions:catchupSync");function Mu(e){return Fu.apply(this,arguments)}function Fu(){return(Fu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Du(a,r,o,u,i,"next",e)}function i(e){Du(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,s,f,l,h,v,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.locator,r=t.notebookGuids,o=void 0===r?[]:r,a=t.workspaceGuids,u=void 0===a?[]:a,e.t0=n,e.t0){e.next=6;break}return e.next=5,Bn.a.getDefaultLocator();case 5:e.t0=e.sent;case 6:if(i=e.t0,s=new En.SyncChunkFilter({includeNotes:!0,includeSharedNotes:!0,includeWorkspacesContent:!0,includeNotebooks:!0}),f=[],e.prev=9,!o.length){e.next=15;break}return Au.log("Catching up Notebooks: ".concat(o.toString())),e.next=14,Cu({locator:i,syncChunkFilter:Gu({},s,{notebookGuids:o})});case 14:p.a.publish("notebook","didCatchup",o);case 15:e.next=36;break;case 17:e.prev=17,e.t1=e.catch(9),Au.log("Catching up failed for notebookGuids: ".concat(o.toString(),", retrying individually")),l=0;case 21:if(!(l<o.length)){e.next=36;break}return e.prev=22,h=o[l],Au.log("Catching up Notebook: ".concat(h)),e.next=27,Cu({locator:i,syncChunkFilter:Gu({},s,{notebookGuids:[h]})});case 27:p.a.publish("notebook","didCatchup",[h]),e.next=33;break;case 30:e.prev=30,e.t2=e.catch(22),f.push(e.t2);case 33:l++,e.next=21;break;case 36:if(e.prev=36,!u.length){e.next=41;break}return e.next=40,Cu({locator:i,syncChunkFilter:Gu({},s,{includeWorkspaces:!0,workspaceGuids:u})});case 40:p.a.publish("workspace","didCatchup",u);case 41:e.next=62;break;case 43:e.prev=43,e.t3=e.catch(36),Au.log("Catching up failed for workspaceGuids: ".concat(u.toString(),", retrying individually")),v=0;case 47:if(!(v<u.length)){e.next=62;break}return e.prev=48,d=u[v],Au.log("Catching up Space: ".concat(d)),e.next=53,Cu({locator:i,syncChunkFilter:Gu({},s,{includeWorkspaces:!0,workspaceGuids:[d]})});case 53:p.a.publish("workspace","didCatchup",[d]),e.next=59;break;case 56:e.prev=56,e.t4=e.catch(48),f.push(e.t4);case 59:v++,e.next=47;break;case 62:if(!(f.length>0)){e.next=66;break}throw Au.log("Multiple errors detected in catchupSync, attempting to throw",f),Object(c.sendException)({message:"Multiple errors detected in catchupSync ".concat(JSON.stringify(f)),callstack:JSON.stringify(f[0].stack),fatal:!1}),f;case 66:case"end":return e.stop()}},e,null,[[9,17],[22,30],[36,43],[48,56]])}))).apply(this,arguments)}var qu=Mu;function Bu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Vu(e,t,n[t])})}return e}function Vu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hu(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Yu(e){return Ju.apply(this,arguments)}function Ju(){return(Ju=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Hu(a,r,o,u,i,"next",e)}function i(e){Hu(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,r=t.userId,e.prev=1,null!=n){e.next=4;break}throw new Error("#joinNotebook requires a notebook guid");case 4:return e.next=6,p.a.call("notebook.actions.hasnotebook",n);case 6:return o=e.sent,e.next=9,Bn.a.getLocationForNotebookGuid(n);case 9:if(a=e.sent,!o){e.next=22;break}return e.next=13,p.a.call("notebook.actions.getnotebook",n);case 13:if(!(u=e.sent).recipientSettings||u.recipientSettings.recipientStatus===ia.RecipientStatus.NOT_IN_MY_LIST){e.next=22;break}if(!(u.published&&u.sharedNotebooks&&u.sharedNotebooks.find(function(e){return null!=r&&r===e.recipientUserId}))){e.next=21;break}return e.next=18,Jn({notebookGuid:n,notebookIdentifier:n,shardId:a.shard||""});case 18:return a.authenticationToken=e.sent,e.next=21,qu({locator:a,notebookGuids:[n]});case 21:return e.abrupt("return",null);case 22:return a.personal=!0,e.next=25,qn.fromLocator(a);case 25:return i=e.sent,e.next=28,fn(i,n,new ia.NotebookRecipientSettings({recipientStatus:ia.RecipientStatus.IN_MY_LIST}));case 28:if(null!=(c=e.sent).guid){e.next=31;break}throw new Error("malformed notebook returned from service");case 31:return e.next=33,Bn.a.getLocationForNotebook(Bu({},c,{guid:c.guid}));case 33:return s=e.sent,e.next=36,qu({locator:s,notebookGuids:[n]});case 36:return e.abrupt("return",null);case 39:throw e.prev=39,e.t0=e.catch(1),e.t0;case 42:case"end":return e.stop()}},e,null,[[1,39]])}))).apply(this,arguments)}p.a.register("sync.actions.catchup",Mu);var Ku=Yu;function Xu(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function zu(e){return Qu.apply(this,arguments)}function Qu(){return(Qu=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Xu(a,r,o,u,i,"next",e)}function i(e){Xu(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#leaveNotebook requires a notebook guid");case 2:return e.next=4,p.a.call("notebook.actions.getparentworkspace",t);case 4:if(null==e.sent){e.next=7;break}throw new Error("Cannot leave a notebook that is in a workspace");case 7:return e.next=9,Bn.a.getLocationForNotebookGuid(t);case 9:return(n=e.sent).personal=!0,e.next=13,qn.fromLocator(n);case 13:return r=e.sent,e.next=16,fn(r,t,new ia.NotebookRecipientSettings({recipientStatus:ia.RecipientStatus.NOT_IN_MY_LIST}));case 16:return p.a.publish("notebook","expungeNotebook",t),e.abrupt("return",null);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.joinnotebook",Yu);var Zu=zu;function $u(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ei(){return ti.apply(this,arguments)}function ti(){return(ti=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$u(a,r,o,u,i,"next",e)}function i(e){$u(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return t=e.sent,e.next=6,qn.fromLocator(t);case 6:return n=e.sent,e.next=9,jt(n,t.authenticationToken);case 9:return r=e.sent,p.a.publish("linkednotebook","updateLinkedNotebooks",r),e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("notebook.actions.leavenotebook",zu);var ni,ri=ei;function oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ii(e,t,n[t])})}return e}function ai(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ui(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ai(a,r,o,u,i,"next",e)}function i(e){ai(a,r,o,u,i,"throw",e)}u(void 0)})}}function ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}p.a.register("linkednotebook.actions.list",ei);var ci=Object(i.default)("ion:action:manageNotebookShares"),si=(ii(ni={},ca.a.SharedNotebookPrivilegeLevel.READ_NOTEBOOK_PLUS_ACTIVITY,En.ShareRelationshipPrivilegeLevel.READ_NOTEBOOK_PLUS_ACTIVITY),ii(ni,ca.a.SharedNotebookPrivilegeLevel.MODIFY_NOTEBOOK_PLUS_ACTIVITY,En.ShareRelationshipPrivilegeLevel.MODIFY_NOTEBOOK_PLUS_ACTIVITY),ii(ni,ca.a.SharedNotebookPrivilegeLevel.FULL_ACCESS,En.ShareRelationshipPrivilegeLevel.FULL_ACCESS),ii(ni,ca.a.SharedNotebookPrivilegeLevel.BUSINESS_FULL_ACCESS,En.ShareRelationshipPrivilegeLevel.FULL_ACCESS),ni);function pi(e,t,n,r){return fi.apply(this,arguments)}function fi(){return(fi=ui(regeneratorRuntime.mark(function e(t,n,r,o){var a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n?Object.keys(n).map(function(e){return parseInt(e,10)}):[],e.next=3,o.reduce(function(){var e=ui(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("identity.actions.getidentitiesforuser",n);case 2:return r=e.sent,e.next=5,t;case 5:return e.t0=r.map(function(e){return e.id}),e.abrupt("return",e.sent.concat(e.t0));case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(r));case 3:u=e.sent,t.sharedNotebooks=t.sharedNotebooks&&t.sharedNotebooks.filter(function(e){return e.recipientIdentityId&&!u.includes(e.recipientIdentityId)}).map(function(e){var t=e.recipientUserId;if(null!=t&&a.includes(t)){var r=oi({},e);return r.privilege=n[t].priv,r}return e}),p.a.publish("notebook","updateNotebook",{notebook:t});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function li(e){return Object.keys(e).map(function(t){var n=e[t].priv,r=si[n];return{recipientUserId:parseInt(t,10),individualPrivilege:r,displayName:null,bestPrivilege:null,restrictions:null,sharerUserId:null}})}function hi(e,t){var n=e.map(function(e){return{type:ia.UserIdentityType.IDENTITYID,longIdentifier:e}});return t.map(function(e){return n.push({type:ia.UserIdentityType.EVERNOTE_USERID,longIdentifier:e})}),n}function vi(e){return di.apply(this,arguments)}function di(){return(di=ui(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,p,f,l,h,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.notebook,r=t.usersToModify,o=void 0===r?{}:r,a=t.invitesToRemove,u=void 0===a?[]:a,i=t.sharesToRemove,c=void 0===i?[]:i,e.prev=1,e.next=4,Bn.a.getLocationForNotebook(n);case 4:return s=e.sent,e.next=7,qn.fromLocator(s);case 7:return p=e.sent,f=li(o),l=hi(u,c),h=new En.ManageNotebookSharesParameters({notebookGuid:n.guid,membershipsToUpdate:f,unshares:l,inviteMessage:null}),e.next=13,Xt(p,h,s.authenticationToken);case 13:if(!(v=e.sent).errors){e.next=16;break}throw v.errors;case 16:return e.next=18,pi(n,o,u,c);case 18:return e.abrupt("return",e.sent);case 21:throw e.prev=21,e.t0=e.catch(1),Array.isArray(e.t0)?e.t0.forEach(function(e){e.notFoundException&&ci.error(e.notFoundException),e.userException&&ci.error(e.userException)}):ci.error(e.t0),e.t0;case 25:case"end":return e.stop()}},e,null,[[1,21]])}))).apply(this,arguments)}var mi=vi;function gi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function bi(e){return yi.apply(this,arguments)}function yi(){return(yi=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){gi(a,r,o,u,i,"next",e)}function i(e){gi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#moveNotebookToAccount requires a notebook guid");case 2:return e.next=4,Bn.a.getDefaultLocator();case 4:return n=e.sent,e.next=7,no.fromLocator(n);case 7:return r=e.sent,e.next=10,_r(r,t,n.authenticationToken);case 10:return qu({locator:n,notebookGuids:[t]}),e.abrupt("return",null);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.managenotebookshares",vi);var wi=bi;function ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){xi(e,t,n[t])})}return e}function xi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Pi(e){return Ni.apply(this,arguments)}function Ni(){return(Ni=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ri(a,r,o,u,i,"next",e)}function i(e){Ri(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,o=t.recipientSettings,e.prev=1,null!=n){e.next=4;break}throw Error("#setNotebookRecipientSettings requires a guid");case 4:return e.next=6,Bn.a.getPersonalLocator();case 6:return a=e.sent,e.next=9,Bn.a.getLocationForNotebookGuid(n);case 9:return u=e.sent,e.t0=r,e.next=13,qn.fromLocator(Bn.a.newInstance(ki({},a,{shard:u.shard})));case 13:return e.t1=e.sent,e.t2=n,e.t3=o,e.t4=a.authenticationToken,e.next=19,e.t0.setNotebookRecipientSettings.call(e.t0,e.t1,e.t2,e.t3,e.t4);case 19:return e.t5=r,e.next=22,qn.fromLocator(u);case 22:return e.t6=e.sent,e.t7=n,e.t8=u.authenticationToken,e.next=27,e.t5.getNotebook.call(e.t5,e.t6,e.t7,e.t8);case 27:return i=e.sent,p.a.publish("notebook","updateNotebook",{notebook:i}),e.abrupt("return",i);case 32:throw e.prev=32,e.t9=e.catch(1),e.t9;case 35:case"end":return e.stop()}},e,null,[[1,32]])}))).apply(this,arguments)}p.a.register("notebook.actions.movetoaccount",bi);var Si=Pi;function Oi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Li(e){return Ti.apply(this,arguments)}function Ti(){return(Ti=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Oi(a,r,o,u,i,"next",e)}function i(e){Oi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.userIds,r=t.notebookGuid,o=t.permLevel,e.prev=1,null!=r){e.next=4;break}throw Error("#shareNotebook requires a guid");case 4:return a=[],ua.a.uniq(n).map(function(e){return a.push(new ia.Contact({id:String(e),type:"string"==typeof e?ia.ContactType.EMAIL:ia.ContactType.EVERNOTE}))}),e.next=8,p.a.call("notebook.actions.getnotebook",r);case 8:return u=e.sent,e.next=11,Bn.a.getLocationForNotebook(u);case 11:return i=e.sent,e.next=14,qn.fromLocator(i);case 14:return c=e.sent,s=new En.NotebookShareTemplate({notebookGuid:r,recipientContacts:a,privilege:o}),e.next=18,W(c,s,i.authenticationToken);case 18:return e.next=20,p.a.call("threads.actions.sendmessage",{userIds:n,message:"<msg></msg>",attachment:u,isExternal:null!=i.globalId||!Object(ro.d)()});case 20:return e.next=22,Yo(r,!0);case 22:e.next=27;break;case 24:throw e.prev=24,e.t0=e.catch(1),e.t0;case 27:case"end":return e.stop()}},e,null,[[1,24]])}))).apply(this,arguments)}p.a.register("notebook.actions.setNotebookRecipientSettings",Pi);var Ei=Li;function ji(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function _i(e){return Ii.apply(this,arguments)}function Ii(){return(Ii=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ji(a,r,o,u,i,"next",e)}function i(e){ji(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.notebook,r=t.userId,e.next=3,Bn.a.getLocationForNotebook(n);case 3:return o=e.sent,e.next=6,qn.fromLocator(o);case 6:return a=e.sent,u=n.guid,e.next=10,W(a,{notebookGuid:u,recipientThreadId:null,recipientContacts:[{id:r,type:ia.ContactType.EVERNOTE}],privilege:ca.a.SharedNotebookPrivilegeLevel.FULL_ACCESS});case 10:return e.prev=10,i=Bn.a.newPersonalLocator(o.sharedToMe,o.shard,o.authenticationToken),e.next=14,qn.fromLocator(i);case 14:if(c=e.sent,s={recipientStatus:ca.a.RecipientStatus.IN_MY_LIST},null==u){e.next=21;break}return e.next=19,x(c,u);case 19:return e.next=21,fn(c,u,s);case 21:return f=Bn.a.newDefaultLocator(o.sharedToMe,o.shard,o.authenticationToken),e.next=24,qn.fromLocator(f);case 24:if(l=e.sent,null==u){e.next=30;break}return e.next=28,Be(l,u);case 28:h=e.sent,p.a.publish("service.notebook","joinnotebooksuccess",h);case 30:e.next=36;break;case 32:throw e.prev=32,e.t0=e.catch(10),p.a.publish("service.notebook","joinnotebookfailure"),e.t0;case 36:case"end":return e.stop()}},e,null,[[10,32]])}))).apply(this,arguments)}p.a.register("notebook.actions.sharenotebook",Li);var Ui=_i;function Ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Gi(e,t,n[t])})}return e}function Gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Di(e){return Ai.apply(this,arguments)}function Ai(){return(Ai=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wi(a,r,o,u,i,"next",e)}function i(e){Wi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,r=null,o=!0,null!=n){e.next=5;break}throw Error("#updateNotebook requires a guid");case 5:return e.next=7,p.a.call("notebook.actions.getnotebook",n);case 7:return a=e.sent,e.next=10,Bn.a.getLocationForNotebook(a);case 10:return u=e.sent,e.next=13,qn.fromLocator(u);case 13:if(i=e.sent,!t.isRenamed||!t.name){e.next=21;break}return e.next=17,on(i,n,t.name,u.authenticationToken);case 17:r=e.sent,delete t.isRenamed,delete t.name,Object.keys(t).length<=1&&(o=!1);case 21:if(!o){e.next=26;break}return c=Ci({},a,t),e.next=25,Rn(i,c,u.authenticationToken);case 25:r=e.sent;case 26:if(!Go.a.isUpSyncDisabled()){e.next=31;break}return e.next=29,Be(i,n,u.authenticationToken);case 29:s=e.sent,p.a.publish("notebook","updateNotebook",{notebook:s});case 31:return e.abrupt("return",r);case 32:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("notebook.actions.sharenotebooktoself",_i);var Mi=Di;function Fi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function qi(){return Bi.apply(this,arguments)}function Bi(){return(Bi=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Fi(a,r,o,u,i,"next",e)}function i(e){Fi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Bn.a.newPersonalLocator(),e.next=4,Ka.fromLocator(t);case 4:return n=e.sent,e.next=7,Ga(n,t.authenticationToken);case 7:return(r=e.sent)&&r.user&&p.a.publish("user","setvaultuser",r.user),e.abrupt("return",r);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}))).apply(this,arguments)}p.a.register("notebook.actions.updateservice",Di);var Vi=qi;function Hi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Yi(){return Ji.apply(this,arguments)}function Ji(){return(Ji=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Hi(a,r,o,u,i,"next",e)}function i(e){Hi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getPersonalLocator();case 2:return t=e.sent,e.next=5,no.fromLocator(t);case 5:return n=e.sent,r=new Qr.TierSelectionDisplayEligibilityRequest,e.abrupt("return",fr(n,r));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("user.actions.authToBusiness",qi);var Ki=Yi;function Xi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function zi(){return(zi=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Xi(a,r,o,u,i,"next",e)}function i(e){Xi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("messagestore","createMessageThread",function(e){return t.createMessageThread(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("user.actions.gettsdeligibility",Yi);var Qi=function(e,t,n){return zi.apply(this,arguments)};function Zi(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function $i(){return($i=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Zi(a,r,o,u,i,"next",e)}function i(e){Zi(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("messagestore","getMessageSyncChunk",function(e){return t.getMessageSyncChunk(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ec=function(e,t,n){return $i.apply(this,arguments)};function tc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function nc(){return(nc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){tc(a,r,o,u,i,"next",e)}function i(e){tc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("messagestore","getThreads",function(e){return t.getThreads(n||Object(o.a)(),e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rc=function(e,t){return nc.apply(this,arguments)};function oc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ac(){return(ac=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){oc(a,r,o,u,i,"next",e)}function i(e){oc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("messagestore","sendMessageToThread",function(e){return t.sendMessageToThread(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var uc=function(e,t,n){return ac.apply(this,arguments)},ic=n(465);function cc(e){return(cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sc(e,t){return!t||"object"!==cc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pc(e){return(pc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fc(e,t){return(fc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lc=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=sc(this,(e=pc(t)).call.apply(e,[this].concat(o)))).endpoint="messagestore",n.InterfaceConstructor=function(e){return new ic.MessageStore.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fc(e,t)}(t,Wn),t}());function hc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function vc(){return dc.apply(this,arguments)}function dc(){return(dc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){hc(a,r,o,u,i,"next",e)}function i(e){hc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return t=e.sent,e.next=6,lc.fromLocator(t);case 6:return n=e.sent,e.next=9,rc(n,t.authenticationToken);case 9:return r=e.sent,p.a.publish("identity","set",r.identities),p.a.publish("service.threads","update",r.threads),e.abrupt("return",r);case 15:throw e.prev=15,e.t0=e.catch(0),e.t0;case 18:case"end":return e.stop()}},e,null,[[0,15]])}))).apply(this,arguments)}var mc=vc;function gc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function bc(){return yc.apply(this,arguments)}function yc(){return(yc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){gc(a,r,o,u,i,"next",e)}function i(e){gc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return t=e.sent,e.next=6,no.fromLocator(t);case 6:return n=e.sent,e.next=9,vr(n,t.authenticationToken);case 9:return e.abrupt("return",e.sent);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}))).apply(this,arguments)}p.a.register("user.actions.getThreadsAndIdentities",vc);var wc=bc;function kc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function xc(){return Rc.apply(this,arguments)}function Rc(){return(Rc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){kc(a,r,o,u,i,"next",e)}function i(e){kc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return t=e.sent,e.next=6,no.fromLocator(t);case 6:return n=e.sent,e.next=9,Vr(n,t.authenticationToken);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,11]])}))).apply(this,arguments)}p.a.register("user.actions.getRestrictions",bc);var Pc=xc;function Nc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Sc(e){return Oc.apply(this,arguments)}function Oc(){return(Oc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Nc(a,r,o,u,i,"next",e)}function i(e){Nc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,tt(r,t,n.authenticationToken);case 9:return o=e.sent,p.a.publish("preference","updatePreferences",o),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("user.actions.sendVerificationEmail",xc);var Lc=Sc;function Tc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ec(e){return jc.apply(this,arguments)}function jc(){return(jc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Tc(a,r,o,u,i,"next",e)}function i(e){Tc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.preferencesToUpdate,r=t.preferenceNames,e.prev=1,e.next=4,Bn.a.getPersonalLocator();case 4:return o=e.sent,e.next=7,qn.fromLocator(o);case 7:return a=e.sent,e.next=10,Sn(a,n);case 10:return e.next=12,tt(a,r,o.authenticationToken);case 12:return u=e.sent,p.a.publish("preference","updatePreferences",u),e.abrupt("return",u);case 17:throw e.prev=17,e.t0=e.catch(1),e.t0;case 20:case"end":return e.stop()}},e,null,[[1,17]])}))).apply(this,arguments)}p.a.register("preference.actions.get",Sc);var _c=Ec;function Ic(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Uc(e){return Cc.apply(this,arguments)}function Cc(){return(Cc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ic(a,r,o,u,i,"next",e)}function i(e){Ic(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,no.fromLocator(n);case 6:return r=e.sent,e.next=9,cr(r,t);case 9:return o=e.sent,p.a.publish("promotion","updatePromotions",o),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("preference.actions.update",Ec);var Gc=Uc;function Wc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Dc(e){return Ac.apply(this,arguments)}function Ac(){return(Ac=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wc(a,r,o,u,i,"next",e)}function i(e){Wc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,no.fromLocator(n);case 6:return r=e.sent,e.next=9,Cr(r,t);case 9:p.a.publish("promotion","updatePromotions",[{promotionId:t,optedOut:!0}]),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}))).apply(this,arguments)}p.a.register("promotion.actions.get",Uc);var Mc=Dc;function Fc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function qc(e){return Bc.apply(this,arguments)}function Bc(){return(Bc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Fc(a,r,o,u,i,"next",e)}function i(e){Fc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,no.fromLocator(n);case 6:return r=e.sent,e.next=9,Dr(r,t);case 9:return o=e.sent,p.a.publish("promotion","updatePromotions",o),e.abrupt("return",o);case 14:if(e.prev=14,e.t0=e.catch(0),2!==e.t0.errorCode){e.next=18;break}throw new Error("promotionIds are limited to 32 chars.");case 18:throw e.t0;case 19:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("promotion.actions.optout",Dc);var Vc=qc;function Hc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Yc(){return Jc.apply(this,arguments)}function Jc(){return(Jc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Hc(a,r,o,u,i,"next",e)}function i(e){Hc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r,o,a,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]&&u[0],e.prev=1,e.next=4,p.a.call("promotion.actions.getCrossPromotionInfo");case 4:if(null==(n=e.sent)||t){e.next=7;break}return e.abrupt("return",n);case 7:return e.next=9,Bn.a.getPersonalLocator();case 9:return r=e.sent,e.next=12,no.fromLocator(r);case 12:return o=e.sent,e.next=15,ar(o,r.authenticationToken);case 15:return a=e.sent,p.a.publish("promotion","updateCrossPromotions",a),e.abrupt("return",a);case 20:throw e.prev=20,e.t0=e.catch(1),e.t0;case 23:case"end":return e.stop()}},e,null,[[1,20]])}))).apply(this,arguments)}p.a.register("promotion.actions.show",qc);var Kc=Yc;function Xc(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function zc(e){return Qc.apply(this,arguments)}function Qc(){return(Qc=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Xc(a,r,o,u,i,"next",e)}function i(e){Xc(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#acquireNoteLock Guid is required");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,y(r,t,n.authenticationToken);case 11:return o=e.sent,e.abrupt("return",o);case 15:throw e.prev=15,e.t0=e.catch(2),e.t0;case 18:case"end":return e.stop()}},e,null,[[2,15]])}))).apply(this,arguments)}p.a.register("crosspromotion.actions.get",Yc);var Zc=zc;function $c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){es(e,t,n[t])})}return e}function es(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ts(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ns(e,t){return rs.apply(this,arguments)}function rs(){return(rs=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ts(a,r,o,u,i,"next",e)}function i(e){ts(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getLocationForNoteGuid(t);case 2:return r=e.sent,e.next=5,no.fromLocator(r);case 5:return o=e.sent,e.abrupt("return",zn(o,new ia.Resource($c({},n,{noteGuid:t})),r.authenticationToken));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("note.actions.lock.acquire",zc);var os=ns;p.a.register("note.actions.addResourceToNote",function(e){return ns(e.noteGuid,e.resource)});var as=n(390),us=n.n(as),is=n(376);function cs(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var ss=us.a.EDAM_NOTE_TITLE_LEN_MAX;function ps(e){return fs.apply(this,arguments)}function fs(){return(fs=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){cs(a,r,o,u,i,"next",e)}function i(e){cs(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.noteGuid,r=t.notebookGuid,o=t.noteTitle,null!=n&&null!=r){e.next=3;break}throw new Error("#copyNote requires a noteGuid and a notebookGuid");case 3:return e.prev=3,e.next=6,Bn.a.getLocationForNoteGuid(n);case 6:return a=e.sent,e.next=9,qn.fromLocator(a);case 9:return u=e.sent,e.next=12,N(u,n,r,a.authenticationToken);case 12:if((i=e.sent).title=o.slice(0,ss),c=i.guid){e.next=17;break}throw new Error("service did not return a guid.  This should never happen");case 17:return p.a.publish("note","updateNote",{note:i,locator:a}),e.next=20,is.a.updateNote({guid:c,title:i.title});case 20:return s=e.sent,e.abrupt("return",s);case 24:throw e.prev=24,e.t0=e.catch(3),e.t0;case 27:case"end":return e.stop()}},e,null,[[3,24]])}))).apply(this,arguments)}var ls=ps;function hs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){vs(e,t,n[t])})}return e}function vs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ds(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ms(e){return gs.apply(this,arguments)}function gs(){return(gs=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ds(a,r,o,u,i,"next",e)}function i(e){ds(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==t.content&&(t.content='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note></en-note>'),n=Date.now(),t.created=t.created||n,t.updated=t.updated||n,t.attributes=t.attributes||new ia.NoteAttributes,null==t.attributes){e.next=16;break}if(t.attributes.noteTitleQuality=as.EDAM_NOTE_TITLE_QUALITY_UNTITLED,null!=t.attributes.author){e.next=16;break}return e.next=11,p.a.call("user.actions.getactiveuser");case 11:if(r=e.sent){e.next=14;break}throw new Error("no user???");case 14:o=hs({},t.attributes,{author:r.name}),t.attributes=o;case 16:if(e.prev=16,null!=(u=t.notebookGuid)){e.next=20;break}throw new Error("no notebookguid provided");case 20:return e.next=22,p.a.call("notebook.actions.getnotebook",u);case 22:return i=e.sent,e.next=25,Bn.a.getLocationForNotebook(i);case 25:a=e.sent,e.next=33;break;case 28:return e.prev=28,e.t0=e.catch(16),e.next=32,Bn.a.getDefaultLocator();case 32:a=e.sent;case 33:return e.next=35,qn.fromLocator(a);case 35:return c=e.sent,e.next=38,j(c,t,a.authenticationToken);case 38:return s=e.sent,p.a.publish("note","updateNote",{note:s,locator:a}),e.abrupt("return",s);case 43:throw e.prev=43,e.t1=e.catch(0),e.t1;case 46:case"end":return e.stop()}},e,null,[[0,43],[16,28]])}))).apply(this,arguments)}p.a.register("note.actions.copy",ps);var bs=ms;function ys(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ws(e,t,n[t])})}return e}function ws(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ks(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("note.actions.create",ms);var xs=new En.NotesMetadataResultSpec({includeTagGuids:!0,includeTitle:!0,includeUpdated:!0,includeDeleted:!0,includeNotebookGuid:!0,includeAttributes:!0,includeUpdateSequenceNum:!0});function Rs(e){return Ps.apply(this,arguments)}function Ps(){return(Ps=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ks(a,r,o,u,i,"next",e)}function i(e){ks(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter,r=t.offset,o=void 0===r?0:r,a=t.maxNotes,u=void 0===a?128:a,i=t.resultSpec,c=void 0===i?xs:i,e.prev=1,e.next=4,Bn.a.getLocationForNoteFilter(n);case 4:if(null!=(s=e.sent)){e.next=7;break}throw new Error("Shard Locator not found for scope ".concat(n.scope));case 7:return e.next=9,qn.fromLocator(s);case 9:return f=e.sent,e.next=12,he(f,n,o,u,c,s.authenticationToken);case 12:return l=e.sent,(h=l&&l.notes)&&(v=h.map(function(e){var t=ua.a.omit(e,["largestResourceMime","largestResourceSize"]);return new ia.Note(ys({},t,{active:!t.deleted}))}),p.a.publish("note","updateNotes",{notes:v,locator:s,resultSpec:c})),e.abrupt("return",l);case 18:throw e.prev=18,e.t0=e.catch(1),e.t0;case 21:case"end":return e.stop()}},e,null,[[1,18]])}))).apply(this,arguments)}var Ns=Rs;p.a.register("note.actions.findNotesMetadata",Rs);var Ss=n(375);function Os(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ls(e,t,n[t])})}return e}function Ls(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ts(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var Es=Object(i.default)("ion:actions:getNote");function js(e){return _s.apply(this,arguments)}function _s(){return(_s=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ts(a,r,o,u,i,"next",e)}function i(e){Ts(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,r=t.resultSpec,o=void 0===r?new En.NoteResultSpec:r,a=t.forceFetch,u=void 0!==a&&a,null!=n){e.next=3;break}throw new Error("#getNote Guid is required");case 3:return e.next=5,p.a.call("note.datasource.getnote",n);case 5:if(i=e.sent,null==i||i&&(null==i.content||i.stale)&&o.includeContent||u){e.next=10;break}return Es.log("Returning localNote %o",i),e.abrupt("return",i);case 10:return e.next=12,Bn.a.getLocationForNoteGuid(n);case 12:return c=e.sent,e.next=15,qn.fromLocator(c);case 15:return f=e.sent,e.next=18,Me(f,n,o,c.authenticationToken).catch(function(e){throw(e.errorCode===s.EDAMErrorCode.PERMISSION_DENIED||e.identifier)&&(Es.error("Permission denied: expunging note guid: ".concat(n)),p.a.publish("note","expungeNote",n)),e});case 18:if((l=e.sent).shard=c.shard||"",p.a.publish("note","updateNote",{note:Os({},l,{shardId:c.shard}),resultSpec:o,locator:c}),e.t1=Go.a.isBootstrappingEnabled(),!e.t1){e.next=26;break}return e.next=25,p.a.call("attachments.actions.getattachment",l.guid);case 25:e.t1=e.sent;case 26:if(e.t0=e.t1,!e.t0){e.next=31;break}return e.next=30,p.a.call("notebook.actions.hasnotebook",l.notebookGuid);case 30:e.t0=e.sent;case 31:if(!e.t0){e.next=35;break}return Es.log("Fetching notebook in getNote because serviceNote is not an attachment, and we are in bootstrappingView"),e.next=35,p.a.call("notebook.actions.get",l.notebookGuid);case 35:return Go.a.isBootstrappingEnabled()&&window.parent!==window&&localStorage.removeItem(Ss.x),e.abrupt("return",l);case 37:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Is=js;function Us(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("note.actions.getNote",js);var Cs=Object(i.default)("ion:action:createNoteShare");function Gs(e){return Ws.apply(this,arguments)}function Ws(){return(Ws=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Us(a,r,o,u,i,"next",e)}function i(e){Us(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.share,e.prev=1,r=[],ua.a.uniq(n.userIds).map(function(e){return r.push(new ia.Contact({id:String(e),type:"string"==typeof e?ia.ContactType.EMAIL:ia.ContactType.EVERNOTE}))}),o=new En.SharedNoteTemplate({noteGuid:n.note.guid,recipientContacts:r,privilege:n.permLevel}),e.next=7,Bn.a.getLocationForNote(n.note);case 7:return a=e.sent,e.next=10,qn.fromLocator(a);case 10:return u=e.sent,e.next=13,M(u,o,a.authenticationToken);case 13:return e.next=15,p.a.call("threads.actions.sendmessage",{userIds:n.userIds,message:"<msg></msg>",attachment:n.note,isExternal:null!=a.globalId||!Object(ro.d)()});case 15:if(!n.note.guid){e.next=18;break}return e.next=18,Is({guid:n.note.guid,resultSpec:new En.NoteResultSpec({includeSharedNotes:!0}),forceFetch:!0});case 18:e.next=24;break;case 20:throw e.prev=20,e.t0=e.catch(1),Cs.error(e.t0),e.t0;case 24:case"end":return e.stop()}},e,null,[[1,20]])}))).apply(this,arguments)}p.a.register("note.actions.createNoteShare",Gs);var Ds=Gs;function As(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var Ms=100;function Fs(e){return qs.apply(this,arguments)}function qs(){return(qs=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){As(a,r,o,u,i,"next",e)}function i(e){As(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getPersonalLocator();case 2:return n=e.sent,e.next=5,qn.fromLocator(n);case 5:r=e.sent,o=null,a=0,u=ua.a.chunk(t,Ms),i=!0,c=!1,s=void 0,e.prev=12,f=u[Symbol.iterator]();case 14:if(i=(l=f.next()).done){e.next=23;break}return h=l.value,e.next=18,te(r,h,n.authenticationToken);case 18:o=e.sent,a++;case 20:i=!0,e.next=14;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(12),c=!0,s=e.t0;case 29:e.prev=29,e.prev=30,i||null==f.return||f.return();case 32:if(e.prev=32,!c){e.next=35;break}throw s;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return Go.a.isUpSyncDisabled()&&p.a.publish("note","expungeNotes",t),e.abrupt("return",{lastServerUsn:o,completedServiceCalls:a});case 39:case"end":return e.stop()}},e,null,[[12,25,29,37],[30,,32,36]])}))).apply(this,arguments)}p.a.register("note.actions.expungeNotesService",Fs);var Bs=Fs;function Vs(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Hs(e){return Ys.apply(this,arguments)}function Ys(){return(Ys=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Vs(a,r,o,u,i,"next",e)}function i(e){Vs(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#getNoteLockStatus Guid is required");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,Ue(r,t,n.authenticationToken);case 11:return o=e.sent,e.abrupt("return",o);case 15:throw e.prev=15,e.t0=e.catch(2),e.t0;case 18:case"end":return e.stop()}},e,null,[[2,15]])}))).apply(this,arguments)}var Js=Hs;p.a.register("note.actions.lock.status",Hs);var Ks=n(647);function Xs(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function zs(e){return Qs.apply(this,arguments)}function Qs(){return(Qs=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Xs(a,r,o,u,i,"next",e)}function i(e){Xs(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Is({guid:t,resultSpec:new En.NoteResultSpec({includeContent:!0}),forceFetch:!0});case 2:return n=e.sent,e.next=5,Object(Ks.createResourceMapAsync)(n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Zs=zs;function $s(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ep(e){return tp.apply(this,arguments)}function tp(){return(tp=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){$s(a,r,o,u,i,"next",e)}function i(e){$s(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#getNoteShares Guid is required");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,Xe(r,t);case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(2),e.t0;case 17:case"end":return e.stop()}},e,null,[[2,14]])}))).apply(this,arguments)}p.a.register("note.actions.getnoteresourcemap",zs);var np=ep;function rp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){op(e,t,n[t])})}return e}function op(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ap(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(r=(u=i.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function up(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ip(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){up(a,r,o,u,i,"next",e)}function i(e){up(a,r,o,u,i,"throw",e)}u(void 0)})}}p.a.register("note.actions.getnoteshares",ep);var cp=75;function sp(e){return pp.apply(this,arguments)}function pp(){return(pp=ip(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guids,r=t.isVaryingOrigin,o=void 0!==r&&r,e.prev=1,0!==n.length){e.next=4;break}return e.abrupt("return",null);case 4:if(a={},!o){e.next=13;break}return e.next=8,Promise.all(n.map(function(){var e=ip(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,Bn.a.getLocationForNoteGuid(t);case 3:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 8:e.t0=function(e,t){var n=ap(t,2),r=n[0],o=n[1],a="".concat(o.shard||"","_").concat(o.personal?"P":"B");return null==e[a]&&(e[a]={notes:[],locator:o}),e[a].notes.push(r),e},e.t1=a,e.sent.reduce(e.t0,e.t1),e.next=17;break;case 13:return e.next=15,Bn.a.getLocationForNoteGuid(n[0]);case 15:(u=e.sent).shard&&(a[u.shard]={notes:n,locator:u});case 17:return e.next=19,Promise.all(Object.values(a).map(function(){var e=ip(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.notes,r=t.locator,e.next=3,qn.fromLocator(r);case 3:return o=e.sent,e.t0=ua.a,e.next=7,Promise.all(ua.a.chunk(n,as.EDAM_SNIPPETS_NOTES_MAX).map(function(){var e=ip(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We(o,t,cp,r.authenticationToken);case 2:return n=e.sent,e.next=5,p.a.call("note.actions.getall");case 5:return a=e.sent,e.abrupt("return",Object.keys(n).reduce(function(e,t){var r=n[t].substring(0,cp);r.length===cp&&(r+="");var o=a[t];return null!=o&&e.push(rp({},o,{snippet:r})),e},[]));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 7:e.t1=e.sent,e.t2=[e.t1],a=e.t0.flatten.call(e.t0,e.t2),u=ap(a,1),i=u[0],p.a.publish("note","updateNotes",{notes:i,locator:r});case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 19:return e.abrupt("return",null);case 22:throw e.prev=22,e.t2=e.catch(1),e.t2;case 25:case"end":return e.stop()}},e,null,[[1,22]])}))).apply(this,arguments)}var fp=sp;function lp(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("note.actions.getsnippets",sp);var hp=Object(i.default)("ion:actions:manageNoteShares");function vp(e){var t=[];return e&&(t=Object.keys(e).map(function(t){var n=e[t].priv;return{recipientUserId:parseInt(t,10),privilege:n,displayName:null,restrictions:null,sharerUserId:null}})),t}function dp(e){return mp.apply(this,arguments)}function mp(){return(mp=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){lp(a,r,o,u,i,"next",e)}function i(e){lp(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.note,r=t.usersToModify,o=t.sharesToRemove,a=t.invitesToRemove,e.prev=1,null!=(u=n.guid)){e.next=5;break}throw new Error("note requires a guid in #manageNoteShares");case 5:return e.next=7,Bn.a.getLocationForNote(n);case 7:return i=e.sent,e.next=10,qn.fromLocator(i);case 10:return c=e.sent,s=vp(r),p=new En.ManageNoteSharesParameters({noteGuid:u,membershipsToUpdate:s,membershipsToUnshare:o,invitationsToUnshare:a}),e.next=15,Zt(c,p,i.authenticationToken);case 15:if(!((f=e.sent).errors&&f.errors.length>0)){e.next=18;break}throw f.errors;case 18:return e.next=20,Is({guid:u,forceFetch:!0,resultSpec:new En.NoteResultSpec({includeSharedNotes:!0})});case 20:e.next=26;break;case 22:throw e.prev=22,e.t0=e.catch(1),Array.isArray(e.t0)?e.t0.forEach(function(e){e.notFoundException&&hp.error(e.notFoundException),e.userException&&hp.error(e.userException)}):hp.error(e.t0),e.t0;case 26:case"end":return e.stop()}},e,null,[[1,22]])}))).apply(this,arguments)}var gp=dp;function bp(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function yp(e){return wp.apply(this,arguments)}function wp(){return(wp=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){bp(a,r,o,u,i,"next",e)}function i(e){bp(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#releaseNoteLock Guid is required");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,tn(r,t,n.authenticationToken);case 11:return o=e.sent,e.abrupt("return",o);case 15:throw e.prev=15,e.t0=e.catch(2),e.t0;case 18:case"end":return e.stop()}},e,null,[[2,15]])}))).apply(this,arguments)}p.a.register("note.actions.managenoteshares",dp);var kp=yp;p.a.register("note.actions.lock.release",yp);var xp=n(637),Rp=n(448);function Pp(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Np(e){return Sp.apply(this,arguments)}function Sp(){return(Sp=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Pp(a,r,o,u,i,"next",e)}function i(e){Pp(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p.a.publish("note","selectNote",{guid:t}),null!=t){e.next=3;break}return e.abrupt("return",null);case 3:return n=new En.NoteResultSpec({includeAccountLimits:!0,includeContent:!0,includeSharedNotes:!0}),e.next=6,Is({guid:t,resultSpec:n,forceFetch:"web"===Rp.a.platformName});case 6:return r=e.sent,e.prev=7,e.next=10,Yo(r.notebookGuid,!Object(xp.a)());case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(7);case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[7,12]])}))).apply(this,arguments)}var Op=Np;function Lp(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Tp(e){return Ep.apply(this,arguments)}function Ep(){return(Ep=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Lp(a,r,o,u,i,"next",e)}function i(e){Lp(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#shareNote requires a guid");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,vn(r,t,n.authenticationToken);case 11:return o=e.sent,e.next=14,Is({guid:t,resultSpec:new En.NoteResultSpec({includeSharedNotes:!0}),forceFetch:!0});case 14:return e.abrupt("return",o);case 17:throw e.prev=17,e.t0=e.catch(2),e.t0;case 20:case"end":return e.stop()}},e,null,[[2,17]])}))).apply(this,arguments)}p.a.register("note.actions.select",Np);var jp=Tp;function _p(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ip(e){return Up.apply(this,arguments)}function Up(){return(Up=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_p(a,r,o,u,i,"next",e)}function i(e){_p(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#stopSharingNote requires a guid");case 2:return e.prev=2,e.next=5,Bn.a.getLocationForNoteGuid(t);case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,gn(r,t,n.authenticationToken);case 11:return e.next=13,Is({guid:t,forceFetch:!0});case 13:return e.abrupt("return",null);case 16:throw e.prev=16,e.t0=e.catch(2),e.t0;case 19:case"end":return e.stop()}},e,null,[[2,16]])}))).apply(this,arguments)}p.a.register("note.actions.share",Tp);var Cp=Ip;p.a.register("note.actions.stopsharing",Ip);var Gp=n(484);function Wp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dp(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ap(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Dp(a,r,o,u,i,"next",e)}function i(e){Dp(a,r,o,u,i,"throw",e)}u(void 0)})}}function Mp(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){qp(e,t,n[t])})}return e}function qp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bp=Object(i.default)("ion:action:updateNote"),Vp=["attributes","created","notebookGuid","sharedNotes","tagGuids","tagNames","title","active","deleted"],Hp=["author","reminderDoneTime","reminderOrder","reminderTime","shareDate","sharedWithBusiness","sourceURL"],Yp={};function Jp(e,t,n,r){var o=Fp({},t);e.attributes&&o.attributes&&(o.attributes=Fp({},e.attributes,o.attributes)),Object.assign(e,ua.a.omitBy(o,ua.a.isUndefined),{resources:null}),n.sharedToMe&&!r&&delete e.tagGuids}function Kp(e,t){return new Qr.ResourcesUpdateRequest({deactivateResourcesWithBodyHashes:[].concat(Mp(e.deactivateResourcesWithBodyHashes||[]),Mp(t.deactivateResourcesWithBodyHashes||[])),activateResourcesWithBodyHashes:[].concat(Mp(e.activateResourcesWithBodyHashes||[]),Mp(t.activateResourcesWithBodyHashes||[]))})}function Xp(e){return zp.apply(this,arguments)}function zp(){return(zp=Ap(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("note.datasource.getnote",t);case 2:return n=e.sent,e.next=5,p.a.call("notebook.actions.hasnotebook",n.notebookGuid);case 5:if(!e.sent){e.next=11;break}return e.next=9,p.a.call("notebook.actions.getnotebook",n.notebookGuid);case 9:return r=e.sent,e.abrupt("return",r.restrictions&&!r.restrictions.noUpdateNotes||!1);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Qp(e){return Zp.apply(this,arguments)}function Zp(){return(Zp=Ap(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=function(e,t){return function(){var n=ef({noteChanges:e,resourcesUpdateRequest:t}),r=n.then(u,u);return Yp[a]={nextChanges:{},nextResourcesUpdate:{},inFlightRequest:r},n}},u=function(){Yp[a].nextRequest||delete Yp[a]},n=t.noteChanges,r=t.resourcesUpdateRequest,o=void 0===r?new Qr.ResourcesUpdateRequest:r,Bp.log("updateNote called with:",n,o),null!=(a=n.guid)){e.next=7;break}return e.abrupt("return",Promise.reject(new Error("#updateNote requires a guid")));case 7:if(!Yp[a]){e.next=19;break}return c=Yp[a],e.next=11,Bn.a.getLocationForNoteGuid(a);case 11:return s=e.sent,e.next=14,Xp(a);case 14:return p=e.sent,Jp(c.nextChanges,n,s,p),c.nextResourcesUpdate=Kp(c.nextResourcesUpdate,o),c.nextRequest||(c.nextRequest=c.inFlightRequest.then(i(c.nextChanges,c.nextResourcesUpdate))),e.abrupt("return",c.nextRequest);case 19:return e.abrupt("return",i(n,o)());case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $p=function(){function e(t,n,r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sentNote=void 0,this.locator=void 0,this.updateTags=void 0,this.sentUpdatedWinsData=void 0,this.resourcesUpdateRequest=void 0,this.MAX_ATTEMPTS=4,this.sentNote=t,this.locator=n,this.updateTags=r,this.sentUpdatedWinsData=o,this.resourcesUpdateRequest=a}return function(e,t,n){t&&Wp(e.prototype,t),n&&Wp(e,n)}(e,[{key:"isEligibleForUpdatedWins",value:function(e){var t=this.sentUpdatedWinsData,n=t.updatedWinsAttributes,r=t.updatedWinsFields;return(0!==n.length||0!==r.length)&&(null!=e.updated&&null!=this.sentNote.updated&&e.updated<this.sentNote.updated)}},{key:"retryUpdatedWins",value:function(){var e=Ap(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Jp(n=Fp({},t),ua.a.pick(this.sentNote,this.sentUpdatedWinsData.updatedWinsFields),this.locator,this.updateTags),Bp.log("retrying updateNoteIfUsnMatches with fields where updatedTimestamp wins.",n),e.next=5,no.fromLocator(this.locator);case 5:return r=e.sent,e.next=8,Jr(r,n,new Qr.ResourcesUpdateRequest,this.locator.authenticationToken);case 8:if(null!=(o=e.sent).note){e.next=11;break}throw new Error("updateResult.note is undefined - updated wins retry");case 11:if(a=o.note,o.updated){e.next=14;break}return e.abrupt("return",{updated:!1,serviceNote:a});case 14:if(Bp.log("publishing to datasource",a),p.a.publish("note","updateNote",{note:a,locator:this.locator}),!(this.sentUpdatedWinsData.notUpdatedWinsFields.length>0||this.sentUpdatedWinsData.notUpdatedWinsAttributes.length>0)){e.next=18;break}throw new Error("did not update everything we wanted");case 18:return e.abrupt("return",{updated:!0,serviceNote:a});case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"isEligibleForContent",value:function(e){if(null==e.contentHash||null==this.sentNote.contentHash)return!1;if(Object(Gp.hashify)(e.contentHash)!==Object(Gp.hashify)(this.sentNote.contentHash||""))return!1;var t=this.sentUpdatedWinsData.changeKeys.filter(function(e){return"guid"!==e});return 1===t.length&&"content"===t[0]}},{key:"retryContent",value:function(){var e=Ap(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Jp(n=Fp({},t),{content:this.sentNote.content},this.locator,this.updateTags),Bp.log("Retry content update with",n),e.next=5,no.fromLocator(this.locator);case 5:return r=e.sent,e.next=8,Jr(r,n,this.resourcesUpdateRequest,this.locator.authenticationToken);case 8:if(null!=(o=e.sent).note){e.next=11;break}throw new Error("updateResult.note is undefined - content retry");case 11:if(a=o.note,o.updated){e.next=14;break}return e.abrupt("return",{updated:!1,serviceNote:a});case 14:return u=Fp({},a,{content:n.content}),Bp.log("publishing note content update to dataSource",u),p.a.publish("note","updateNote",{note:u,resultSpec:new En.NoteResultSpec({includeContent:!0}),locator:this.locator}),e.abrupt("return",{updated:!0,serviceNote:u});case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"isEligibleForResources",value:function(){var e=this.resourcesUpdateRequest,t=e.activateResourcesWithBodyHashes,n=e.deactivateResourcesWithBodyHashes;return null!=t&&t.length>0||null!=n&&n.length>0}},{key:"retryResources",value:function(){var e=Ap(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Jp(n=Fp({},t,{resources:null}),{},this.locator,this.updateTags),Bp.log("resending resource update request",n,this.resourcesUpdateRequest),e.next=5,no.fromLocator(this.locator);case 5:return r=e.sent,e.next=8,Jr(r,n,this.resourcesUpdateRequest,this.locator.authenticationToken);case 8:if(null!=(o=e.sent).note){e.next=11;break}throw new Error("updateResult.note is undefined - resource retry");case 11:if(a=o.note,o.updated){e.next=14;break}return e.abrupt("return",{updated:!1,serviceNote:a});case 14:return Bp.log("publishing note update to dataSource",a),p.a.publish("note","updateNote",{note:a,locator:this.locator}),e.abrupt("return",{updated:!0,serviceNote:a});case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getRetryStrategies",value:function(e){var t=this;return[{isEligible:function(){return t.isEligibleForUpdatedWins(e)},retryUpdate:function(){return t.retryUpdatedWins(e)}},{isEligible:function(){return t.isEligibleForContent(e)},retryUpdate:function(){return t.retryContent(e)}},{isEligible:function(){return t.isEligibleForResources()},retryUpdate:function(){return t.retryResources(e)}}]}},{key:"redactContent",value:function(e){return Fp({},e,{content:null!=e.content?"REDACTED FOR PRIVACY":null})}},{key:"logErrorWithState",value:function(e,t){Bp.error(e,"lastServiceNote:",this.redactContent(t),"sentNote:",this.redactContent(this.sentNote),"locator:",this.locator,"updateTags:",this.updateTags,"sentUpdatedWinsData:",this.sentUpdatedWinsData,"resourcesUpdateRequest:",this.resourcesUpdateRequest)}},{key:"retryInternal",value:function(){var e=Ap(regeneratorRuntime.mark(function e(t,n){var r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n>=this.MAX_ATTEMPTS)){e.next=3;break}throw this.logErrorWithState("Exceeded retry limit - this should never happen.",t),new Error("Got USN errors for ".concat(n," update retries in a row"));case 3:r=this.getRetryStrategies(t),o=0;case 5:if(!(o<r.length)){e.next=17;break}if(!(a=r[o]).isEligible()){e.next=14;break}return e.next=10,a.retryUpdate();case 10:if((u=e.sent).updated){e.next=13;break}return e.abrupt("return",this.retryInternal(u.serviceNote,n+1));case 13:return e.abrupt("return",u.serviceNote);case 14:o++,e.next=5;break;case 17:throw this.logErrorWithState("Unable to retry update for an unknown reason.",t),new Error("note is ineligible for update retry");case 19:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"retry",value:function(e){return this.retryInternal(e,0)}}]),e}();function ef(e){return tf.apply(this,arguments)}function tf(){return(tf=Ap(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h,v,d,m,g,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.noteChanges,r=t.resourcesUpdateRequest,e.prev=1,null!=(o=n.guid)){e.next=5;break}throw new Error("guid is required when updating note");case 5:return a=Object.keys(n).filter(function(e){return null!=n[e]}),u=Object.keys(n.attributes||{}),i={changeKeys:a,updatedWinsFields:ua.a.intersection(a,Vp),updatedWinsAttributes:ua.a.intersection(u,Hp),notUpdatedWinsFields:ua.a.difference(a,[].concat(Vp,["guid"])),notUpdatedWinsAttributes:ua.a.difference(u,Hp)},e.next=10,p.a.call("note.datasource.getnote",o);case 10:return c=e.sent,e.next=13,Xp(o);case 13:return s=e.sent,e.next=16,Bn.a.getLocationForNote(c);case 16:return f=e.sent,e.next=19,no.fromLocator(f);case 19:return l=e.sent,Jp(h=Fp({},c),n,f,s),h.updated=Date.now(),c.stale&&delete h.content,Bp.log("updateNoteIfUsnMatches with",h,r),e.next=27,Jr(l,h,r,f.authenticationToken);case 27:if(null!=(v=e.sent).note){e.next=30;break}throw new Error("note is undefined - after initial update");case 30:if(d=v.note,v.updated){e.next=36;break}return m=new $p(h,f,s,i,r),e.next=35,m.retry(d);case 35:return e.abrupt("return",e.sent);case 36:return g=Fp({},d,{content:n.content||null}),b=new En.NoteResultSpec({includeContent:null!=n.content}),Bp.log("publishing note update",g,b),p.a.publish("note","updateNote",{note:g,resultSpec:b,locator:f}),e.abrupt("return",g);case 43:throw e.prev=43,e.t0=e.catch(1),Bp.error("error in performUpdate:",e.t0),e.t0;case 47:case"end":return e.stop()}},e,null,[[1,43]])}))).apply(this,arguments)}var nf=Qp;function rf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function of(e){return af.apply(this,arguments)}function af(){return(af=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){rf(a,r,o,u,i,"next",e)}function i(e){rf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.guid,r=t.lockState,e.prev=1,p.a.publish("note","updateLock",{guid:n,lockState:r}),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),e.t0;case 8:case"end":return e.stop()}},e,null,[[1,5]])}))).apply(this,arguments)}p.a.register("note.actions.update",Qp);var uf=of;function cf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function sf(){return pf.apply(this,arguments)}function pf(){return(pf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){cf(a,r,o,u,i,"next",e)}function i(e){cf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return t=e.sent,e.next=6,qn.fromLocator(t);case 6:return n=e.sent,e.next=9,Bt(n,t.authenticationToken);case 9:return r=e.sent,p.a.publish("tag","updateTags",r),e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("note.actions.lock.update",of);var ff=sf;function lf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function hf(e){return vf.apply(this,arguments)}function vf(){return(vf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){lf(a,r,o,u,i,"next",e)}function i(e){lf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.filter,r=t.notebookGuid,e.prev=1,!r){e.next=8;break}return e.next=5,Bn.a.getLocationForNotebookGuid(r);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Bn.a.getDefaultLocator();case 10:e.t0=e.sent;case 11:return o=e.t0,e.next=14,qn.fromLocator(o);case 14:return a=e.sent,e.next=17,ye(a,n,o.authenticationToken);case 17:return u=e.sent,o.globalId?p.a.publish("tag","countSharedTags",{noteCollection:u,notebookGuid:r}):p.a.publish("tag","countTag",u),e.abrupt("return",u);case 22:throw e.prev=22,e.t1=e.catch(1),e.t1;case 25:case"end":return e.stop()}},e,null,[[1,22]])}))).apply(this,arguments)}p.a.register("tag.actions.list",sf);var df=hf;function mf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function gf(){return bf.apply(this,arguments)}function bf(){return(bf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){mf(a,r,o,u,i,"next",e)}function i(e){mf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ff();case 3:return t=e.sent,e.next=6,df({filter:new En.NoteFilter({tagGuids:t.map(function(e){return e.guid||""})})});case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}p.a.register("tag.actions.count",hf);var yf=gf;function wf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function kf(e){return xf.apply(this,arguments)}function xf(){return(xf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){wf(a,r,o,u,i,"next",e)}function i(e){wf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,B(r,t,n.authenticationToken);case 9:return o=e.sent,p.a.publish("tag","updateTag",o),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("tag.actions.bootstrap",gf);var Rf=kf;function Pf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Nf(e){return Sf.apply(this,arguments)}function Sf(){return(Sf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Pf(a,r,o,u,i,"next",e)}function i(e){Pf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return n=e.sent,e.next=5,qn.fromLocator(n);case 5:return r=e.sent,e.next=8,ie(r,t,n.authenticationToken);case 8:return o=e.sent,Go.a.isUpSyncDisabled()&&p.a.publish("tag","deleteTag",t),e.abrupt("return",o);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("tag.actions.create",kf);var Of=Nf;function Lf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Tf(e){return Ef.apply(this,arguments)}function Ef(){return(Ef=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Lf(a,r,o,u,i,"next",e)}function i(e){Lf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getLocationForNotebookGuid(t);case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,Yt(r,t,n.authenticationToken);case 9:return o=e.sent,p.a.publish("tag","updateSharedTags",{tags:o,guid:t}),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("tag.actions.deleteService",Nf);var jf=Tf;function _f(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function If(e){return Uf.apply(this,arguments)}function Uf(){return(Uf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){_f(a,r,o,u,i,"next",e)}function i(e){_f(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,Tn(r,t,n.authenticationToken);case 9:if(null==e.sent){e.next=13;break}return e.next=13,p.a.publish("tag","updateTag",t);case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(0),e.t0;case 18:case"end":return e.stop()}},e,null,[[0,15]])}))).apply(this,arguments)}p.a.register("tag.actions.listTagsByNotebook",Tf);var Cf=If;p.a.register("tag.actions.update",If);var Gf=n(402);function Wf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}var Df={includeInvitations:!1,includeIdentityByInvitationsGuid:!1,includeMemberships:!1,includeWorkspaceRestrictions:!1,includeNotebookGuids:!0,includeAccessInfo:!1,includeNotebookRestrictions:!1,includeDiscoverableWorkspaces:!1,includeAggregations:!1};function Af(e){return Mf.apply(this,arguments)}function Mf(){return(Mf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wf(a,r,o,u,i,"next",e)}function i(e){Wf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.guid,r=t.responseSpec,null!=n){e.next=3;break}throw new Error("#getWorkspace workspace guid is required");case 3:return e.prev=3,e.next=6,Bn.a.getLocationForWorkspaceGuid();case 6:return o=e.sent,e.next=9,no.fromLocator(o);case 9:return a=e.sent,u=new Gf.WorkspaceResponseSpec(r||Df),e.next=13,gr(a,n,u,o.authenticationToken);case 13:return i=e.sent,i.workspace&&p.a.publish("workspace","updateWorkspace",i),e.abrupt("return",i);case 19:throw e.prev=19,e.t0=e.catch(3),e.t0;case 22:case"end":return e.stop()}},e,null,[[3,19]])}))).apply(this,arguments)}var Ff=Af;function qf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Bf(e){return Vf.apply(this,arguments)}function Vf(){return(Vf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){qf(a,r,o,u,i,"next",e)}function i(e){qf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.workspaceGuid,r=t.membershipsToUpdate,o=t.invitationsToCreateOrUpdate,a=t.membershipsToRemove,null!=n){e.next=3;break}throw new Error("workspaceGuid is required to #manageWorkspaceSharing calls.");case 3:return e.next=5,Bn.a.getLocationForWorkspaceGuid();case 5:return u=e.sent,e.next=8,no.fromLocator(u);case 8:return i=e.sent,e.next=11,Tr(i,new Gf.ManageWorkspaceSharingRequest({workspaceGuid:n,membershipsToUpdate:r,invitationsToCreateOrUpdate:o,membershipsToRemove:a}),u.authenticationToken);case 11:if(!1!==e.sent.containsNoErrors){e.next=14;break}throw new Error("Workspace sharing was not updated");case 14:return e.next=16,Ff({guid:n,responseSpec:{includeInvitations:!0,includeMemberships:!0}});case 16:c=e.sent,p.a.publish("workspace","updateWorkspace",c);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("workspace.actions.get",Af);var Hf=Bf;function Yf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Jf(e){return Kf.apply(this,arguments)}function Kf(){return(Kf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Yf(a,r,o,u,i,"next",e)}function i(e){Yf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.workspaceGuid,r=t.userIds,o=t.privilegeLevel,null!=n){e.next=3;break}throw new Error("workspaceGuid is required for #addUsersToWorkspace");case 3:if(null!=o){e.next=5;break}throw new Error("privilegeLevel is required for #addUsersToWorkspace");case 5:return e.next=7,p.a.call("identity.actions.getidentitiesforusers",r);case 7:return a=e.sent,u=a.map(function(e){return new Gf.WorkspaceInvitation({workspaceGuid:n,privilege:o,contact:e.contact})}),e.next=11,Hf({workspaceGuid:n,invitationsToCreateOrUpdate:u});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("workspace.actions.managesharing",Bf);var Xf=Jf;function zf(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Qf(e){return Zf.apply(this,arguments)}function Zf(){return(Zf=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){zf(a,r,o,u,i,"next",e)}function i(e){zf(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.workspaceResponse,e.prev=1,!n.notebookGuids){e.next=12;break}if(!(r=n.workspace)||!r.guid){e.next=12;break}return o=r.guid,e.next=9,Bn.a.getLocationForWorkspaceGuid();case 9:return a=e.sent,e.next=12,qu({locator:a,workspaceGuids:[o]});case 12:return e.abrupt("return",null);case 15:throw e.prev=15,e.t0=e.catch(1),e.t0;case 18:case"end":return e.stop()}},e,null,[[1,15]])}))).apply(this,arguments)}p.a.register("workspace.actions.addusers",Jf);var $f=Qf;function el(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function tl(e){return nl.apply(this,arguments)}function nl(){return(nl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){el(a,r,o,u,i,"next",e)}function i(e){el(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#bootstrapWorkspace Guid is required");case 2:return e.prev=2,e.next=5,Ff({guid:t,responseSpec:{includeInvitations:!1,includeIdentityByInvitationsGuid:!1,includeMemberships:!0,includeWorkspaceRestrictions:!1,includeNotebookGuids:!0,includeAccessInfo:!0,includeNotebookRestrictions:!0,includeDiscoverableWorkspaces:!1,includeAggregations:!1}});case 5:return n=e.sent,e.next=8,$f({workspaceResponse:n});case 8:return e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),e.t0;case 14:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}p.a.register("workspace.actions.getcontent",Qf);var rl=tl;function ol(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function al(){return ul.apply(this,arguments)}function ul(){return(ul=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ol(a,r,o,u,i,"next",e)}function i(e){ol(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return t=e.sent,e.next=6,no.fromLocator(t);case 6:return n=e.sent,r=new Gf.WorkspaceResponseSpec({includeAccessInfo:!0,includeMemberships:!0,includeNotebookGuids:!0,includeWorkspaceRestrictions:!0}),e.next=10,Sr(n,r,new Gf.WorkspaceFilter,t.authenticationToken);case 10:o=e.sent,p.a.publish("workspace","updateWorkspaces",o),e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("workspace.actions.bootstrap",tl);var il=al;function cl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function sl(e){return pl.apply(this,arguments)}function pl(){return(pl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){cl(a,r,o,u,i,"next",e)}function i(e){cl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return n=e.sent,e.next=5,no.fromLocator(n);case 5:return r=e.sent,e.next=8,$n(r,t,n.authenticationToken);case 8:if(o=e.sent,a=o.guid,u=o.backingNotebookGuid,!a||!u){e.next=18;break}return e.next=13,Ff({guid:a,responseSpec:{includeMemberships:!0,includeWorkspaceRestrictions:!0,includeAccessInfo:!0}});case 13:return i=e.sent,p.a.publish("workspace","updateWorkspace",i),e.next=17,Yo(u);case 17:return e.abrupt("return",a);case 18:throw new Error("malformed workspace returned from createWorkspace");case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("workspace.actions.bootstrapWorkspaces",al);var fl=sl;function ll(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("workspace.actions.create",sl);var hl=Object(i.default)("ion:actions:leaveWorkspace");function vl(e){return dl.apply(this,arguments)}function dl(){return(dl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ll(a,r,o,u,i,"next",e)}function i(e){ll(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#leaveWorkspace requires a workspaceGuid");case 2:return hl.log("#leaveWorkspace called w/ guid",t),e.next=5,Bn.a.getLocationForWorkspaceGuid();case 5:return n=e.sent,e.next=8,no.fromLocator(n);case 8:return r=e.sent,e.next=11,p.a.call("notebook.actions.getWorkspaceToNotebookGuids");case 11:return o=e.sent,e.next=14,Promise.all((o.getValuesAsArray(t)||[]).map(function(e){return p.a.call("notebook.actions.getnotebook",e)}));case 14:return a=e.sent,u=a.filter(function(e){return null==e.sharedNotebooks}).map(function(e){return e.guid}),hl.log("notebooks to be expunged:",u),e.next=19,wr(r,t,n.authenticationToken);case 19:p.a.publish("notebook","expungeNotebooks",u),p.a.publish("workspace","expungeWorkspace",t);case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ml=vl;function gl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function bl(e){return yl.apply(this,arguments)}function yl(){return(yl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){gl(a,r,o,u,i,"next",e)}function i(e){gl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.workspaceGuid,r=t.userIds,null!=n){e.next=3;break}throw new Error("workspaceGuid is required for #removeUsersFromWorkspace");case 3:return e.next=5,p.a.call("workspace.actions.getworkspaceresponse",n);case 5:if(o=e.sent,!(a=o.memberships)){e.next=11;break}return u=a.filter(function(e){return null!=e.common&&null!=e.common.recipientId&&r.includes(e.common.recipientId)}).map(function(e){return e.common&&e.common.guid}).filter(function(e){return null!=e}),e.next=11,Hf({workspaceGuid:n,membershipsToRemove:u});case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("workspace.actions.leaveservice",vl);var wl=bl;p.a.register("workspace.actions.removeusers",bl);var kl=n(638);function xl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Rl(e){return Pl.apply(this,arguments)}function Pl(){return(Pl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){xl(a,r,o,u,i,"next",e)}function i(e){xl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("workspace.actions.getworkspaceresponse",t);case 2:if(n=e.sent,!Object(kl.isSeen)(n.accessInfo)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,Bn.a.getLocationForWorkspaceGuid();case 7:return r=e.sent,e.next=10,no.fromLocator(r);case 10:return o=e.sent,e.next=13,Fr(o,t,r.authenticationToken);case 13:return p.a.publish("workspace","updateWorkspace",{workspaceGuid:t,accessInfo:new Gf.AccessInfo({viewed:!0})}),e.abrupt("return",!0);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Nl=Rl;function Sl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ol(e){return Ll.apply(this,arguments)}function Ll(){return(Ll=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Sl(a,r,o,u,i,"next",e)}function i(e){Sl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.guid){e.next=3;break}throw new Error("workspace guid is required for #updateWorkspace");case 3:return e.next=5,Bn.a.getLocationForWorkspaceGuid();case 5:return n=e.sent,e.next=8,no.fromLocator(n);case 8:return r=e.sent,e.next=11,zr(r,new Gf.Workspace(t),n.authenticationToken);case 11:return o=e.sent,p.a.publish("workspace","updateWorkspace",{workspace:o}),e.abrupt("return",o.updateSequenceNum||null);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("workspace.actions.see",Rl);var Tl=Ol;function El(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function jl(e){return _l.apply(this,arguments)}function _l(){return(_l=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){El(a,r,o,u,i,"next",e)}function i(e){El(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workspaceGuid,r=t.updateVersion,o=t.shouldUpdateLocalState,e.prev=1,e.next=4,Bn.a.getLocationForWorkspaceGuid();case 4:return a=e.sent,e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,ht(u,new En.GetWorkspaceUserInterfacePropertiesRequest({workspaceGuid:n,updateVersion:r}),a.authenticationToken);case 10:return i=e.sent,!1!==o&&i&&i.updateVersion&&r<i.updateVersion&&p.a.publish("workspace","setWorkspaceUserInterfaceProperties",{guid:n,workspaceUserInterfaceProperties:i}),e.abrupt("return",i);case 15:throw e.prev=15,e.t0=e.catch(1),e.t0;case 18:case"end":return e.stop()}},e,null,[[1,15]])}))).apply(this,arguments)}p.a.register("workspace.actions.updateService",Ol);var Il=jl;function Ul(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Cl(e){return Gl.apply(this,arguments)}function Gl(){return(Gl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ul(a,r,o,u,i,"next",e)}function i(e){Ul(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workspaceGuid,r=t.layoutStyle,o=t.updateVersion,e.prev=1,e.next=4,Bn.a.getLocationForWorkspaceGuid();case 4:return a=e.sent,e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,mt(u,n,r,a.authenticationToken);case 10:is.a.getWorkspaceUserInterfaceProperties(n,o),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}p.a.register("workspace.actions.getWorkspaceUserInterfaceProperties",jl);var Wl=Cl;function Dl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Al(e){return Ml.apply(this,arguments)}function Ml(){return(Ml=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Dl(a,r,o,u,i,"next",e)}function i(e){Dl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workspaceGuid,r=t.noteDisplayOrder,o=t.updateVersion,e.prev=1,e.next=4,Bn.a.getLocationForWorkspaceGuid();case 4:return a=e.sent,e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,yt(u,n,r,a.authenticationToken);case 10:is.a.getWorkspaceUserInterfaceProperties(n,o),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}p.a.register("workspace.actions.setWorkspaceUserInterfaceLayoutStyle",Cl);var Fl=Al;function ql(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Bl(e){return Vl.apply(this,arguments)}function Vl(){return(Vl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ql(a,r,o,u,i,"next",e)}function i(e){ql(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workspaceGuid,r=t.notebookDisplayOrder,o=t.updateVersion,e.prev=1,e.next=4,Bn.a.getLocationForWorkspaceGuid();case 4:return a=e.sent,e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,kt(u,n,r,a.authenticationToken);case 10:return e.next=12,Il({workspaceGuid:n,updateVersion:o});case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(1),e.t0;case 17:case"end":return e.stop()}},e,null,[[1,14]])}))).apply(this,arguments)}p.a.register("workspace.actions.setNoteUserInterfaceDisplayOrder",Al);var Hl=Bl;function Yl(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Jl(e){return Kl.apply(this,arguments)}function Kl(){return(Kl=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Yl(a,r,o,u,i,"next",e)}function i(e){Yl(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workspaceGuid,r=t.updatedColors,o=t.updateVersion,e.prev=1,e.next=4,Bn.a.getLocationForWorkspaceGuid();case 4:return a=e.sent,e.next=7,qn.fromLocator(a);case 7:return u=e.sent,e.next=10,Nt(u,n,r,a.authenticationToken);case 10:Il({workspaceGuid:n,updateVersion:o}),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}p.a.register("workspace.actions.setNotebookUserInterfaceDisplayOrder",Bl);var Xl=Jl;function zl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(r=(u=i.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ql(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("workspace.actions.setNotebookUserInterfaceColors",Jl);var Zl=Object(i.default)("ion:actions:catchupStragglers");function $l(){return eh.apply(this,arguments)}function eh(){return(eh=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ql(a,r,o,u,i,"next",e)}function i(e){Ql(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(){var t,n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("notebook.actions.getCatchupNotebooks");case 2:return t=e.sent,e.next=5,p.a.call("workspace.actions.getCatchupGuids");case 5:return n=e.sent,e.next=8,Bn.a.getDefaultLocator();case 8:if(r=e.sent,!n.length){e.next=18;break}return e.prev=10,e.next=13,qu({locator:r,workspaceGuids:n});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),Zl.error("catchup failed for workspaces",e.t0);case 18:return o=t.map(function(e){return[e.guid,new Bn.a(e.personal,e.sharedToMe,e.shard)]}).reduce(function(e,t){var n=zl(t,2),r=n[0],o=n[1],a="".concat(o.shard||"","_").concat(o.personal?"P":"B");return null==e[a]&&(e[a]={nbs:[],locator:o}),e[a].nbs.push(r),e},{}),e.prev=19,e.next=22,Promise.all(Object.keys(o).map(function(e){var t=o[e],n=t.nbs,r=t.locator;return qu({locator:r,notebookGuids:n})}));case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(19),Zl.error("catchup failed for notebooks",e.t1);case 27:case"end":return e.stop()}},e,null,[[10,15],[19,24]])}))).apply(this,arguments)}var th=$l;function nh(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function rh(e){return oh.apply(this,arguments)}function oh(){return(oh=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){nh(a,r,o,u,i,"next",e)}function i(e){nh(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,pt(r,t);case 9:return o=e.sent,e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,13]])}))).apply(this,arguments)}p.a.register("sync.actions.catchupstragglers",$l);var ah=rh;p.a.register("sync.actions.getWithMetrics",rh);var uh=n(449),ih=n(391),ch=Symbol("The application needs to restart sync");function sh(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ph(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){sh(a,r,o,u,i,"next",e)}function i(e){sh(a,r,o,u,i,"throw",e)}u(void 0)})}}var fh=Object(i.default)("ion:sugar:upsync");function lh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!(n&&n<=0||t.sharedToMe)){var o=t.personal?"PERSONAL_USN":"BUSINESS_USN";if(n===e[o]+r)e[o]=n;else if(n&&n>e[o])throw ch}}function hh(e){return vh.apply(this,arguments)}function vh(){return(vh=ph(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dh(t);case 2:return e.next=4,yh(t);case 4:return e.next=6,Th(t);case 6:return e.next=8,Rh(t);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dh(e){return mh.apply(this,arguments)}function mh(){return(mh=ph(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("tag.actions.getdirty");case 2:n=e.sent,r=0,o=Object.keys(n);case 4:if(!(r<o.length)){e.next=17;break}return a=o[r],e.next=8,gh(a,n[a]);case 8:if(!(u=e.sent)){e.next=14;break}return e.next=12,Bn.a.getDefaultLocator();case 12:i=e.sent,lh(t,i,u);case 14:r++,e.next=4;break;case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gh(e,t){return bh.apply(this,arguments)}function bh(){return(bh=ph(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,e.prev=1,!n.isDeleted){e.next=8;break}return e.next=5,p.a.call("tag.actions.deleteService",t);case 5:r=e.sent,e.next=9;break;case 8:fh.error("trying to upsync edited tag ".concat(t,", but editing tags is not supported in Ion"));case 9:return e.next=11,p.a.call("tag.actions.cleardirty",t);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),fh.error("could not upsync tag ".concat(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function yh(e){return wh.apply(this,arguments)}function wh(){return(wh=ph(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("notebook.actions.getdirty");case 2:n=e.sent,r=0,o=Object.keys(n);case 4:if(!(r<o.length)){e.next=17;break}return a=o[r],e.next=8,kh(a,n[a]);case 8:if(!(u=e.sent)){e.next=14;break}return e.next=12,Bn.a.getLocationForNotebookGuid(a);case 12:i=e.sent,lh(t,i,u);case 14:r++,e.next=4;break;case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kh(e,t){return xh.apply(this,arguments)}function xh(){return(xh=ph(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,e.prev=1,!n.isDeleted){e.next=8;break}return e.next=5,p.a.call("notebook.actions.expungeNotebookService",t);case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,p.a.call("notebook.actions.updateservice",n);case 10:r=e.sent;case 11:return e.next=13,p.a.call("notebook.actions.cleardirty",t);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),fh.error("could not upsync notebook ".concat(t));case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}},e,null,[[1,15]])}))).apply(this,arguments)}function Rh(e){return Ph.apply(this,arguments)}function Ph(){return(Ph=ph(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("note.actions.getdirty");case 2:n=e.sent,r=[],o=[],Object.keys(n).forEach(function(e){var t=n[e];t.isDeleted?r.push(e):o.push(t)}),a=0,u=o;case 7:if(!(a<u.length)){e.next=14;break}return i=u[a],e.next=11,Nh(i);case 11:a++,e.next=7;break;case 14:if(!(r.length>0)){e.next=25;break}return e.next=17,Oh(r);case 17:if(c=e.sent,s=c.lastServerUsn,f=c.completedServiceCalls,!s){e.next=25;break}return e.next=23,Bn.a.getDefaultLocator();case 23:l=e.sent,lh(t,l,s,f);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Nh(e){return Sh.apply(this,arguments)}function Sh(){return(Sh=ph(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.call("note.actions.update",{noteChanges:t,resourcesUpdateRequest:{}});case 3:return e.next=5,p.a.call("note.actions.cleardirty",[t.guid]);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),fh.error("could not upsync note ".concat(t.guid));case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function Oh(e){return Lh.apply(this,arguments)}function Lh(){return(Lh=ph(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={completedServiceCalls:0},e.prev=1,e.next=4,p.a.call("note.actions.expungeNotesService",t);case 4:return n=e.sent,e.next=7,p.a.call("note.actions.cleardirty",t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),fh.error("could not batch up-sync locally deleted guids");case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e,null,[[1,9]])}))).apply(this,arguments)}function Th(e){return Eh.apply(this,arguments)}function Eh(){return(Eh=ph(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("workspace.actions.getdirty");case 2:n=e.sent,r=0,o=Object.keys(n);case 4:if(!(r<o.length)){e.next=17;break}return a=o[r],e.next=8,jh(a,n[a]);case 8:if(!(u=e.sent)){e.next=14;break}return e.next=12,Bn.a.getLocationForWorkspaceGuid();case 12:i=e.sent,lh(t,i,u);case 14:r++,e.next=4;break;case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function jh(e,t){return _h.apply(this,arguments)}function _h(){return(_h=ph(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,e.prev=1,n.isDeleted){e.next=8;break}return e.next=5,p.a.call("workspace.actions.updateService",n);case 5:r=e.sent,e.next=10;break;case 8:return e.next=10,p.a.call("workspace.actions.leaveservice",t);case 10:return e.next=12,p.a.call("workspace.actions.cleardirty",t);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),fh.error("could not upsync workspace ".concat(t));case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}},e,null,[[1,14]])}))).apply(this,arguments)}var Ih=1e3,Uh=25e3,Ch=n(398);function Gh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Wh(e,t,n[t])})}return e}function Wh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dh(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ah(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Dh(a,r,o,u,i,"next",e)}function i(e){Dh(a,r,o,u,i,"throw",e)}u(void 0)})}}var Mh=Object(i.default)("ion:actions:runNoteSyncCycle"),Fh="NOTE_SYNC_ACTION/PERSONAL_SYNC_CYCLE",qh="NOTE_SYNC_ACTION/BUSINESS_SYNC_CYCLE";function Bh(e){return Vh.apply(this,arguments)}function Vh(){return(Vh=Ah(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i,c,s,f,l,h,v,d,m,g,b,y,w,k,x,R,P,N,S,O;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return N=function(){return(N=Ah(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return R(),e.next=3,k();case 3:a=setInterval(k,Uh);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)},P=function(){return N.apply(this,arguments)},R=function(){a&&clearInterval(a)},x=function(){return(x=Ah(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=3;break}return o=!0,e.abrupt("return");case 3:if(r=!0,o=!1,Mh.info("sync cycle started"),e.prev=6,t=function(){var e=n?w():y();return!Go.a.isBootstrappingEnabled()||ih.a.isFullySynced()?d(e):g(e)}(),!n){e.next=13;break}return e.next=11,Promise.all([h(),t]);case 11:e.next=15;break;case 13:return e.next=15,t;case 15:if(Go.a.isUpSyncDisabled()){e.next=20;break}return e.next=18,hh(c);case 18:return e.next=20,f();case 20:e.next=29;break;case 22:if(e.prev=22,e.t0=e.catch(6),e.t0!==ch){e.next=28;break}o=!0,e.next=29;break;case 28:throw e.t0;case 29:return e.prev=29,r=!1,o&&p.a.publish("sync.notes"),Mh.info("sync cycle complete"),e.finish(29);case 34:case"end":return e.stop()}},e,null,[[6,22,29,34]])}))).apply(this,arguments)},k=function(){return x.apply(this,arguments)},w=function(){return new En.SyncChunkFilter({includeNotebooks:!0,includeNotes:!0,includeNotesSharedWithMe:!0,includePreferences:!0,includeSharedNotes:!0,includeTags:!0,includeWorkspaces:!0,includeWorkspacesContent:!0,includeExpunged:!0,includeLinkedNotebooks:!0})},y=function(){return new En.SyncChunkFilter({includeLinkedNotebooks:!0,includeSharedNotes:!0,includePreferences:!0,includeExpunged:!0,includeNotebooks:!0,includeNotes:!0,includeTags:!0})},b=function(){return(b=Ah(regeneratorRuntime.mark(function e(t){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:r=e.sent,a=n?c.PERSONAL_USN:c.BUSINESS_USN,i||(Mh.log("Bootstrap: Initializing syncChunkGenerator with afterUSN ".concat(a)),i=wu({locator:r,syncChunkFilter:t,afterUSN:a}),o=function(){i.next().then(function(e){var t=e.value,o=e.done;if(t&&!o){var a=t.chunk,i=t.firstUpdateCount,s=a.chunkHighUSN;Mh.log("Bootstrap: Syncing down USN: ".concat(s)),n?c.BUSINESS_USN=s:c.PERSONAL_USN=s,f(),Lu({chunk:a,firstUpdateCount:i,shouldCatchup:0===a.updateCount,locator:r}),p.a.publish("app.progress","chunk",s)}else Mh.log("Bootstrap: setting fully synced because generator is done"),p.a.publish("app","synced",!0),u&&(Mh.log("Bootstrap: clearing bootstrap sync interval"),clearInterval(u))})}),u||(u=setInterval(function(){o()},Ih));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},g=function(e){return b.apply(this,arguments)},m=function(){return(m=Ah(regeneratorRuntime.mark(function e(r){var o,a,u,i,s,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getDefaultLocator();case 2:return o=e.sent,e.prev=3,a=n?c.BUSINESS_USN:c.PERSONAL_USN,Ch.a.startDownSync(a),Mh.log("Syncing data starting from afterUSN:",a),e.next=9,Cu({locator:o,syncChunkFilter:r,afterUSN:a});case 9:return u=e.sent,i=u.updateCount,s=u.notebookGuids,p=u.workspaceGuids,e.next=15,qu({locator:o,notebookGuids:s,workspaceGuids:p});case 15:return n?c.BUSINESS_USN=i:c.PERSONAL_USN=i,e.next=18,f();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),t.syncErrorHandler(e.t0);case 23:case"end":return e.stop()}},e,null,[[3,20]])}))).apply(this,arguments)},d=function(e){return m.apply(this,arguments)},v=function(){return(v=Ah(regeneratorRuntime.mark(function e(){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getPersonalLocator();case 2:return n=e.sent,e.prev=3,Mh.log("Syncing personal data starting from afterUSN:",c.PERSONAL_USN),e.next=7,Cu({locator:n,syncChunkFilter:new En.SyncChunkFilter({includeLinkedNotebooks:!0,includeSharedNotes:!0,includePreferences:!0,includeExpunged:!0,includeTags:!0}),afterUSN:c.PERSONAL_USN});case 7:return r=e.sent,o=r.updateCount,a=r.notebookGuids,u=r.workspaceGuids,e.next=13,qu({locator:n,notebookGuids:a,workspaceGuids:u});case 13:return e.next=15,p.a.call("sync.persist");case 15:return c.PERSONAL_USN=o,e.next=18,f();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),t.syncErrorHandler(e.t0);case 23:case"end":return e.stop()}},e,null,[[3,20]])}))).apply(this,arguments)},h=function(){return v.apply(this,arguments)},l=function(){return(l=Ah(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("cupboard.set",{namespace:Object(uh.a)("".concat(t.userId)),key:s,value:c});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},f=function(){return l.apply(this,arguments)},n=t.isBusiness,r=!1,o=!1,a=null,u=null,c={PERSONAL_USN:0,BUSINESS_USN:0},s=n?qh:Fh,e.next=24,p.a.call("cupboard.get",{namespace:Object(uh.a)("".concat(t.userId)),key:s});case 24:return S=e.sent,c=Gh({},c,S),O=p.a.subscribe("sync.notes",function(){P()}),p.a.register("sync.actions.syncbusinessnotes",Ah(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:case"end":return e.stop()}},e)}))),e.next=30,P();case 30:if(!Object(ro.e)()){e.next=33;break}return e.next=33,p.a.call("notebook.actions.getUserNotebook");case 33:return e.next=35,Hh();case 35:return e.abrupt("return",function(){O(),R()});case 36:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Hh(){return Yh.apply(this,arguments)}function Yh(){return(Yh=Ah(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Go.a.isBootstrappingEnabled()){e.next=5;break}return e.next=3,th();case 3:e.next=6;break;case 5:th();case 6:p.a.publish("app.progress","catchupfinished"),Go.a.isBootstrappingEnabled()||p.a.publish("app","synced",!0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jh(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Kh(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Jh(a,r,o,u,i,"next",e)}function i(e){Jh(a,r,o,u,i,"throw",e)}u(void 0)})}}var Xh=Object(i.default)("ion:action:processMessageSyncChunk");function zh(e){return Qh.apply(this,arguments)}function Qh(){return(Qh=Kh(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("user.actions.getvaultuserid");case 2:return n=e.sent,e.next=5,ev(t,function(e){return e===n});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zh(e){return $h.apply(this,arguments)}function $h(){return($h=Kh(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("user.actions.getactiveuser");case 2:if(n=e.sent){e.next=5;break}throw new Error("no user???");case 5:return e.next=7,ev(t,function(e){return e===n.id});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ev(e,t){return tv.apply(this,arguments)}function tv(){return(tv=Kh(regeneratorRuntime.mark(function e(t,n){var r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.call("user.actions.getactiveuser");case 2:if(r=e.sent){e.next=5;break}throw new Error("no user???");case 5:return e.next=7,p.a.call("attachments.actions.getattachments");case 7:o=e.sent,null!=t.messages&&t.messages.length>0&&(a=t.messages.reduce(function(e,t){return(t.attachments||[]).reduce(function(e,a){if(null==a.guid)return Xh.warn("Unexpected Thrift change! Detecting attachments with no GUID!"),e;var u=o[a.guid],i=u&&u.senderId===r.id;if(u&&!i)return e;if(e[a.guid]&&e[a.guid].senderId!==r.id)return e;if(null!=a.guid){var c=a.guid,s=a.title,p=a.type,f=a.shardId,l=a.userId,h=t.senderId,v=t.sentAt,d=n(a.userId)?l:r.id;e[c]={guid:c,title:s,type:p,createdAt:v,senderId:h,shardId:f,userId:d,external:!n(a.userId)}}return e},e)},{}),p.a.publish("attachments","update",a)),null!=t.threads&&t.threads.length>0&&p.a.publish("service.threads","update",t.threads),null!=t.identities&&t.identities.length>0&&p.a.publish("identity","set",t.identities);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function nv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function rv(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){nv(a,r,o,u,i,"next",e)}function i(e){nv(a,r,o,u,i,"throw",e)}u(void 0)})}}function ov(e){return av.apply(this,arguments)}function av(){return(av=rv(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.eventId,r=t.locator,e.next=3,cv({eventId:n,locator:r,processMessageSyncChunk:zh});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function uv(e){return iv.apply(this,arguments)}function iv(){return(iv=rv(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.eventId,r=t.locator,e.next=3,cv({eventId:n,locator:r,processMessageSyncChunk:Zh});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cv(e){return sv.apply(this,arguments)}function sv(){return(sv=rv(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.eventId,r=t.locator,o=t.processMessageSyncChunk,e.prev=1,e.next=4,lc.fromLocator(r);case 4:return a=e.sent,e.next=7,ec(a,new ic.MessageSyncFilter({afterEventId:n}),r.authenticationToken);case 7:return(u=e.sent).chunkMaxEventId&&n<u.chunkMaxEventId&&setTimeout(function(){u.chunkMaxEventId&&n<u.chunkMaxEventId&&o(u)},0),e.abrupt("return",{newEventId:u.chunkMaxEventId,userEventId:u.userMaxEventId||0});case 12:throw e.prev=12,e.t0=e.catch(1),e.t0;case 15:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function pv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){fv(e,t,n[t])})}return e}function fv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function hv(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){lv(a,r,o,u,i,"next",e)}function i(e){lv(a,r,o,u,i,"throw",e)}u(void 0)})}}var vv="MSG_SYNC_ACTION/PERSONAL_SYNC_CYCLE",dv="MSG_SYNC_ACTION/BUSINESS_SYNC_CYCLE";function mv(e){return gv.apply(this,arguments)}function gv(){return(gv=hv(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xv(t,{namespace:vv,getMessageSyncChunk:uv}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bv(){return(bv=hv(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mv(t);case 2:(0,e.sent)();case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function yv(e){return wv.apply(this,arguments)}function wv(){return(wv=hv(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xv(t,{namespace:dv,getMessageSyncChunk:ov}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kv(){return(kv=hv(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yv(t);case 2:(0,e.sent)();case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xv(e,t){return Rv.apply(this,arguments)}function Rv(){return(Rv=hv(regeneratorRuntime.mark(function e(t,n){var r,o,a,u,i,c,s,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){r&&clearInterval(r)},c=function(){return(c=hv(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s(),e.next=3,a();case 3:r=setInterval(a,Uh);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)},i=function(){return c.apply(this,arguments)},u=function(){return(u=hv(regeneratorRuntime.mark(function e(){var r,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=o.MESSAGE_EVENT_ID,u=r;case 2:return e.next=4,n.getMessageSyncChunk({eventId:u,locator:t.locator});case 4:i=e.sent,u=i.newEventId,a=i.userEventId;case 7:if(u!==a&&null!=u){e.next=2;break}case 8:return e.next=10,p.a.call("sync.persist");case 10:return o.MESSAGE_EVENT_ID=a,e.next=13,p.a.call("cupboard.set",{namespace:Object(uh.a)("".concat(t.userId)),key:n.namespace,value:o});case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)},a=function(){return u.apply(this,arguments)},r=null,o={MESSAGE_EVENT_ID:0},e.next=9,p.a.call("cupboard.get",{namespace:Object(uh.a)("".concat(t.userId)),key:n.namespace});case 9:return f=e.sent,o=pv({},o,f),l=p.a.subscribe("sync.actions.syncworkchat",function(){i()}),e.next=14,i();case 14:return e.abrupt("return",function(){l(),s()});case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("sync.actions.runPersonalMessageSyncCycleOnce",function(e){return bv.apply(this,arguments)}),p.a.register("sync.actions.runBusinessMessageSyncCycleOnce",function(e){return kv.apply(this,arguments)});var Pv=Object(i.default)("ion-actions:sync:error"),Nv=function(e){return function(t){Pv.error(t),"function"==typeof ProgressEvent&&t instanceof ProgressEvent||("errorCode"in t&&(t.errorCode===s.EDAMErrorCode.INVALID_AUTH||t.errorCode===s.EDAMErrorCode.AUTH_EXPIRED)?e.badAuthHandler():"errorCode"in t&&t.errorCode===s.EDAMErrorCode.PERMISSION_DENIED?e.permissionDeniedHandler():p.a.publish("app.service","syncError",{},!1))}};function Sv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ov(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Sv(a,r,o,u,i,"next",e)}function i(e){Sv(a,r,o,u,i,"throw",e)}u(void 0)})}}var Lv={badAuthHandler:o.e,permissionDeniedHandler:o.e};function Tv(e){return Ev.apply(this,arguments)}function Ev(){return(Ev=Ov(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getPersonalLocator();case 2:return n=e.sent,r={syncErrorHandler:Nv(Lv),userId:t.userId,isBusiness:!0},o={locator:n,userId:t.userId},e.next=7,Promise.all([Bh(r),yv(o)]);case 7:a=e.sent,Ch.a.endDownSync(),p.a.register("sync.actions.stopbusinesssynccycle",function(){return a.forEach(function(e){e()}),Promise.resolve()});case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function jv(e){return _v.apply(this,arguments)}function _v(){return(_v=Ov(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn.a.getPersonalLocator();case 2:return n=e.sent,r={syncErrorHandler:Nv(Lv),userId:t.userId,isBusiness:!1},o={locator:n,userId:t.userId},e.next=7,Promise.all([Bh(r),mv(o)]);case 7:a=e.sent,Ch.a.endDownSync(),p.a.register("sync.actions.stoppersonalsynccycle",function(){return a.forEach(function(e){e()}),Promise.resolve()});case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Iv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Uv(e){return Cv.apply(this,arguments)}function Cv(){return(Cv=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Iv(a,r,o,u,i,"next",e)}function i(e){Iv(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,no.fromLocator(n);case 6:return r=e.sent,e.next=9,nr(r,t,n.authenticationToken);case 9:return o=e.sent,p.a.publish("submitfeedback","fileSupportTicket",o),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}p.a.register("sync.actions.runpersonalsynccycle",jv),p.a.register("sync.actions.runbusinesssynccycle",Tv);var Gv=Uv;function Wv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Dv(e){return Av.apply(this,arguments)}function Av(){return(Av=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Wv(a,r,o,u,i,"next",e)}function i(e){Wv(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getDefaultLocator();case 3:return n=e.sent,e.next=6,qn.fromLocator(n);case 6:return r=e.sent,e.next=9,cn(r,t,n.authenticationToken);case 9:return o=e.sent,e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,13]])}))).apply(this,arguments)}p.a.register("submitfeedback.actions.filesupportticket",Uv);var Mv=Dv;function Fv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function qv(e){return Bv.apply(this,arguments)}function Bv(){return(Bv=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Fv(a,r,o,u,i,"next",e)}function i(e){Fv(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("#findSearchSuggestionsV2 request is required");case 2:return e.prev=2,e.next=5,Bn.a.getDefaultLocator();case 5:return n=e.sent,e.next=8,qn.fromLocator(n);case 8:return r=e.sent,e.next=11,me(r,t,n.authenticationToken);case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(2),e.t0;case 17:case"end":return e.stop()}},e,null,[[2,14]])}))).apply(this,arguments)}p.a.register("logrequest.actions.send",Dv);var Vv=qv;p.a.register("search.actions.findSearchSuggestionsV2",qv);function Hv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Yv(){return(Yv=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Hv(a,r,o,u,i,"next",e)}function i(e){Hv(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("experimentsService","getProps2",function(e){return t.getProps2(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Jv=function(e,t,n){return Yv.apply(this,arguments)};function Kv(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Xv(){return(Xv=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Kv(a,r,o,u,i,"next",e)}function i(e){Kv(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("experimentsService","getServiceState2",function(e){return t.getServiceState2(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var zv=function(e,t,n){return Xv.apply(this,arguments)},Qv=n(635);function Zv(e){return(Zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $v(e,t){return!t||"object"!==Zv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ed(e){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function td(e,t){return(td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nd=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=$v(this,(e=ed(t)).call.apply(e,[this].concat(o)))).endpoint="experiments",n.InterfaceConstructor=function(e){return new Qv.ExperimentsService.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&td(e,t)}(t,Wn),t}()),rd=n(634),od=n.n(rd);function ad(e){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ud(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function id(e){return cd.apply(this,arguments)}function cd(){return(cd=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){ud(a,r,o,u,i,"next",e)}function i(e){ud(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("request is null");case 2:return e.prev=2,e.next=5,Bn.a.getPersonalLocator();case 5:return n=e.sent,e.next=8,nd.fromLocator(n);case 8:return r=e.sent,e.next=11,Jv(r,t,n.authenticationToken);case 11:if(null!=(o=e.sent)&&null!=o.jsonResponse){e.next=14;break}throw new Error("getProps response is null");case 14:return a=JSON.parse(o.jsonResponse),u=a.props.ion_props.copy_props,i=od()(a),u&&i&&i.props&&i.props.ionProps&&"object"===ad(i.props.ionProps)&&(i.props.ionProps.copyProps=u),e.abrupt("return",i);case 21:throw e.prev=21,e.t0=e.catch(2),e.t0;case 24:case"end":return e.stop()}},e,null,[[2,21]])}))).apply(this,arguments)}var sd=id;function pd(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function fd(e){return ld.apply(this,arguments)}function ld(){return(ld=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){pd(a,r,o,u,i,"next",e)}function i(e){pd(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("request is null");case 2:return e.prev=2,e.next=5,Bn.a.getPersonalLocator();case 5:return n=e.sent,e.next=8,nd.fromLocator(n);case 8:return r=e.sent,e.next=11,zv(r,t,n.authenticationToken);case 11:if(null!=(o=e.sent)&&null!=o.jsonResponse){e.next=14;break}throw new Error("getservicestate response is null");case 14:return e.abrupt("return",od()(JSON.parse(o.jsonResponse)));case 17:throw e.prev=17,e.t0=e.catch(2),e.t0;case 20:case"end":return e.stop()}},e,null,[[2,17]])}))).apply(this,arguments)}p.a.register("experiments.actions.getprops",id);var hd=fd;function vd(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function dd(){return(dd=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){vd(a,r,o,u,i,"next",e)}function i(e){vd(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("communicationengine","syncMessages",function(e){return t.syncMessages(r||Object(o.a)(),n,e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.a.register("experiments.actions.getservicestate",fd);var md=function(e,t,n){return dd.apply(this,arguments)},gd=n(818);function bd(e){return(bd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yd(e,t){return!t||"object"!==bd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wd(e){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kd(e,t){return(kd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xd=new(function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=yd(this,(e=wd(t)).call.apply(e,[this].concat(o)))).endpoint="communicationengine",n.InterfaceConstructor=function(e){return new gd.CommunicationEngine.Client(e)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kd(e,t)}(t,Wn),t}());function Rd(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Pd(e){return Nd.apply(this,arguments)}function Nd(){return(Nd=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Rd(a,r,o,u,i,"next",e)}function i(e){Rd(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Bn.a.getPersonalLocator();case 3:return n=e.sent,e.next=6,xd.fromLocator(n);case 6:return r=e.sent,e.next=9,md(r,t,n.authenticationToken);case 9:return o=e.sent,e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,null,[[0,13]])}))).apply(this,arguments)}var Sd=Pd;function Od(e){return p.a.publish("commengine","set",e),Promise.resolve()}p.a.register("commengine.actions.syncmessages",Pd);var Ld=Od;function Td(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("commengine.actions.updatecommengine",Od);var Ed=Object(i.default)("ion:actions:createMessageThread");function jd(e){return _d.apply(this,arguments)}function _d(){return(_d=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Td(a,r,o,u,i,"next",e)}function i(e){Td(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.threadSpec,e.prev=1,e.next=4,Bn.a.getPersonalLocator();case 4:return r=e.sent,e.next=7,lc.fromLocator(r);case 7:return o=e.sent,e.next=10,Qi(o,n,r.authenticationToken||"");case 10:e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(1),e.t0.errorCode!==s.EDAMErrorCode.TOO_MANY||"thread"!==e.t0.parameter){e.next=16;break}return e.abrupt("return");case 16:throw Ed.log(e.t0),e.t0;case 18:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}var Id=jd;function Ud(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}p.a.register("workchat.actions.createMessageThread",jd);var Cd=Object(i.default)("ion:actions:sendMessageToThread");function Gd(e){return Wd.apply(this,arguments)}function Wd(){return(Wd=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Ud(a,r,o,u,i,"next",e)}function i(e){Ud(a,r,o,u,i,"throw",e)}u(void 0)})}}(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,e.prev=1,e.next=4,Bn.a.getPersonalLocator();case 4:return r=e.sent,e.next=7,lc.fromLocator(r);case 7:return o=e.sent,e.next=10,uc(o,n,r.authenticationToken);case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),Cd.log(e.t0),e.t0;case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}var Dd=Gd;function Ad(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(r=(u=i.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Md(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Fd(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){Md(a,r,o,u,i,"next",e)}function i(e){Md(a,r,o,u,i,"throw",e)}u(void 0)})}}p.a.register("workchat.actions.sendMessageToThread",Gd);var qd=Object(i.default)("ion:actions:bootstrapShortcuts");function Bd(){return Vd.apply(this,arguments)}function Vd(){return(Vd=Fd(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Lc(["evernote.shortcuts"]);case 3:return t=e.sent,n=t.preferences?t.preferences["evernote.shortcuts"]:[],r=n.map(function(e){return JSON.parse(e)}).filter(function(e){return null==e.updated}).reduce(function(e,t){var n=Ad(t,2),r=n[0],o=n[1];return null==e[r]&&(e[r]=[]),e[r].push(o),e},{}),e.next=8,Promise.all(Object.keys(r).map(function(e){var t=r[e];switch(e){case"Note":return Promise.all(t.map(function(){var e=Fd(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Is({guid:t});case 3:e.next=10;break;case 5:if(e.prev=5,e.t0=e.catch(0),e.t0.errorCode===s.EDAMErrorCode.PERMISSION_DENIED){e.next=10;break}throw qd.error(e.t0),e.t0;case 10:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()));case"Notebook":return Promise.all(t.map(function(){var e=Fd(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Yo(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),qd.error(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()));default:return Promise.resolve()}}));case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),qd.error(e.t0),e.t0;case 14:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}var Hd=Bd;p.a.register("shortcuts.actions.bootstrap",Bd),n.d(t,"authenticateToSharedNotebook",function(){return Jn}),n.d(t,"bootstrapAllNotebooks",function(){return yo}),n.d(t,"createNotebookInWorkspace",function(){return No}),n.d(t,"createNotebook",function(){return jo}),n.d(t,"expungeLinkedNotebook",function(){return Co}),n.d(t,"expungeNotebookService",function(){return Mo}),n.d(t,"getNotebook",function(){return Yo}),n.d(t,"getNotebookShares",function(){return zo}),n.d(t,"getDefaultNotebook",function(){return ea}),n.d(t,"getUserNotebook",function(){return oa}),n.d(t,"getLinkedNotebook",function(){return wa}),n.d(t,"createLinkedNotebook",function(){return Pa}),n.d(t,"getOrCreateLinkedNotebook",function(){return La}),n.d(t,"joinLinkedNotebook",function(){return Ia}),n.d(t,"joinNotebook",function(){return Ku}),n.d(t,"leaveNotebook",function(){return Zu}),n.d(t,"listNotebooks",function(){return vo}),n.d(t,"listLinkedNotebooks",function(){return ri}),n.d(t,"listSharedNotebooks",function(){return io}),n.d(t,"manageNotebookShares",function(){return mi}),n.d(t,"moveNotebookToAccount",function(){return wi}),n.d(t,"setNotebookRecipientSettings",function(){return Si}),n.d(t,"shareNotebook",function(){return Ei}),n.d(t,"shareNotebookToSelf",function(){return Ui}),n.d(t,"updateNotebookService",function(){return Mi}),n.d(t,"authenticateToBusiness",function(){return Vi}),n.d(t,"getTsdEligibility",function(){return Ki}),n.d(t,"getThreadsAndIdentities",function(){return mc}),n.d(t,"getUser",function(){return su}),n.d(t,"getUserRestrictions",function(){return wc}),n.d(t,"listBusinessUsers",function(){return Za}),n.d(t,"sendVerificationEmail",function(){return Pc}),n.d(t,"updateBusinessUsersIfNecessary",function(){return tu}),n.d(t,"getPreferences",function(){return Lc}),n.d(t,"updatePreferences",function(){return _c}),n.d(t,"getPromotionStatus",function(){return Gc}),n.d(t,"promotionOptOut",function(){return Mc}),n.d(t,"showPromotion",function(){return Vc}),n.d(t,"getCrossPromotionInfo",function(){return Kc}),n.d(t,"acquireNoteLock",function(){return Zc}),n.d(t,"addResourceToNote",function(){return os}),n.d(t,"copyNote",function(){return ls}),n.d(t,"createNote",function(){return bs}),n.d(t,"findNotesMetadata",function(){return Ns}),n.d(t,"createNoteShare",function(){return Ds}),n.d(t,"expungeNotesService",function(){return Bs}),n.d(t,"getNote",function(){return Is}),n.d(t,"getNoteLockStatus",function(){return Js}),n.d(t,"getNoteResourceMap",function(){return Zs}),n.d(t,"getNoteShares",function(){return np}),n.d(t,"getNoteSnippets",function(){return fp}),n.d(t,"manageNoteShares",function(){return gp}),n.d(t,"releaseNoteLock",function(){return kp}),n.d(t,"selectNote",function(){return Op}),n.d(t,"shareNote",function(){return jp}),n.d(t,"stopSharingNote",function(){return Cp}),n.d(t,"updateNote",function(){return nf}),n.d(t,"updateNoteLock",function(){return uf}),n.d(t,"bootstrapTags",function(){return yf}),n.d(t,"createTag",function(){return Rf}),n.d(t,"deleteTagService",function(){return Of}),n.d(t,"findNoteCounts",function(){return df}),n.d(t,"listTags",function(){return ff}),n.d(t,"listTagsByNotebook",function(){return jf}),n.d(t,"updateTag",function(){return Cf}),n.d(t,"addUsersToWorkspace",function(){return Xf}),n.d(t,"bootstrapWorkspace",function(){return rl}),n.d(t,"bootstrapWorkspaces",function(){return il}),n.d(t,"createWorkspace",function(){return fl}),n.d(t,"getWorkspace",function(){return Ff}),n.d(t,"getWorkspaceContent",function(){return $f}),n.d(t,"leaveWorkspaceService",function(){return ml}),n.d(t,"manageWorkspaceSharing",function(){return Hf}),n.d(t,"removeUsersFromWorkspace",function(){return wl}),n.d(t,"seeWorkspace",function(){return Nl}),n.d(t,"updateWorkspaceService",function(){return Tl}),n.d(t,"getWorkspaceUserInterfaceProperties",function(){return Il}),n.d(t,"setWorkspaceUserInterfaceLayoutStyle",function(){return Wl}),n.d(t,"setNoteUserInterfaceDisplayOrder",function(){return Fl}),n.d(t,"setNotebookUserInterfaceDisplayOrder",function(){return Hl}),n.d(t,"setNotebookUserInterfaceColors",function(){return Xl}),n.d(t,"catchupStragglers",function(){return th}),n.d(t,"catchupSync",function(){return qu}),n.d(t,"getFilteredSyncChunk",function(){return Cu}),n.d(t,"filteredSyncChunkGenerator",function(){return wu}),n.d(t,"getSyncState",function(){return vu}),n.d(t,"getSyncStateWithMetrics",function(){return ah}),n.d(t,"processSyncChunk",function(){return Lu}),n.d(t,"runBusinessSyncCycle",function(){return Tv}),n.d(t,"runPersonalSyncCycle",function(){return jv}),n.d(t,"fileSupportTicket",function(){return Gv}),n.d(t,"sendLogRequest",function(){return Mv}),n.d(t,"findSearchSuggestionsV2",function(){return Vv}),n.d(t,"getProps",function(){return sd}),n.d(t,"getServiceState",function(){return hd}),n.d(t,"syncMessages",function(){return Sd}),n.d(t,"updateCommEngine",function(){return Ld}),n.d(t,"createMessageThread",function(){return Id}),n.d(t,"sendMessageToThread",function(){return Dd}),n.d(t,"bootstrapShortcuts",function(){return Hd})},398:function(e,t,n){"use strict";var r=n(22),o=Object(r.default)("client:utils:TimestampPrinter"),a={now:function(){return 0}};t.a={setTimestampGenerator:function(e){"now"in e?a=e:o.error('invalid timestamp generator! It has no "now" function')},startSelectingNote:function(){var e=a.now();return o.automation("select_note_started: ".concat(e)),e},endRenderingNote:function(){var e=a.now();return o.automation("rendering_note_ended: ".concat(e)),e},startCreatingNote:function(){var e=a.now();return o.automation("create_note_started: ".concat(e)),e},endCreatingNote:function(){var e=a.now();return o.automation("create_note_ended: ".concat(e)),e},markCreatingNoteFailure:function(){o.automation("create_note_ended: -1")},startAddingAttachments:function(){var e=a.now();o.automation("add_attachment_started: ".concat(e))},endAddingAttachments:function(){var e=a.now();o.automation("add_attachment_ended: ".concat(e))},markAddingAttachmentsFailure:function(){o.automation("add_attachment_ended: -1")},startSearchingNotes:function(){var e=a.now();return o.automation("search_note_started: ".concat(e)),e},endSearchingNotes:function(){var e=a.now();return o.automation("search_note_ended: ".concat(e)),e},startDeletingNote:function(){var e=a.now();o.automation("delete_note_started: ".concat(e))},endDeletingNote:function(){var e=a.now();o.automation("delete_note_ended: ".concat(e))},markDeletingNoteFailure:function(){o.automation("delete_note_ended: -1")},startRenderingIon:function(){var e=a.now();return o.automation("rendering_ion_started: ".concat(e)),e},endRenderingIon:function(){var e=a.now();o.automation("rendering_ion_ended: ".concat(e))},endRenderingNoteListView:function(){var e=a.now();return o.automation("navigate_to_notelist_view_started: ".concat(e)),e},startGoingToAllNotebooks:function(){var e=a.now();o.automation("navigate_to_notebook_kingdom_started: ".concat(e))},endGoingToAllNotebooks:function(){var e=a.now();o.automation("navigate_to_notebook_kingdom_ended: ".concat(e))},startSharingNote:function(){var e=a.now();o.automation("share_note_started: ".concat(e))},endSharingNote:function(){var e=a.now();o.automation("share_note_ended: ".concat(e))},markSharingNoteFailure:function(){o.automation("share_note_ended: -1")},startMovingNotebooktoBusiness:function(){var e=a.now();return o.automation("moving_notebook_to_business_start: ".concat(e)),e},endMovingNotebooktoBusiness:function(){var e=a.now();return o.automation("moving_notebook_to_business_end: ".concat(e)),e},startShowingFirstNote:function(){var e=a.now();return o.automation("start_showing_first_note: ".concat(e)),e},endRenderingFirstNote:function(){var e=a.now();return o.automation("end_rendering_first_note: ".concat(e)),e},startRenderingNoteInAllNotesView:function(){var e=a.now();return o.automation("start_rendering_all_notes_view: ".concat(e)),e},endRenderingNoteInAllNotesView:function(){var e=a.now();return o.automation("end_rendering_note_in_all_notes_view: ".concat(e)),e},beginRenderingAllNotebooks:function(){var e=a.now();return o.automation("start_rendering_all_notebooks_view: ".concat(e)),e},endRenderingAllNotebooks:function(){var e=a.now();return o.automation("end_rendering_all_notebooks_view: ".concat(e)),e},beginRenderingSharedWithMe:function(){var e=a.now();return o.automation("start_rendering_shared_with_me: ".concat(e)),e},endRenderingSharedWithMe:function(){var e=a.now();return o.automation("end_rendering_shared_with_me: ".concat(e)),e},startRenderingTagsKingdomView:function(){var e=a.now();return o.automation("start_rendering_tags_kingdom: ".concat(e)),e},endRenderingTagsKingdomView:function(){var e=a.now();return o.automation("end_rendering_tags_kingdom: ".concat(e)),e},startFocusOnSearchView:function(){var e=a.now();return o.automation("start_focus_search_view: ".concat(e)),e},endFocusOnSearchView:function(){var e=a.now();return o.automation("end_focus_search_view: ".concat(e)),e},startUpdatingNoteToService:function(){var e=a.now();return o.automation("start_update_note_to_service: ".concat(e)),e},endUpdatingNoteToService:function(){var e=a.now();return o.automation("end_update_note_to_service: ".concat(e)),e},startDownSync:function(e){var t=a.now();return o.automation("start_down_sync: ".concat(t," from USN ").concat(e||0)),t},endDownSync:function(){var e=a.now();return o.automation("end_down_sync: ".concat(e)),e}}}}]);