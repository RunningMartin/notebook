(window.webpackJsonp=window.webpackJsonp||[]).push([[8,5],{3159:function(e,t,n){"use strict";n.r(t);var r=n(519),o=n(449),u=n(107),i=n(22);function a(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){a(u,r,o,i,c,"next",e)}function c(e){a(u,r,o,i,c,"throw",e)}i(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var l=Object(i.default)("ion:sugar:lib:DataSource"),p=!1,d=[],b=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=void 0,this.tableName=void 0,this.persistState=void 0,this.state=void 0,this.namespace=void 0,this.dataSourceReady=void 0,this.dataSourceInitialized=void 0,this.resolveReady=void 0,this.resolveInit=void 0,this.unsubscribeFns=void 0,this.name=n,this.tableName=r,this.persistState=o,this.setState(t,!0),this.unsubscribeFns=[],this.initPromises(),d.push(this)}return f(e,null,[{key:"getInstances",value:function(){return d}},{key:"reset",value:function(){p=!1}}]),f(e,[{key:"initPromises",value:function(){var e=this;this.dataSourceReady=new Promise(function(t){e.resolveReady=function(){t()}}),this.dataSourceInitialized=new Promise(function(t){e.resolveInit=t})}},{key:"subscribe",value:function(){throw new Error("must override subscribe")}},{key:"unsubscribe",value:function(){this.unsubscribeFns&&this.unsubscribeFns.length&&(this.unsubscribeFns.forEach(function(e){return e(!0)}),this.unsubscribeFns=[])}},{key:"init",value:function(e){var t=this;return new Promise(function(n){if(t.setState(t.initialState,!0),t.namespace=e,!1===t.persistState)return n();t.loadState().then(function(){return n()})}).then(this.subscribe).then(this.resolveInit)}},{key:"deInit",value:function(){var e=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataSourceInitialized;case 2:this.unsubscribe(),this.initPromises(),this.setState(this.initialState,!0),this.unpublish();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e,t){Object.freeze(e),this.state=e,this.publish(),!t&&this.persistState&&p&&this.saveState(e)}},{key:"getPersistenceName",value:function(){return"ds_".concat(this.tableName)}},{key:"publish",value:function(){u.a.publish("datasources.".concat(this.name),"update",this.mapInternalToExternalState(this.getState()))}},{key:"unpublish",value:function(){u.a.clearTopics("datasources.".concat(this.name))}},{key:"saveState",value:function(e){return r.default.set(Object(o.a)(this.namespace),this.getPersistenceName(),this.dehydrateState(e))}},{key:"saveCurrentState",value:function(){return this.saveState(this.getState())}},{key:"deleteState",value:function(e){var t=this;return new Promise(function(){return r.default.set(Object(o.a)(e),t.getPersistenceName(),void 0)})}},{key:"loadState",value:function(){var e=this;return new Promise(function(t){if(!e.getPersistenceName())return t();r.default.get(Object(o.a)(e.namespace),e.getPersistenceName()).then(function(n){n&&e.setState(e.rehydrateState(n),!0),t()})})}},{key:"dehydrateState",value:function(e){return e}},{key:"rehydrateState",value:function(e){return e}},{key:"mapInternalToExternalState",value:function(e){return e}},{key:"reducer",value:function(e,t){return t.type,e}},{key:"dispatch",value:function(e){d.forEach(function(t){return t._dispatch(e)})}},{key:"_dispatch",value:function(e){var t=this.getState(),n=this.reducer(t,e);n!==t&&this.setState(n,!1)}},{key:"initialState",get:function(){throw new Error("should be overridden")}}]),e}();function y(){return h.apply(this,arguments)}function h(){return(h=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(d.map(function(){var e=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dataSourceInitialized;case 2:if(!t.persistState){e.next=5;break}return e.next=5,t.saveCurrentState();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){g(u,r,o,i,a,"next",e)}function a(e){g(u,r,o,i,a,"throw",e)}i(void 0)})}}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.subscribe("sync.initialsyncdone",function(){!1===p?(l.log("Initial Load finished."),p=!0,y(),Promise.all(d.map(function(e){return e.dataSourceInitialized.then(function(){e.publish(),e.resolveReady()})})).then(function(){return u.a.publish("app.loading","isLoading",!1,!1)})):u.a.publish("app.loading","isLoading",!1,!1)}),u.a.register("sync.persist",c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.log("persisting DataSource"),e.next=3,y();case 3:case"end":return e.stop()}},e)})));var A={UPDATE_ATTACHMENTS:"SUGAR/ATTACHMENTS/UPDATE_ATTACHMENTS"},_={},P="SUGAR/ATTACHMENTS_DATASOURCE",N=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=E(this,O(t).call(this,_,"attachments",P,!0))).subscribe=function(){var t=u.a.subscribe("attachments",function(t){switch(t.type){case"update":return e.Actions.update(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,b),T(t,[{key:"initialState",get:function(){return _}},{key:"Constants",get:function(){return A}}]),T(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case A.UPDATE_ATTACHMENTS:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){m(e,t,n[t])})}return e}({},e,t.attachments);default:return e}}},{key:"Actions",get:function(){var e=this;return{update:function(t){e.dispatch({type:A.UPDATE_ATTACHMENTS,attachments:t})}}}},{key:"Utils",get:function(){return{}}}]),t}()),R=N;function U(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("attachments.actions.getattachments",S(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.dataSourceInitialized;case 2:return e.abrupt("return",N.getState());case 3:case"end":return e.stop()}},e)}))),u.a.register("attachments.actions.getattachment",function(){var e=S(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.dataSourceInitialized;case 2:return e.abrupt("return",N.getState()[t]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var K={SET_COMM_ENGINE:"SUGAR/COMM_ENGINE/SET_COMM_ENGINE"},F={commEngine:null},B="SUGAR/COMM_ENGINE_DATASOURCE",M=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=G(this,j(t).call(this,F,"commengine",B,!0))).subscribe=function(){var t=u.a.subscribe("commengine",function(t){switch(t.type){case"set":return e.Actions.set(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,b),D(t,[{key:"initialState",get:function(){return F}},{key:"Constants",get:function(){return K}}]),D(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case K.SET_COMM_ENGINE:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){C(e,t,n[t])})}return e}({},e,{commEngine:t.commEngine});default:return e}}},{key:"Actions",get:function(){var e=this;return{getCommEngine:function(){return e.getState().commEngine},set:function(t){e.dispatch({type:K.SET_COMM_ENGINE,commEngine:t})}}}},{key:"Utils",get:function(){return{}}}]),t}()),V=M;function H(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("commengine.actions.getcommengine",function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){U(u,r,o,i,a,"next",e)}function a(e){U(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M.Actions.getCommEngine());case 1:case"end":return e.stop()}},e)})));var Z=Object(i.default)("ion:sugar:Config"),$={SET_CONFIG:"SUGAR/CONFIG/SET_CONFIG"},ee={},te="SUGAR/CONFIG_DATASOURCE",ne=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=X(this,Y(t).call(this,ee,"config",te,!0))).subscribe=function(){var t=u.a.subscribe("config",function(t){switch(Z.log("Config subscriber",t),t.type){case"setConfig":var n=t.data,r=n.key,o=n.value;return e.Actions.setConfig(r,o)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,b),Q(t,[{key:"initialState",get:function(){return ee}},{key:"Constants",get:function(){return $}}]),Q(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case $.SET_CONFIG:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){W(e,t,n[t])})}return e}({},e,W({},t.key,t.value));default:return e}}},{key:"Actions",get:function(){var e=this;return{setConfig:function(t,n){e.dispatch({type:$.SET_CONFIG,key:t,value:n})}}}}]),t}()),re=ne;u.a.register("config.actions.getConfig",function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){H(u,r,o,i,a,"next",e)}function a(e){H(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ne.getState()[t]);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var oe=n(450);function ue(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ce(e,t,n[t])})}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,n){return t&&le(e.prototype,t),n&&le(e,n),e}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var be,ye=Object(i.default)("ion:sugar:Promotion");!function(e){e.UPDATE_PROMOTIONS="SUGAR/PROMOTION/UPDATE_PROMOTIONS",e.UPDATE_CROSS_PROMOTIONS="SUGAR/PROMOTION/UPDATE_CROSS_PROMOTIONS",e.DELETE_PROMOTIONS="SUGAR/PROMOTION/DELETE_PROMOTIONS"}(be||(be={}));var he="SUGAR/PROMOTION_DATASOURCE",ge={promotions:{},crossPromotionInfo:null},Se=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=se(this,fe(t).call(this,ge,"promotion",he,!0))).Constants=be,e.subscribe=function(){var t=u.a.subscribe("promotion",function(t){switch(ye.log("Promotion Status subscriber ",t),t.type){case"updatePromotion":return e.Actions.updatePromotions([t.data]);case"updatePromotions":return e.Actions.updatePromotions(t.data);case"updateCrossPromotions":return e.Actions.updateCrossPromotions(t.data);case"deletePromotion":return e.Actions.deletePromotions([t.data]);case"deletePromotions":return e.Actions.deletePromotions(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(t,b),pe(t,[{key:"initialState",get:function(){return ge}}]),pe(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case be.UPDATE_PROMOTIONS:return ae({},e,{promotions:t.promotions.reduce(function(e,t){var n=t.promotionId;if(null==n)return e;var r=ae({},e[n]||{},t);return e[n]=r,e},ae({},e.promotions))});case be.UPDATE_CROSS_PROMOTIONS:return ae({},e,{crossPromotionInfo:t.crossPromotionInfo});case be.DELETE_PROMOTIONS:var n=t.promotionIds,r=ae({},e),o=r.promotions;return n.reduce(function(e,t){return delete e[t],e},o),r;default:return e}}},{key:"Actions",get:function(){var e=this;return{updatePromotions:function(t){e.dispatch({type:be.UPDATE_PROMOTIONS,promotions:t})},updateCrossPromotions:function(t){e.dispatch({type:be.UPDATE_CROSS_PROMOTIONS,crossPromotionInfo:t})},deletePromotions:function(t){e.dispatch({type:be.DELETE_PROMOTIONS,promotionIds:t})}}}}]),t}()),ve=Se;function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Oe(e,t,n[t])})}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t,n){return t&&we(e.prototype,t),n&&we(e,n),e}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("promotion.actions.getCrossPromotionInfo",function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){ue(u,r,o,i,a,"next",e)}function a(e){ue(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.dataSourceInitialized;case 2:return e.abrupt("return",Se.getState().crossPromotionInfo||null);case 3:case"end":return e.stop()}},e)})));oe.FlowIds;var Pe=oe.initialState,Ne="SUGAR/FLOW_DATASOURCE",Re=new(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ke(this,Te(t).call(this,Pe,"flow",Ne,!1))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(t,b),Ae(t,[{key:"subscribe",value:function(){}},{key:"initialState",get:function(){return Pe}}]),Ae(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case be.UPDATE_PROMOTIONS:return t.promotions.filter(function(t){return t.promotionId&&null!=e[t.promotionId]}).reduce(function(e,t){var n=t.shownCount,r=t.promotionId,o=t.optedOut,u=n>0||!!o;return e[r]=Ee({},e[r],{completed:u}),e},Ee({},e));default:return e}}}]),t}()),Ue=n(391);function Ie(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){je(e,t,n[t])})}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xe(e,t){return!t||"object"!==Ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e,t,n){return t&&Le(e.prototype,t),n&&Le(e,n),e}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Be=Object(i.default)("ion:sugar:HVA"),Me={UPDATE_HVAS:"SUGAR/HVA/UPDATE_HVAS"},Ve="SUGAR/HVA_DATASOURCE",He=Ue.a.HVAUtils.initialState,ze=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xe(this,De(t).call(this,He,"hva",Ve,!1))).Constants=Me,e.subscribe=function(){var t=u.a.subscribe("promotion",function(n){switch(Be.log("Promotion Status subscriber ",n),n.type){case"updatePromotion":return e.Actions.updateHVAs([n.data]);case"updatePromotions":return e.Actions.updateHVAs(n.data)}e.unsubscribeFns=[t]})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(t,b),Ke(t,[{key:"initialState",get:function(){return He}}]),Ke(t,[{key:"mapInternalToExternalState",value:function(e){var t=Ge({},e),n=t.groupHVAs,r=t.individualHVAs,o=Object.keys(n).reduce(function(e,t){var n=e[t],r=n.promotion&&n.promotion.optedOut;return null!=r&&(n.isComplete=r),e},n),u=Object.keys(r).reduce(function(e,t){var n=e[t],r=o[n.parentId],u=r&&r.isComplete||n.promotion&&n.promotion.optedOut;return null!=u&&(n.isComplete=u),e},r);return{groupHVAs:o,individualHVAs:u}}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Me.UPDATE_HVAS:var n=Ge({},e),r=n.groupHVAs,o=n.individualHVAs;return t.promotions.forEach(function(e){var t=e.promotionId,n=r[t],u=o[t];n?n.promotion=e:u&&(u.promotion=e)}),n;default:return e}}},{key:"Actions",get:function(){var e=this;return{updateHVAs:function(t){e.dispatch({type:Me.UPDATE_HVAS,promotions:t})}}}}]),t}());u.a.register("hva.actions.complete",function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Ie(u,r,o,i,a,"next",e)}function a(e){Ie(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.a.call("promotion.actions.show",[t]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var We,Xe=n(373);function Ye(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function qe(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Ye(u,r,o,i,a,"next",e)}function a(e){Ye(u,r,o,i,a,"throw",e)}i(void 0)})}}function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ze(e,t,n[t])})}return e}function Ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t,n){return t&&tt(e.prototype,t),n&&tt(e,n),e}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(We||(We={})).SET_IDENTITIES="SUGAR/IDENTITIES/SET_IDENTITIES";var ot={identities:{}},ut="SUGAR/IDENTITY_DATASOURCE",it=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$e(this,et(t).call(this,ot,"identity",ut,!0))).subscribe=function(){var t=u.a.subscribe("identity",function(t){switch(t.type){case"set":return e.Actions.set(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,b),nt(t,[{key:"initialState",get:function(){return ot}},{key:"Constants",get:function(){return We}}]),nt(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case We.SET_IDENTITIES:return Je({},e,{identities:Je({},e.identities,t.identities)});default:return e}}},{key:"Actions",get:function(){var e=this;return{getIdentities:function(){return e.getState().identities},getIdentitiesForUser:function(t){var n=e.Actions.getIdentities(),r=Number(t),o="string"==typeof t&&!Number.isInteger(r);return Object.values(n).filter(function(e){return o?e.contact&&e.contact.id===t:e.userId===r})},getIdentitiesForUsers:function(t){return t.map(function(t){var n=e.Actions.getIdentitiesForUser(t);if(n.length>0)return n[0];var r=Number(t),o="string"==typeof t&&!Number.isInteger(r),u=o?Xe.ContactType.EMAIL:Xe.ContactType.EVERNOTE;return Je({id:NaN,contact:{id:t.toString(),type:u}},o?{}:{userId:r})})},set:function(t){t&&e.dispatch({type:We.SET_IDENTITIES,identities:t.reduce(function(e,t){return null!=t.id&&(e[t.id]=t),e},{})})}}}},{key:"Utils",get:function(){return{}}}]),t}()),at=it;u.a.register("identity.actions.getidentities",qe(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",it.Actions.getIdentities());case 1:case"end":return e.stop()}},e)}))),u.a.register("identity.actions.getidentitiesforusers",function(){var e=qe(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",it.Actions.getIdentitiesForUsers(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("identity.actions.getidentitiesforuser",function(){var e=qe(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",it.Actions.getIdentitiesForUser(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var ct,st=n(57),ft=n.n(st);function lt(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function pt(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){lt(u,r,o,i,a,"next",e)}function a(e){lt(u,r,o,i,a,"throw",e)}i(void 0)})}}function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},u=Object.keys(e);for(r=0;r<u.length;r++)n=u[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(r=0;r<u.length;r++)n=u[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ht(e,t,n[t])})}return e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mt(e,t,n){return t&&vt(e.prototype,t),n&&vt(e,n),e}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e){e.EXPUNGE_LINKED_NOTEBOOKS="SUGAR/LINKED_NOTEBOOK/EXPUNGE_LINKED_NOTEBOOKS",e.UPDATE_LINKED_NOTEBOOKS="SUGAR/LINKED_NOTEBOOK/UPDATE_LINKED_NOTEBOOKS",e.UPDATE_LINKED_NOTEBOOK_TO_ATTACHMENT_MAP="SUGAR/LINKED_NOTEBOOK/UPDATE_LINKED_NOTEBOOK_TO_ATTACHMENT_MAP"}(ct||(ct={}));var Ot={linkedNotebooks:{},linkedNotebookToAttachment:{},dirtyGuids:new Set},kt="SUGAR/LINKED_NOTEBOOK_DATASOURCE",Tt=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=gt(this,St(t).call(this,Ot,"linkednotebook",kt,!0))).subscribe=function(){var t=u.a.subscribe("linkednotebook",function(t){switch(t.type){case"updateLinkedNotebook":return e.Actions.updateLinkedNotebooks([t.data]);case"updateLinkedNotebooks":return e.Actions.updateLinkedNotebooks(t.data);case"updateLinkedNotebooktoAttachmentMap":return e.Actions.updateLinkedNotebooktoAttachmentMap(t.data);case"expungeLinkedNotebook":return e.Actions.expungeLinkedNotebooks([t.data]);case"expungeLinkedNotebooks":return e.Actions.expungeLinkedNotebooks(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(t,b),mt(t,[{key:"initialState",get:function(){return Ot}},{key:"Constants",get:function(){return ct}}]),mt(t,[{key:"mapInternalToExternalState",value:function(e){return{linkedNotebooks:e.linkedNotebooks,linkedNotebookToAttachment:e.linkedNotebookToAttachment}}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case ct.UPDATE_LINKED_NOTEBOOKS:return yt({},e,{linkedNotebooks:t.linkedNotebooks.reduce(function(e,t){var n=t.guid,r=bt(t,["guid"]);return n&&(e[n]=yt({},r,{guid:n})),e},yt({},e.linkedNotebooks))});case ct.EXPUNGE_LINKED_NOTEBOOKS:return yt({},e,{linkedNotebooks:t.guids.reduce(function(e,t){return delete e[t],e},yt({},e.linkedNotebooks))});case ct.UPDATE_LINKED_NOTEBOOK_TO_ATTACHMENT_MAP:var n=t.attachmentGuid,r=t.linkedNotebookGuid,o=e.linkedNotebooks[r].sharedNotebookGlobalId;return o?yt({},e,{linkedNotebookToAttachment:yt({},e.linkedNotebookToAttachment,ht({},o,n))}):e;default:return e}}},{key:"Actions",get:function(){var e=this;return{expungeLinkedNotebooks:function(t){e.dispatch({type:ct.EXPUNGE_LINKED_NOTEBOOKS,guids:t})},updateLinkedNotebooks:function(t){e.dispatch({type:ct.UPDATE_LINKED_NOTEBOOKS,linkedNotebooks:t})},updateLinkedNotebooktoAttachmentMap:function(t){var n=t.attachmentGuid,r=t.linkedNotebookGuid;e.dispatch({type:ct.UPDATE_LINKED_NOTEBOOK_TO_ATTACHMENT_MAP,attachmentGuid:n,linkedNotebookGuid:r})}}}}]),t}()),wt=Tt;u.a.register("linkednotebook.actions.hasnotebook",function(){var e=pt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:return e.abrupt("return",Object.values(Tt.getState().linkedNotebookToAttachment).includes(t));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.getlinkednotebookguids",function(){var e=pt(regeneratorRuntime.mark(function e(t){var n,r,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:return n=Tt.getState(),r=n.linkedNotebookToAttachment,o=n.linkedNotebooks,u=ft.a.invert(r||{})[t],e.abrupt("return",ft.a.filter(o,function(e){return e.sharedNotebookGlobalId===u}).map(function(e){return e.guid}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.hasservicenotebook",function(){var e=pt(regeneratorRuntime.mark(function e(t){var n,r,o,u,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:if(n=Tt.getState(),r=n.linkedNotebooks,o=n.linkedNotebookToAttachment,u=r[t],null!=(i=u.sharedNotebookGlobalId)){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",o[i]);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.getFromGlobalId",function(){var e=pt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:return e.abrupt("return",ft.a.filter(Tt.getState().linkedNotebooks,function(e){return e.sharedNotebookGlobalId===t}));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.getByGuid",function(){var e=pt(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:return n=Tt.getState(),r=n.linkedNotebooks,e.abrupt("return",r[t]);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.getlinkednotebook",function(){var e=pt(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:if(n=Tt.getState(),r=n.linkedNotebookToAttachment,null!=(o=ft.a.invert(r||{})[t])){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,u.a.call("linkednotebook.actions.getFromGlobalId",o);case 8:return e.abrupt("return",e.sent[0]);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("linkednotebook.actions.getdirty",pt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.dataSourceInitialized;case 2:if((t=Tt.getState()).dirtyGuids){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",Array.from(t.dirtyGuids).map(function(e){return t.linkedNotebooks[e]}));case 6:case"end":return e.stop()}},e)})));var At=n(383),_t=n(113),Pt=n(647),Nt=n(556),Rt=n(448),Ut=n(512),It=n(638),Ct=n(402);function Gt(e,t){return Object.keys(t).reduce(function(n,r){var o=e[r];return n[r]=o?ft.a.pick(o,Array.from(t[r])):{guid:r,isDeleted:!0},n},{})}function jt(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function xt(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){jt(u,r,o,i,a,"next",e)}function a(e){jt(u,r,o,i,a,"throw",e)}i(void 0)})}}function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,u=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ft(e,t){return!t||"object"!==Dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bt(e){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vt(e,t,n){return t&&Mt(e.prototype,t),n&&Mt(e,n),e}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Wt(e,t,n[t])})}return e}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xt,Yt="SUGAR/WORKSPACE_DATASOURCE";function qt(e,t){var n=zt({},t.workspaces),r=zt({},t.invitations),o=zt({},t.identityByInvitationsGuid),u=zt({},t.memberships),i=zt({},t.workspaceRestrictions),a=zt({},t.notebookGuids),c=zt({},t.accessInfo),s=zt({},t.notebookRestrictions),f=zt({},t.aggregations),l=zt({},t.activeMemberList);return e.forEach(function(e){delete n[e],delete r[e],delete o[e],delete u[e],delete i[e],delete a[e],delete c[e],delete s[e],delete f[e],delete l[e]}),zt({},t,{workspaces:n,invitations:r,identityByInvitationsGuid:o,memberships:u,workspaceRestrictions:i,notebookGuids:a,accessInfo:c,notebookRestrictions:s,aggregations:f,activeMemberList:l,catchupGuids:ft.a.difference(t.catchupGuids,e)})}!function(e){e.UPDATE_WORKSPACES="SUGAR/WORKSPACE/UPDATE_WORKSPACES",e.SAVE_WORKSPACE="SUGAR/WORKSPACE/SAVE_WORKSPACE",e.LEAVE_WORKSPACE="SUGAR/WORKSPACE/LEAVE_WORKSPACE",e.EXPUNGE_WORKSPACES="SUGAR/WORKSPACE/EXPUNGE_NOTEBOOKS",e.SET_WORKSPACE_USER_INTERFACE_PROPERTIES="SUGAR/WORKSPACE/SET_WORKSPACE_USER_INTERFACE_PROPERTIES",e.SET_ACTIVE_MEMBERS="SUGAR/WORKSPACE/SET_ACTIVE_MEMBERS",e.NEEDS_CATCHUP="SUGAR/WORKSPACE/NEEDS_CATCHUP",e.DID_CATCHUP="SUGAR/WORKSPACE/DID_CATCHUP",e.CLEAR_DIRTY_GUID="SUGAR/WORKSPACE/CLEAR_DIRTY_GUID"}(Xt||(Xt={}));var Qt={workspaces:{},accessInfo:{},aggregations:{},identityByInvitationsGuid:{},invitations:{},memberships:{},notebookGuids:{},notebookRestrictions:{},workspaceRestrictions:{},workspaceUserInterfaceProperties:{},activeMemberList:{},catchupGuids:[],dirtyFlagsCollection:{}},Jt=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ft(this,Bt(t).call(this,Qt,"workspace",Yt,!0))).subscribe=function(){var t=u.a.subscribe("workspace",function(t){switch(t.type){case"setWorkspaceUserInterfaceProperties":return e.Actions.setWorkspaceUserInterfaceProperties(t.data);case"expungeWorkspace":return e.Actions.expunge([t.data]);case"expungeWorkspaces":return e.Actions.expunge(t.data);case"updateWorkspace":return e.Actions.update([t.data]);case"updateWorkspaces":return e.Actions.update(t.data);case"needsCatchup":return e.Actions.needsCatchup(t.data);case"didCatchup":return e.Actions.didCatchup(t.data)}}),n=u.a.subscribe("notebook",function(t){switch(t.type){case"setNotebooksInWorkspaces":It.getActiveUsersForSpaces(t.data).then(function(t){e.Actions.setActiveUsers(t)})}});e.unsubscribeFns=[t,n]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(t,b),Vt(t,[{key:"initialState",get:function(){return Qt}},{key:"Constants",get:function(){return Xt}}]),Vt(t,[{key:"mapInternalToExternalState",value:function(e){var t=e.accessInfo,n=e.activeMemberList,r=e.aggregations,o=e.identityByInvitationsGuid,u=e.invitations,i=e.memberships,a=e.notebookRestrictions,c=e.notebookGuids,s=e.workspaceRestrictions,f=e.workspaces,l=e.workspaceUserInterfaceProperties;return Object.entries(f).reduce(function(e,f){var p=Kt(f,2),d=p[0],b=p[1],y=t[d],h=b.backingNotebookGuid;return null==h?e:(e[d]=zt({},b,{guid:d,backingNotebookGuid:h,accessInfo:y,aggregations:r[d],identityByInvitationsGuid:o[d],invitations:u[d],memberships:i[d],notebookGuids:c[d],notebookRestrictions:a[d],restrictions:s[d],activeMembers:n[d]||[],isSeen:It.isSeen(y),workspaceUserInterfaceProperties:l[d]||null}),e)},{})}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Xt.UPDATE_WORKSPACES:var n=t.workspaces,r=zt({},e.workspaces),o=zt({},e.invitations),u=zt({},e.identityByInvitationsGuid),i=zt({},e.memberships),a=zt({},e.workspaceRestrictions),c=zt({},e.notebookGuids),s=zt({},e.accessInfo),f=zt({},e.notebookRestrictions),l=zt({},e.aggregations);return n.forEach(function(t){var n=t.workspace?t.workspace.guid:t.workspaceGuid;if(null==n)throw new Error("updating a workspace requires a valid guid");var p=r[n];if(null!=p){var d=e.dirtyFlagsCollection[n];if(d){var b=ft.a.pick(p,Array.from(d));Object.assign(t.workspace,b)}}else{var y=e.dirtyFlagsCollection[n];if(y&&y.has("isDeleted"))return}r[n]=t.workspace||e.workspaces[n],o[n]=t.invitations||e.invitations[n],u[n]=t.identityByInvitationsGuid||e.identityByInvitationsGuid[n],i[n]=t.memberships||e.memberships[n],a[n]=t.workspaceRestrictions||e.workspaceRestrictions[n],c[n]=t.notebookGuids||e.notebookGuids[n],s[n]=t.accessInfo||e.accessInfo[n],f[n]=t.notebookRestrictions||e.notebookRestrictions[n],l[n]=t.aggregations||e.aggregations[n]}),zt({},e,{workspaces:r,invitations:o,identityByInvitationsGuid:u,memberships:i,workspaceRestrictions:a,notebookGuids:c,accessInfo:s,notebookRestrictions:f,aggregations:l});case Xt.SAVE_WORKSPACE:var p=t.workspace,d=p.guid;if(null==d)throw new Error("saving a workspace requires a valid guid");var b=zt({},e.workspaces);p.guid&&(b[p.guid]=zt({},b[p.guid],p));var y=zt({},e.dirtyFlagsCollection),h=y[d]||new Set;return Object.keys(p).forEach(function(e){h.add(e)}),y[d]=h,zt({},e,{workspaces:b,dirtyFlagsCollection:y});case Xt.LEAVE_WORKSPACE:var g=t.guid,S=qt([g],e),v=zt({},e.dirtyFlagsCollection);return v[g]=new Set(["isDeleted"]),zt({},S,{dirtyFlagsCollection:v});case Xt.EXPUNGE_WORKSPACES:return qt(t.guids,e);case Xt.SET_WORKSPACE_USER_INTERFACE_PROPERTIES:var m=zt({},e.workspaceUserInterfaceProperties);return m[t.guid]=t.workspaceUserInterfaceProperties,zt({},e,{workspaceUserInterfaceProperties:m});case Xt.SET_ACTIVE_MEMBERS:return zt({},e,{activeMemberList:t.activeUserMap});case Xt.NEEDS_CATCHUP:var E=t.guids;return zt({},e,{catchupGuids:ft.a.uniq([].concat(Lt(e.catchupGuids),Lt(E)))});case Xt.DID_CATCHUP:var O=t.guids;return zt({},e,{catchupGuids:ft.a.difference(e.catchupGuids,O)});case Xt.CLEAR_DIRTY_GUID:var k=zt({},e.dirtyFlagsCollection);return delete k[t.guid],zt({},e,{dirtyFlagsCollection:k});default:return e}}},{key:"Actions",get:function(){var e=this;return{update:function(t){var n=e.getState(),r=t.filter(function(e){var t=e.workspace;return null==t||null==t.guid||((n.workspaces[t.guid]||{}).updateSequenceNum||0)<=(t.updateSequenceNum||0)});e.dispatch({type:Xt.UPDATE_WORKSPACES,workspaces:r})},setWorkspaceUserInterfaceProperties:function(t){var n=t.guid,r=t.workspaceUserInterfaceProperties;e.dispatch({type:Xt.SET_WORKSPACE_USER_INTERFACE_PROPERTIES,guid:n,workspaceUserInterfaceProperties:r})},expunge:function(t){e.dispatch({type:Xt.EXPUNGE_WORKSPACES,guids:t})},leave:function(t){var n=gn.getState();(n.workspaceGuidToNotebookGuids.getValuesAsArray(t)||[]).map(function(e){return n.notebooks[e]}).filter(function(e){return null==e.sharedNotebooks}).map(function(e){return e.guid}).forEach(function(e){return gn.Actions.deleteNotebook(e,!1)}),e.dispatch({type:Xt.LEAVE_WORKSPACE,guid:t})},setActiveUsers:function(t){e.dispatch({type:Xt.SET_ACTIVE_MEMBERS,activeUserMap:t})},needsCatchup:function(t){e.dispatch({type:Xt.NEEDS_CATCHUP,guids:t})},didCatchup:function(t){e.dispatch({type:Xt.DID_CATCHUP,guids:t})}}}}]),t}()),Zt=Jt;u.a.register("workspace.actions.getworkspaceresponse",function(){var e=xt(regeneratorRuntime.mark(function e(t){var n,r,o,u,i,a,c,s,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:return n=Jt.getState(),r=n.accessInfo,o=n.aggregations,u=n.identityByInvitationsGuid,i=n.invitations,a=n.memberships,c=n.notebookGuids,s=n.notebookRestrictions,f=n.workspaceRestrictions,l=n.workspaces,e.abrupt("return",new Ct.WorkspaceResponse({workspace:l[t],invitations:i[t],identityByInvitationsGuid:u[t],memberships:a[t],notebookGuids:c[t],workspaceRestrictions:f[t],aggregations:o[t],notebookRestrictions:s[t],accessInfo:r[t]}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("workspace.actions.getCatchupGuids",xt(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:return e.abrupt("return",Lt(Jt.getState().catchupGuids));case 3:case"end":return e.stop()}},e)}))),u.a.register("workspace.actions.getdirty",xt(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:return t=Jt.getState(),e.abrupt("return",Gt(t.workspaces,t.dirtyFlagsCollection));case 4:case"end":return e.stop()}},e)}))),u.a.register("workspace.actions.cleardirty",function(){var e=xt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:Jt.dispatch({type:Xt.CLEAR_DIRTY_GUID,guid:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("workspace.actions.updateLocal",function(){var e=xt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:Jt.dispatch({type:Xt.SAVE_WORKSPACE,workspace:t}),u.a.publish("sync.notes");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("workspace.actions.leavelocal",function(){var e=xt(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jt.dataSourceInitialized;case 2:Jt.Actions.leave(t),u.a.publish("sync.notes");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var $t=n(437);function en(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function tn(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){en(u,r,o,i,a,"next",e)}function a(e){en(u,r,o,i,a,"throw",e)}i(void 0)})}}function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){un(e,t,n[t])})}return e}function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e,t){return!t||"object"!==nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cn(e){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t,n){return t&&sn(e.prototype,t),n&&sn(e,n),e}function ln(e,t){return(ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pn,dn=Object(i.default)("ion:sugar:Notebook"),bn="SUGAR/NOTEBOOK_DATASOURCE";!function(e){e.UPDATE_NOTEBOOKS="SUGAR/NOTEBOOK/UPDATE_NOTEBOOKS",e.SAVE_NOTEBOOK="SUGAR/NOTEBOOK/SAVE_NOTEBOOK",e.CLEAR_DIRTY_GUID="SUGAR/NOTEBOOK/CLEAR_DIRTY_GUID",e.DELETE_NOTEBOOK_LOCAL="SUGAR/NOTEBOOK/DELETE_NOTEBOOK_LOCAL",e.EXPUNGE_NOTEBOOKS="SUGAR/NOTEBOOK/EXPUNGE_NOTEBOOKS",e.SET_DEFAULT_NOTEBOOK="SUGAR/NOTEBOOK/SET_DEFAULT_NOTEBOOK",e.SET_USER_NOTEBOOK="SUGAR/NOTEBOOK/SET_USER_NOTEBOOK",e.SET_STACK_EXPANDED="SUGAR/NOTEBOOK/SET_STACK_EXPANDED",e.NEEDS_CATCHUP="SUGAR/NOTEBOOK/NEEDS_CATCHUP",e.DID_CATCHUP="SUGAR/NOTEBOOK/DID_CATCHUP"}(pn||(pn={}));var yn={workspaceGuidToNotebookGuids:_t.a.createEmptyMap(),notebookToUpdateInfo:{},notebooks:{},defaultNotebook:null,userNotebook:null,catchupNotebooks:{},dirtyFlagsCollection:{},expandedStacks:new Set},hn=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=an(this,cn(t).call(this,yn,"notebook",bn,!0))).Constants=pn,e.subscribe=function(){var t=u.a.subscribe("notebook",function(t){switch(dn.log("Notebook subscriber ",t),t.type){case"defaultNotebook":return e.Actions.setDefaultNotebook(t.data);case"didCatchup":return e.Actions.didCatchup(t.data);case"expungeNotebook":return e.Actions.expungeNotebooks([t.data]);case"expungeNotebooks":return e.Actions.expungeNotebooks(t.data);case"needsCatchup":return e.Actions.needsCatchup(t.data);case"updateNotebook":var n=t.data,r=n.notebook,o=n.sharedNotebooks;return e.Actions.updateNotebooks({notebooks:[r],sharedNotebooks:o});case"updateNotebooks":var u=t.data,i=u.notebooks,a=u.sharedNotebooks;return e.Actions.updateNotebooks({notebooks:i,sharedNotebooks:a});case"userNotebook":return e.Actions.setUserNotebook(t.data);case"setStackExpanded":return e.Actions.setStackExpanded(t.data.stackName,t.data.expanded)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ln(e,t)}(t,b),fn(t,[{key:"initialState",get:function(){return yn}}]),fn(t,[{key:"rehydrateState",value:function(e){return on({},e,{workspaceGuidToNotebookGuids:_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids)})}},{key:"mapInternalToExternalState",value:function(e){var t=e.notebooks,n=e.notebookToUpdateInfo,r=e.workspaceGuidToNotebookGuids,o=e.defaultNotebook,u=e.userNotebook,i=_t.a.createFromSameInstance(r);return{maxUpdatedMap:Object.keys(n).reduce(function(e,t){return e[t]=n[t].lastUpdatedTime,e},{}),notebooks:t,notebookToLastEditedUserIdMap:Object.keys(n).reduce(function(e,t){return e[t]=n[t].lastUpdatedUserId,e},{}),notebookToWorkspaceMap:i.getInwardObject(),defaultNotebook:o,userNotebook:u,workspaceToNotebooksMap:i.getForwardObject(),expandedStacks:rn(e.expandedStacks||new Set)}}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case pn.UPDATE_NOTEBOOKS:var n=t.notebooks,r=t.sharedNotebooks,o=on({},e.notebooks),u=ft.a.cloneDeep(e.notebookToUpdateInfo);n.forEach(function(t){if(null!=t.guid){var n=t.guid,r=o[n];if(null!=r){null!=r.isTrueOwner&&null==t.isTrueOwner&&(t.isTrueOwner=r.isTrueOwner),null!=r.isOwnedByMyVaultUser&&null==t.isOwnedByMyVaultUser&&(t.isOwnedByMyVaultUser=r.isOwnedByMyVaultUser),null!=r.shardIdFromSharedAuth&&null==t.shardIdFromSharedAuth&&(t.shardIdFromSharedAuth=r.shardIdFromSharedAuth);var i=e.dirtyFlagsCollection[n];if(i){var a=ft.a.pick(r,Array.from(i));Object.assign(t,a)}}else{var c=e.dirtyFlagsCollection[n];if(c&&c.has("isDeleted"))return}o[n]=t;var s=t&&t.serviceUpdated,f=u[n]&&u[n].lastUpdatedTime;f&&s?u[n]=on({},u[n],{lastUpdatedTime:Math.max(s,f)}):s&&(u[n]=on({},u[n],{lastUpdatedTime:s}))}}),r&&r.forEach(function(e){if(null==e.notebookGuid)throw new Error("".concat(e.notebookGuid," should be present"));var t=o[e.notebookGuid];t&&(null==t.sharedNotebooks&&t.sharedNotebookIds&&t.sharedNotebookIds.length>0?t.sharedNotebooks=[e]:t.sharedNotebooks&&t.sharedNotebookIds&&t.sharedNotebooks.length!==t.sharedNotebookIds.length&&t.sharedNotebooks.push(e),o[e.notebookGuid]=t)});var i=_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids);n.forEach(function(e){null!=e.workspaceGuid?i.set(e.workspaceGuid,e.guid):i.removeValue(e.guid)});var a=n.find(function(e){return Boolean(e.defaultNotebook||e.recipientSettings&&e.recipientSettings.recipientStatus===Xe.RecipientStatus.IN_MY_LIST_AND_DEFAULT_NOTEBOOK)})||e.defaultNotebook,c=null!=a?on({},a):null,s=null!=e.userNotebook?on({},e.userNotebook):null;return on({},e,{notebooks:o,notebookToUpdateInfo:u,workspaceGuidToNotebookGuids:i,defaultNotebook:c,userNotebook:s,expandedStacks:this.Utils.getFilteredExpandedStacks(e.expandedStacks,o)});case pn.EXPUNGE_NOTEBOOKS:var f=t.guids,l=on({},e.notebooks),p=_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids),d=on({},e.dirtyFlagsCollection);f.forEach(function(e){p.removeValue(e),delete l[e],delete d[e]});var b=on({},e.catchupNotebooks);return f.forEach(function(e){delete b[e]}),on({},e,{notebooks:l,workspaceGuidToNotebookGuids:p,catchupNotebooks:b,dirtyFlagsCollection:d,expandedStacks:this.Utils.getFilteredExpandedStacks(e.expandedStacks,l)});case pn.DELETE_NOTEBOOK_LOCAL:var y=t.guid,h=t.markDirty,g=on({},e.notebooks);delete g[y];var S=on({},e.dirtyFlagsCollection);return h&&(S[y]=new Set(["isDeleted"])),on({},e,{notebooks:g,dirtyFlagsCollection:S,expandedStacks:this.Utils.getFilteredExpandedStacks(e.expandedStacks,g)});case pn.SAVE_NOTEBOOK:var v=t.changes,m=v.guid,E=v.name,O=v.workspaceGuid;if(null!=E)if(!Ut.a.validateWithoutUnique({name:E}).isValid)throw Error("Notebook name failed validation");var k=on({},e.dirtyFlagsCollection),T=k[m]||new Set;Object.keys(t.changes).forEach(function(e){T.add(e)}),k[m]=T;var w=on({},e.notebooks[m],t.changes),A=on({},e.notebooks,un({},m,w)),_=e.workspaceGuidToNotebookGuids;return void 0!==O&&(_=_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids),null!=O?_.set(O,m):_.removeValue(m)),on({},e,{notebooks:A,dirtyFlagsCollection:k,workspaceGuidToNotebookGuids:_});case Xt.EXPUNGE_WORKSPACES:var P=t.guids,N=_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids);return P.forEach(function(e){return N.removeKey(e)}),on({},e,{workspaceGuidToNotebookGuids:N});case Xt.LEAVE_WORKSPACE:var R=t.guid,U=_t.a.createFromSameInstance(e.workspaceGuidToNotebookGuids);return U.removeKey(R),on({},e,{workspaceGuidToNotebookGuids:U});case pn.SET_DEFAULT_NOTEBOOK:var I=t.notebook;return on({},e,{notebooks:on({},e.notebooks,un({},I.guid,I)),defaultNotebook:I});case pn.SET_USER_NOTEBOOK:var C=t.notebook;return on({},e,{notebooks:on({},e.notebooks,un({},C.guid,C)),userNotebook:C});case pn.SET_STACK_EXPANDED:var G=new Set(e.expandedStacks);return t.expanded?G.add(t.stackName):G.delete(t.stackName),on({},e,{expandedStacks:G});case pn.NEEDS_CATCHUP:var j=t.guids,x=t.locator,D=j.reduce(function(e,t){return e[t]={guid:t,personal:x.personal,shard:x.shard,sharedToMe:x.sharedToMe},e},{});return on({},e,{catchupNotebooks:on({},e.catchupNotebooks,D)});case pn.DID_CATCHUP:var L=t.guids,K=on({},e.catchupNotebooks);return L.forEach(function(e){delete K[e]}),on({},e,{catchupNotebooks:K});case Wn.UPDATE_NOTES:var F=on({},e.notebookToUpdateInfo),B=t.notes.reduce(function(t,n){var r=n.notebookGuid,o=n.updated;if(null==r)return t;var u=e.notebooks[r],i=u&&u.serviceUpdated,a=t[r]&&t[r].lastUpdatedTime;return null==a&&(t[r]={lastUpdatedTime:i,lastUpdatedUserId:null},a=i),a&&o&&o>a&&(t[r].lastUpdatedTime=o,t[r].lastUpdatedUserId=n.attributes?n.attributes.lastEditorId:null),t},F);return on({},e,{notebookToUpdateInfo:B});case pn.CLEAR_DIRTY_GUID:var M=on({},e.dirtyFlagsCollection);return delete M[t.guid],on({},e,{dirtyFlagsCollection:M});default:return e}}},{key:"Actions",get:function(){var e=this;return{updateNotebooks:function(t){var n=t.notebooks,r=t.sharedNotebooks,o=e.getState().notebooks,u=n.filter(function(e){return((o[e.guid]||{}).updateSequenceNum||0)<=(e.updateSequenceNum||0)});e.dispatch({type:pn.UPDATE_NOTEBOOKS,notebooks:u,sharedNotebooks:r})},expungeNotebooks:function(t){e.dispatch({type:pn.EXPUNGE_NOTEBOOKS,guids:t}),t.length>0&&Object($t.d)(t)},deleteNotebook:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.getState(),o=r.notebooks,u=r.defaultNotebook,i=o[t].isTrueOwner;if(i&&(!u||u.guid===t))throw Error("User is attempting to delete a notebook without a valid fallback notebook.");var a=i&&u&&u.guid;e.dispatch({type:pn.DELETE_NOTEBOOK_LOCAL,guid:t,notebookGuidForSalvagedNotes:a,markDirty:n})},saveNotebook:function(t){e.dispatch({type:pn.SAVE_NOTEBOOK,changes:t})},setDefaultNotebook:function(t){e.dispatch({type:pn.SET_DEFAULT_NOTEBOOK,notebook:t})},setUserNotebook:function(t){e.dispatch({type:pn.SET_USER_NOTEBOOK,notebook:t})},setStackExpanded:function(t,n){e.dispatch({type:pn.SET_STACK_EXPANDED,stackName:t,expanded:n})},needsCatchup:function(t){var n=t.guids,r=void 0===n?[]:n,o=t.locator;e.dispatch({type:pn.NEEDS_CATCHUP,guids:r,locator:o})},didCatchup:function(t){e.dispatch({type:pn.DID_CATCHUP,guids:t})}}}},{key:"Utils",get:function(){return{validateName:Ut.a.validationWithoutUnique.name,getFilteredExpandedStacks:function(e,t){var n={};Object.keys(t).forEach(function(e){var r=t[e];r.recipientSettings&&r.recipientSettings.stack&&(n[r.recipientSettings.stack]?n[r.recipientSettings.stack].push(e):n[r.recipientSettings.stack]=[e])});var r=Array.from(e);return new Set(r.filter(function(e){return Object.prototype.hasOwnProperty.call(n,e)}))}}}}]),t}()),gn=hn;function Sn(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function vn(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Sn(u,r,o,i,a,"next",e)}function a(e){Sn(u,r,o,i,a,"throw",e)}i(void 0)})}}function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){On(e,t,n[t])})}return e}function On(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function An(e,t,n){return t&&wn(e.prototype,t),n&&wn(e,n),e}function _n(e,t){return(_n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("notebook.actions.getparentworkspace",function(e){return new Promise(function(t){hn.dataSourceInitialized.then(function(){var n=(hn.getState().notebooks[e]||{}).workspaceGuid;n?u.a.call("workspace.actions.getworkspaceresponse",n).then(function(e){t(e.workspace)}).catch(function(){t(null)}):t(null)})})}),u.a.register("notebook.actions.getnotebook",function(){var e=tn(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("guid is requires for getNotebook call");case 2:return e.next=4,hn.dataSourceInitialized;case 4:if(n=hn.getState(),r=n.notebooks[t]){e.next=8;break}return e.abrupt("return");case 8:return o=n.dirtyFlagsCollection[t]||new Set,e.abrupt("return",on({},r,{dirtyFlags:o}));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("notebook.actions.hasnotebook",function(){var e=tn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t in(hn.getState().notebooks||{}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("notebook.actions.updatelocal",function(){var e=tn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:hn.dispatch({type:pn.SAVE_NOTEBOOK,changes:t}),u.a.publish("sync.notes");case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("notebook.actions.expungeNotebookLocal",function(){var e=tn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.dataSourceInitialized;case 2:hn.Actions.deleteNotebook(t),u.a.publish("sync.notes");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("notebook.actions.hasnotebooks",function(){var e=tn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ft.a.difference(t,Object.keys(hn.getState().notebooks||{})));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("notebook.actions.notebooksinworkspaces",tn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=hn.mapInternalToExternalState(hn.getState()),e.abrupt("return",t.notebookToWorkspaceMap);case 2:case"end":return e.stop()}},e)}))),u.a.register("notebook.actions.getCatchupNotebooks",tn(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.dataSourceInitialized;case 2:return e.abrupt("return",Object.values(hn.getState().catchupNotebooks));case 3:case"end":return e.stop()}},e)}))),u.a.register("notebook.actions.getWorkspaceToNotebookGuids",tn(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.dataSourceInitialized;case 2:return e.abrupt("return",hn.getState().workspaceGuidToNotebookGuids);case 3:case"end":return e.stop()}},e)}))),u.a.register("notebook.actions.getdirty",tn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.dataSourceInitialized;case 2:return t=hn.getState(),e.abrupt("return",Gt(t.notebooks,t.dirtyFlagsCollection));case 4:case"end":return e.stop()}},e)}))),u.a.register("notebook.actions.cleardirty",function(){var e=tn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.dataSourceInitialized;case 2:hn.dispatch({type:pn.CLEAR_DIRTY_GUID,guid:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var Pn=Object(i.default)("ion:sugar:Tag"),Nn="SUGAR/TAG_DATASOURCE",Rn={CLEAR_DIRTY:"SUGAR/TAG/CLEAR_DIRTY",DELETE_TAGS:"SUGAR/TAG/DELETE_TAGS",DELETE_TAG_LOCAL:"SUGAR/TAG/DELETE_TAG_LOCAL",UPDATE_TAGS:"SUGAR/TAG/UPDATE_TAGS",UPDATE_BOOTSTRAP_TAG_COUNTS_BY_GUID:"SUGAR/TAG/UPDATE_BOOTSTRAP_TAG_COUNTS_BY_GUID",SHARED_TAGS_COUNT_BY_NAME:"SUGAR/TAG/SHARED_TAGS_COUNT_BY_NAME",UPDATE_SHARED_TAGS_BY_NOTEBOOK:"SUGAR/TAG/UPDATE_SHARED_TAGS_BY_NOTEBOOK"},Un={tags:{},bootstrapTagCountsByGuid:{},tagsBySharedNotebookGuid:{},sharedNotebookTagCountsByName:{},dirtyFlagsCollection:{}},In=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=kn(this,Tn(t).call(this,Un,"tag",Nn,!0))).subscribe=function(){var t=u.a.subscribe("tag",function(t){switch(Pn.log("Tag subscriber ",t),t.type){case"updateTag":return e.Actions.updateTags([t.data]);case"updateTags":return e.Actions.updateTags(t.data);case"deleteTag":return e.Actions.deleteTags([t.data]);case"deleteTags":return e.Actions.deleteTags(t.data);case"countTag":return e.Actions.updateBootstrapTagCountsByGuid(t.data);case"updateSharedTags":return e.Actions.updateSharedTags(t.data);case"countSharedTags":return e.Actions.updateSharedTagsCountByName(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_n(e,t)}(t,b),An(t,[{key:"initialState",get:function(){return Un}},{key:"Constants",get:function(){return Rn}}]),An(t,[{key:"mapInternalToExternalState",value:function(e){return{tags:e.tags,bootstrapTagCountsByGuid:e.bootstrapTagCountsByGuid,tagsBySharedNotebookGuid:e.tagsBySharedNotebookGuid,sharedNotebookTagCountsByName:e.sharedNotebookTagCountsByName}}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Rn.DELETE_TAGS:var n=t.guids,r=En({},e.tags);return n.reduce(function(e,t){return delete e[t],e},r),En({},e,{tags:r});case Rn.DELETE_TAG_LOCAL:var o=t.guid,u=En({},e.tags),i=En({},e.dirtyFlagsCollection);return delete u[o],i[o]=new Set(["isDeleted"]),En({},e,{tags:u,dirtyFlagsCollection:i});case Rn.CLEAR_DIRTY:var a=t.guid,c=En({},e.dirtyFlagsCollection);return delete c[a],En({},e,{dirtyFlagsCollection:c});case Rn.UPDATE_TAGS:var s=t.tags,f=En({},e.tags);return s.reduce(function(e,t){var n=t.guid,r=t.name;if(null==n||null==r)return e;var o=En({},e[n]||{},t,{guid:n,name:r});return e[n]=o,e},f),En({},e,{tags:f});case Rn.UPDATE_SHARED_TAGS_BY_NOTEBOOK:var l=t.tags,p=t.notebookGuid,d=En({},e.tagsBySharedNotebookGuid[p]);return d=l.reduce(function(e,t){var n=t.guid,r=t.name;if(null==n||null==r)return e;var o=En({},e[n]||{},t,{guid:n,name:r});return e[n]=o,e},d),En({},e,{tagsBySharedNotebookGuid:En({},e.tagsBySharedNotebookGuid,On({},p,d))});case Rn.UPDATE_BOOTSTRAP_TAG_COUNTS_BY_GUID:var b=t.noteCollection;return null==b.tagCounts?e:En({},e,{bootstrapTagCountsByGuid:En({},b.tagCounts)});case Rn.SHARED_TAGS_COUNT_BY_NAME:var y=t.noteCollection,h=t.notebookGuid,g=En({},e.tagsBySharedNotebookGuid[h]),S={};return Object.keys(y.tagCounts||{}).forEach(function(e){S[g[e].name]=y.tagCounts&&y.tagCounts[e]||0}),En({},e,{sharedNotebookTagCountsByName:En({},e.sharedNotebookTagCountsByName,On({},h,S))});default:return e}}},{key:"Actions",get:function(){var e=this;return{updateTags:function(t){e.dispatch({type:Rn.UPDATE_TAGS,tags:t})},updateBootstrapTagCountsByGuid:function(t){e.dispatch({type:Rn.UPDATE_BOOTSTRAP_TAG_COUNTS_BY_GUID,noteCollection:t})},deleteTags:function(t){e.dispatch({type:Rn.DELETE_TAGS,guids:t})},updateSharedTags:function(t){var n=t.tags,r=t.guid;e.dispatch({type:Rn.UPDATE_SHARED_TAGS_BY_NOTEBOOK,tags:n,notebookGuid:r})},updateSharedTagsCountByName:function(t){var n=t.noteCollection,r=t.notebookGuid;e.dispatch({type:Rn.SHARED_TAGS_COUNT_BY_NAME,noteCollection:n,notebookGuid:r})}}}},{key:"Utils",get:function(){return{validateName:Ut.b.validation.name}}}]),t}()),Cn=In;function Gn(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function jn(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Gn(u,r,o,i,a,"next",e)}function a(e){Gn(u,r,o,i,a,"throw",e)}i(void 0)})}}function xn(e){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Kn(e,t,n[t])})}return e}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(e,t){return!t||"object"!==xn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vn(e,t,n){return t&&Mn(e.prototype,t),n&&Mn(e,n),e}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("tag.actions.getdirty",vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,In.dataSourceInitialized;case 2:return t=In.getState(),e.abrupt("return",Gt(t.tags,t.dirtyFlagsCollection));case 4:case"end":return e.stop()}},e)}))),u.a.register("tag.actions.deleteLocal",function(){var e=vn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,In.dataSourceInitialized;case 2:In.dispatch({type:Rn.DELETE_TAG_LOCAL,guid:t}),u.a.publish("sync.notes");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("tag.actions.cleardirty",function(){var e=vn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,In.dataSourceInitialized;case 2:In.dispatch({type:Rn.CLEAR_DIRTY,guid:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var zn,Wn,Xn=Object(i.default)("ion:sugar:Note"),Yn=Object(i.default)("ceReloadDebug:sugar"),qn="SUGAR/NOTE_DATASOURCE";!function(e){e.NO_CONTAINER="NOTE_REMOVING_RULES/NO_CONTAINER"}(zn||(zn={})),function(e){e.UPDATE_NOTES="SUGAR/NOTE/UPDATE_NOTES",e.EXPUNGE_NOTES="SUGAR/NOTE/EXPUNGE_NOTES",e.DELETE_LOCAL="SUGAR/NOTE/DELETE_LOCAL",e.SELECT_NOTE="SUGAR/NOTE/SELECT_NOTE",e.CLEAR_DIRTY="SUGAR/NOTE/CLEAR_DIRTY",e.UPDATE_LOCK="SUGAR/NOTE/UPDATE_LOCK"}(Wn||(Wn={}));var Qn={accessibleNotebookGuids:[],notebookGuidToNoteGuids:_t.a.createEmptyMap(),notes:{},selectedNotes:{},dirtyFlagsCollection:{},locks:{},nextNotesDiff:{}},Jn=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Fn(this,Bn(t).call(this,Qn,"note",qn,!0))).Constants=Wn,e.subscribe=function(){var t=u.a.subscribe("note",function(t){switch(t.type){case"updateNote":return e.Actions.updateNotes([t.data.note],t.data.resultSpec,t.data.locator);case"updateNotes":return e.Actions.updateNotes(t.data.notes,t.data.resultSpec,t.data.locator);case"expungeNote":return e.Actions.expungeNotes([t.data]);case"expungeNotes":return e.Actions.expungeNotes(t.data);case"expungeNotesNoLongerSharedWithMe":return e.Actions.expungeNotesSelectively(t.data.noteGuids,zn.NO_CONTAINER);case"selectNote":return e.Actions.selectNote(t.data.guid,t.data.windowId);case"updateLock":return e.Actions.updateLock(t.data.guid,t.data.lockState)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(t,b),Vn(t,[{key:"initialState",get:function(){return Qn}}]),Vn(t,[{key:"rehydrateState",value:function(e){return Ln({},e,{notebookGuidToNoteGuids:_t.a.createFromSameInstance(e.notebookGuidToNoteGuids)})}},{key:"mapInternalToExternalState",value:function(e){return{dirtyGuids:Object.keys(e.dirtyFlagsCollection),locks:e.locks,nextNotesDiff:e.nextNotesDiff}}},{key:"saveState",value:function(e){var t=e.accessibleNotebookGuids,n=e.notebookGuidToNoteGuids,u=Ln({},e.notes);"web"===Rt.a.platformName&&Object.values(e.selectedNotes).forEach(function(e){var t=u[e];t&&(u[e]=Ln({},t,{content:null}))});var i=Ln({},Qn,{accessibleNotebookGuids:t,notebookGuidToNoteGuids:n,notes:u});return r.default.set(Object(o.a)(this.namespace),this.getPersistenceName(),i)}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Wn.UPDATE_NOTES:var n=t.notes,r=t.resultSpec,o=Ln({},e.notes),u={};n.forEach(function(t){var n=e.notes[t.guid]||{},i=Ln({},n,t),a=n.updateSequenceNum||0,c=t.updateSequenceNum||0,s=e.dirtyFlagsCollection[i.guid];s&&s.has("isDeleted")||(null!=t.content||r.includeContent||(i.content=n.content||null,n.content&&!ft.a.isEqual(t.contentHash,n.contentHash)&&a<c&&(Yn.trace("marking note guid=(".concat(i.guid,") as STALE")),i.stale=!0)),!t.content&&n.content||(Yn.log("marking note guid=(".concat(i.guid,") as NOT STALE")),i.stale=!1),null!=t.sharedNotes||r.includeSharedNotes||(i.sharedNotes=n.sharedNotes||null),null!=t.resources||r.includeContent||(i.resources=n.resources||null),null!=t.limits||r.includeAccountLimits||(i.limits=n.limits||null),null==i.contentHash&&(i.contentHash=n.contentHash||null),null==i.contentLength&&(i.contentLength=n.contentLength||null),o[t.guid]=i,u[t.guid]=i)});var i=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids);return n.filter(function(t){return e.accessibleNotebookGuids.includes(t.notebookGuid)}).forEach(function(e){i.set(e.notebookGuid,e.guid)}),Ln({},e,{notebookGuidToNoteGuids:i,notes:o,nextNotesDiff:u});case pn.UPDATE_NOTEBOOKS:var a=t.notebooks.map(function(e){return e.guid}).filter(function(t){return!e.accessibleNotebookGuids.includes(t)}).concat(e.accessibleNotebookGuids),c=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids);return Object.keys(e.notes).map(function(t){return e.notes[t]}).forEach(function(e){a.includes(e.notebookGuid)&&c.set(e.notebookGuid,e.guid)}),Ln({},e,{accessibleNotebookGuids:a,notebookGuidToNoteGuids:c,nextNotesDiff:{}});case pn.EXPUNGE_NOTEBOOKS:var s=t.guids,f=e.accessibleNotebookGuids.filter(function(e){return!s.includes(e)}),l=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids),p={},d=ft.a.flatMap(s,function(e){return l.getValuesAsArray(e)||[]}).map(function(t){return e.notes[t]}).filter(Nt.isNoteExpungeableWithoutContainerNotebook).map(function(e){return e.guid}).reduce(function(e,t){return delete e[t],p[t]=null,e},Ln({},e.notes));return s.forEach(function(e){l.removeKey(e)}),Ln({},e,{accessibleNotebookGuids:f,notebookGuidToNoteGuids:l,notes:d,nextNotesDiff:p});case Rn.DELETE_TAG_LOCAL:var b=t.guid,y=Ln({},e.notes),h={};return Object.keys(y).forEach(function(e){var t=y[e];if(t.tagGuids){var n=t.tagGuids.indexOf(b);if(n>=0){var r=Dn(t.tagGuids);r.splice(n,1),y[e]=Ln({},t,{tagGuids:r}),h[e]=y[e]}}}),Ln({},e,{notes:y,nextNotesDiff:h});case pn.DELETE_NOTEBOOK_LOCAL:var g=t.guid,S=t.notebookGuidForSalvagedNotes,v=e.notebookGuidToNoteGuids.getValuesAsArray(g);if(!v)return e;var m=Ln({},e.notes),E=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids);E.removeKey(g);var O={};return v.forEach(function(e){S&&null!=m[e]?(m[e]=Ln({},m[e],{active:!1,notebookGuid:S}),O[e]=m[e],E.set(S,e)):(O[e]=null,delete m[e])}),Ln({},e,{notes:m,notebookGuidToNoteGuids:E,nextNotesDiff:O});case Wn.EXPUNGE_NOTES:var k,T=t.guids,w=t.predicate,A=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids);switch(w){case zn.NO_CONTAINER:k=function(e){return!!e&&!A.hasValue(e.guid)};break;default:k=function(e){return!!e}}var _=T.map(function(t){return e.notes[t]}).filter(k).map(function(e){return e.guid}),P={},N=_.reduce(function(e,t){return delete e[t],P[t]=null,e},Ln({},e.notes));return _.forEach(function(e){A.removeValue(e)}),Ln({},e,{notebookGuidToNoteGuids:A,notes:N,nextNotesDiff:P});case Wn.DELETE_LOCAL:var R=t.guids,U=_t.a.createFromSameInstance(e.notebookGuidToNoteGuids),I={},C=R.reduce(function(e,t){return delete e[t],I[t]=null,e},Ln({},e.notes)),G=Ln({},e.dirtyFlagsCollection);return R.forEach(function(e){U.removeValue(e),G[e]=new Set(["isDeleted"])}),Ln({},e,{notebookGuidToNoteGuids:U,notes:C,dirtyFlagsCollection:G,nextNotesDiff:I});case Wn.SELECT_NOTE:var j=e.notes,x=t.guid,D=t.windowId,L=void 0===D?"default":D,K=e.selectedNotes[L],F=e.notes[K],B=e.locks||{};if(K===x)return e;var M={};if(null!=F){var V="web"===Rt.a.platformName?Ln({},F,{_marshalledResources:null,content:null,resources:null}):Ln({},F);M[V.guid]=V,null!=V.guid&&(j=Ln({},j,Kn({},V.guid,V)))}var H=Ln({},e.selectedNotes,Kn({},L,x)),z=Object.keys(H).map(function(e){return H[e]}),W=ft.a.difference(Object.keys(B),z).reduce(function(e,t){return delete e[t],e},B);return x&&null==W[x]&&(W[x]=this.Utils.getInitialLockState()),Ln({},e,{notes:j,selectedNotes:H,locks:W,nextNotesDiff:M});case Wn.UPDATE_LOCK:var X=t.guid,Y=t.lockState,q=Ln({},e.locks);return q[X]=Ln({},this.Utils.getInitialLockState(),q[X],Y),Ln({},e,{locks:q,nextNotesDiff:{}});case Wn.CLEAR_DIRTY:var Q=Ln({},e.dirtyFlagsCollection);return t.guids.forEach(function(e){delete Q[e]}),Ln({},e,{dirtyFlagsCollection:Q,nextNotesDiff:{}});default:return e}}},{key:"Actions",get:function(){var e=this;return{updateNotes:function(t,n,r){var o=n||new At.NoteResultSpec;if(null==r){var u=new Error("locator was unexpectedly null in updateNotes");throw Xn.error(u),u}var i=o.includeContent?t.map(function(e){return Ln({},e,{_marshalledResources:Object(Pt.createResourceMap)(e,r)})}):t,a=e.getState().notes,c=i.filter(function(e){return((a[e.guid]||{}).updateSequenceNum||0)<=(e.updateSequenceNum||0)});e.dispatch({type:Wn.UPDATE_NOTES,notes:c,resultSpec:o})},expungeNotes:function(t){e.dispatch({type:Wn.EXPUNGE_NOTES,guids:t})},expungeNotesSelectively:function(t,n){e.dispatch({type:Wn.EXPUNGE_NOTES,guids:t,predicate:n})},selectNote:function(t,n){e.dispatch({type:Wn.SELECT_NOTE,guid:t,windowId:n})},updateLock:function(t,n){e.dispatch({type:Wn.UPDATE_LOCK,guid:t,lockState:n})}}}},{key:"Utils",get:function(){return{getInitialLockState:function(){return{hasLock:!1,isAcquiringLock:!1,isLockAvailable:!1}}}}}]),t}()),Zn=Jn;function $n(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function er(e){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tr(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){rr(e,t,n[t])})}return e}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function or(e,t){return!t||"object"!==er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ar(e,t,n){return t&&ir(e.prototype,t),n&&ir(e,n),e}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("note.datasource.getnote",function(e){return new Promise(function(t,n){Jn.dataSourceInitialized.then(function(){var n=Jn.getState().notes[e]||null;t(n)}).catch(function(e){n(e)})})}),u.a.register("note.datasource.getselectedguids",jn(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jn.dataSourceInitialized;case 2:return e.abrupt("return",ft.a.uniq(Object.values(Jn.getState().selectedNotes||{})));case 3:case"end":return e.stop()}},e)}))),u.a.register("note.actions.getall",function(){return new Promise(function(e){Jn.dataSourceInitialized.then(function(){e(Jn.getState().notes)})})}),u.a.register("note.actions.getdirty",jn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jn.dataSourceInitialized;case 2:return t=Jn.getState(),e.abrupt("return",Gt(t.notes,t.dirtyFlagsCollection));case 4:case"end":return e.stop()}},e)}))),u.a.register("note.actions.cleardirty",function(){var e=jn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jn.dataSourceInitialized;case 2:Jn.dispatch({type:Wn.CLEAR_DIRTY,guids:t});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),u.a.register("note.actions.expungeNotesLocal",function(){var e=jn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Jn.dataSourceInitialized;case 2:Jn.dispatch({type:Wn.DELETE_LOCAL,guids:t}),u.a.publish("sync.notes");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var sr,fr="SUGAR/PREFERENCE_DATASOURCE";!function(e){e.UPDATE_PREFERENCES="SUGAR/PREFERENCES/UPDATE_PREFERENCES",e.UPDATE_SHORTCUT_EXPANSION="SUGAR/PREFERENCES/UPDATE_SHORTCUT_EXPANSION",e.UPDATE_STACK_SHORTCUT_EXPANSION="SUGAR/PREFERENCES/UPDATE_STACK_SHORTCUT_EXPANSION"}(sr||(sr={}));var lr={shortcuts:{shortcutsArray:[],expanded:!1,expandedStacks:new Set}},pr=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=or(this,ur(t).call(this,lr,"preference",fr,!0))).subscribe=function(){var t=u.a.subscribe("preference",function(t){switch(t.type){case"updatePreferences":return e.Actions.updatePreferences(t.data);case"updateShortcutsExpanded":return e.Actions.updateShortcutsExpanded(t.data);case"updateStackShortcutExpanded":return e.Actions.updateStackShortcutExpanded(t.data.stackName,t.data.expanded)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}(t,b),ar(t,[{key:"initialState",get:function(){return lr}},{key:"Constants",get:function(){return sr}}]),ar(t,[{key:"mapInternalToExternalState",value:function(e){return{shortcuts:this.Utils.parsePreferenceShortcuts(e.shortcuts)}}},{key:"reducer",value:function(e,t){switch(t.type){case sr.UPDATE_PREFERENCES:var n=t.preferences["evernote.shortcuts"]||[],r=this.Utils.getStackShortcuts(n),o=this.Utils.getExpandedStackShortcuts(e.shortcuts);return nr({},e,{shortcuts:nr({},e.shortcuts,{shortcutsArray:n,expandedStacks:new Set(o.filter(function(e){return r.includes(e)}))})});case sr.UPDATE_SHORTCUT_EXPANSION:return nr({},e,{shortcuts:nr({},e.shortcuts,{expanded:t.expanded})});case sr.UPDATE_STACK_SHORTCUT_EXPANSION:var u=new Set(e.shortcuts.expandedStacks);return t.expanded?u.add(t.stackName):u.delete(t.stackName),nr({},e,{shortcuts:nr({},e.shortcuts,{expandedStacks:u})});default:return e}}},{key:"Actions",get:function(){var e=this;return{updatePreferences:function(t){e.dispatch({type:sr.UPDATE_PREFERENCES,preferences:t.preferences||{}})},updateShortcutsExpanded:function(t){e.dispatch({type:sr.UPDATE_SHORTCUT_EXPANSION,expanded:t})},updateStackShortcutExpanded:function(t,n){e.dispatch({type:sr.UPDATE_STACK_SHORTCUT_EXPANSION,stackName:t,expanded:n})}}}},{key:"Utils",get:function(){var e=this;return{parsePreferenceShortcuts:function(t){var n=t.shortcutsArray;if(0===n.length)return{updated:null,shortcuts:[],expanded:e.Utils.getExpanded(t),expandedStacks:e.Utils.getExpandedStackShortcuts(t)};var r=JSON.parse(n[0]).updated,o=[];return ft.a.forEach(n.slice(1),function(e){var t=JSON.parse(e),n=t[0];switch(n){case"Note":o.push({type:n,noteGuid:t[1]});break;case"Notebook":o.push({type:n,notebookGuid:t[1]});break;case"Stack":o.push({type:n,stackName:t[1]})}}),{updated:r,shortcuts:o,expanded:e.Utils.getExpanded(t),expandedStacks:e.Utils.getExpandedStackShortcuts(t)}},getStackShortcuts:function(e){return e.slice(1).reduce(function(e,t){var n=JSON.parse(t);return"Stack"===n[0]&&e.push(n[1]),e},[])},getExpanded:function(e){return e.expanded||!1},getExpandedStackShortcuts:function(e){return tr(e.expandedStacks||new Set)}}}}]),t}()),dr=pr;function br(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function yr(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){br(u,r,o,i,a,"next",e)}function a(e){br(u,r,o,i,a,"throw",e)}i(void 0)})}}function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},u=Object.keys(e);for(r=0;r<u.length;r++)n=u[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(r=0;r<u.length;r++)n=u[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Sr(e){var t=function(e,t){if("object"!==hr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==hr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===hr(t)?t:String(t)}function vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){mr(e,t,n[t])})}return e}function mr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Er(e,t){return!t||"object"!==hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Or(e){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t,n){return t&&kr(e.prototype,t),n&&kr(e,n),e}function wr(e,t){return(wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("preference.actions.getshortcutsarray",function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){$n(u,r,o,i,a,"next",e)}function a(e){$n(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pr.dataSourceInitialized;case 2:return e.abrupt("return",pr.getState().shortcuts.shortcutsArray);case 3:case"end":return e.stop()}},e)})));var Ar,_r="SUGAR/PROFILE_DATASOURCE";!function(e){e.SET_PROFILES="SUGAR/PROFILES/SET_PROFILES",e.SET_USERS_UPDATE_COUNT="SUGAR/PROFILES/SET_USERS_UPDATE_COUNT",e.USER_TO_PROFILE="SUGAR/PROFILES/USER_TO_PROFILE"}(Ar||(Ar={}));var Pr={businessUsersUpdateCount:-1,profiles:{}},Nr=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Er(this,Or(t).call(this,Pr,"profile",_r,!0))).subscribe=function(){var t=u.a.subscribe("profile",function(t){switch(t.type){case"set":return e.Actions.set(t.data);case"setbusinessusersupdatecount":return e.Actions.setBusinessUsersUpdateCount(t.data)}}),n=u.a.subscribe("user",function(t){switch(t.type){case"update":return e.Actions.userToProfile(t.data)}});e.unsubscribeFns=[t,n]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wr(e,t)}(t,b),Tr(t,[{key:"initialState",get:function(){return Pr}},{key:"Constants",get:function(){return Ar}}]),Tr(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Ar.SET_USERS_UPDATE_COUNT:return vr({},e,{businessUsersUpdateCount:t.businessUsersUpdateCount});case Ar.SET_PROFILES:return vr({},e,{profiles:vr({},t.profiles)});case Ar.USER_TO_PROFILE:var n=t.user.id;if(null==n)return e;var r=e.profiles,o=r[n],u=gr(r,[n].map(Sr)),i=gr(e,["profiles"]),a=new Xe.UserProfile(o);return a.id=n,a.name=t.user.name||t.user.email,a.email=t.user.email,a.username=t.user.username,a.photoLastUpdated=t.user.photoLastUpdated,a.photoUrl=t.user.photoUrl,vr({},i,{profiles:vr({},u,mr({},n,a))});default:return e}}},{key:"Actions",get:function(){var e=this;return{set:function(t){e.dispatch({type:Ar.SET_PROFILES,profiles:t})},userToProfile:function(t){e.dispatch({type:Ar.USER_TO_PROFILE,user:t})},setBusinessUsersUpdateCount:function(t){e.dispatch({type:Ar.SET_USERS_UPDATE_COUNT,businessUsersUpdateCount:t})}}}},{key:"Utils",get:function(){return{}}}]),t}()),Rr=Nr;function Ur(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Ir(e){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gr(e,t){return!t||"object"!==Ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jr(e){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dr(e,t,n){return t&&xr(e.prototype,t),n&&xr(e,n),e}function Lr(e,t){return(Lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("profile.actions.getprofiles",yr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nr.dataSourceInitialized;case 2:return e.abrupt("return",Nr.getState().profiles);case 3:case"end":return e.stop()}},e)}))),u.a.register("profile.actions.getbusinessusersupdatecount",yr(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nr.dataSourceInitialized;case 2:return e.abrupt("return",Nr.getState().businessUsersUpdateCount);case 3:case"end":return e.stop()}},e)})));var Kr,Fr="SUGAR/QUICK_SWITCHER_DATASOURCE";(Kr||(Kr={})).SET_RECENT_QUERIES="SUGAR/QUICK_SWITCHER/SET_RECENT_QUERIES";var Br={recentQueries:[]},Mr=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Gr(this,jr(t).call(this,Br,"quickswitcher",Fr,!0))).subscribe=function(){var t=u.a.subscribe("quickswitcher",function(t){switch(t.type){case"set":return e.Actions.setRecentQueries(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lr(e,t)}(t,b),Dr(t,[{key:"initialState",get:function(){return Br}},{key:"Constants",get:function(){return Kr}}]),Dr(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Kr.SET_RECENT_QUERIES:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Cr(e,t,n[t])})}return e}({},e,{recentQueries:t.recentQueries});default:return e}}},{key:"Actions",get:function(){var e=this;return{getRecentQueries:function(){return e.getState().recentQueries},setRecentQueries:function(t){e.dispatch({type:Kr.SET_RECENT_QUERIES,recentQueries:t})}}}}]),t}()),Vr=Mr;function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zr(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Wr(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Yr(e,t,n[t])})}return e}function Yr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qr(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zr(e,t,n){return t&&Jr(e.prototype,t),n&&Jr(e,n),e}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("quickswitcher.actions.getrecentqueries",function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Ur(u,r,o,i,a,"next",e)}function a(e){Ur(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Mr.Actions.getRecentQueries());case 1:case"end":return e.stop()}},e)}))),u.a.register("quickswitcher.actions.setrecentqueries",function(e){return Mr.Actions.setRecentQueries(e),Promise.resolve()});var eo="SUGAR/SEARCH_DATASOURCE",to={EXECUTE_SEARCH_SERVICE:"SUGAR/SEARCH/EXECUTE_SEARCH_SERVICE"},no={results:null},ro=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qr(this,Qr(t).call(this,no,"search",eo,!0))).Constants=to,e.subscribe=function(){var t=u.a.subscribe("search",function(t){switch(t.type){case"findnotes":return e.Actions.findNotes(t.data.filter,t.data.errCb)}}),n=u.a.subscribe("service.search",function(t){switch(t.type){case"fillresults":return e.Actions.fillWithResults(t.data)}});e.unsubscribeFns=[t,n]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(t,b),Zr(t,[{key:"initialState",get:function(){return no}}]),Zr(t,[{key:"mapInternalToExternalState",value:function(e){return e.results}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case to.EXECUTE_SEARCH_SERVICE:if(null==t.results.startIndex||null==t.results.notes||null==e.results||null==e.results.notes||!ft.a.isEqual(e.results.searchedWords,t.results.searchedWords)||!ft.a.isEqual(e.results.stoppedWords,t.results.stoppedWords))return Xr({},e,{results:t.results});var n=t.results.startIndex,r=t.results.notes,o=ft.a.cloneDeep(e.results.notes||[]);return o.splice.apply(o,[n,r.length].concat(Wr(r))),0===o.length?Xr({},e,{results:t.results}):Xr({},e,{results:Xr({},t.results,{notes:o})});default:return e}}},{key:"Actions",get:function(){var e=this;return{findNotes:function(t,n){e.dataSourceReady.then(function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){zr(u,r,o,i,a,"next",e)}function a(e){zr(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u.a.call("note.actions.findNotesMetadata",{filter:t});case 1:case"end":return e.stop()}},e)}))).catch(n())},fillWithResults:function(t){e.dispatch({type:to.EXECUTE_SEARCH_SERVICE,results:t})}}}},{key:"Utils",get:function(){return{validateName:Ut.a.validationWithoutUnique.name}}}]),t}());function oo(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function uo(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){oo(u,r,o,i,a,"next",e)}function a(e){oo(u,r,o,i,a,"throw",e)}i(void 0)})}}function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){co(e,t,n[t])})}return e}function co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function so(e,t){return!t||"object"!==io(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fo(e){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function po(e,t,n){return t&&lo(e.prototype,t),n&&lo(e,n),e}function bo(e,t){return(bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yo,ho=Object(i.default)("ion:sugar:survey");(yo||(yo={})).SET_QUALTRICS_PROMOTIONS="SUGAR/SURVEY/SET_QUALTRICS_PROMOTIONS";var go="SUGAR/SURVEY_DATASOURCE",So={qualtricsPromotions:{}},vo=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=so(this,fo(t).call(this,So,"survey",go,!0))).subscribe=function(){var t=u.a.subscribe("survey",function(t){switch(ho.log("Qualtrics subscribe",t),t.type){case"setQualtricsPromotions":return e.Actions.setQualtricsPromotions(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bo(e,t)}(t,b),po(t,[{key:"initialState",get:function(){return So}},{key:"Constants",get:function(){return yo}}]),po(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case yo.SET_QUALTRICS_PROMOTIONS:var n=t.surveys;return ao({},e,{qualtricsPromotions:ao({},e.qualtricsPromotions,n)});default:return e}}},{key:"Actions",get:function(){var e=this;return{setQualtricsPromotions:function(t){e.dispatch({type:yo.SET_QUALTRICS_PROMOTIONS,surveys:t})}}}}]),t}()),mo=vo;u.a.register("survey.actions.hasPromotions",uo(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!ft.a.isEmpty(vo.getState().qualtricsPromotions));case 1:case"end":return e.stop()}},e)}))),u.a.register("survey.actions.getQualtricsPromotions",uo(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vo.getState().qualtricsPromotions);case 1:case"end":return e.stop()}},e)})));var Eo=n(481);function Oo(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function ko(e){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function To(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){wo(e,t,n[t])})}return e}function wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ao(e,t){return!t||"object"!==ko(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _o(e){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function No(e,t,n){return t&&Po(e.prototype,t),n&&Po(e,n),e}function Ro(e,t){return(Ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Uo,Io=Object(i.default)("ion:sugar:Task"),Co="SUGAR/TASK_DATASOURCE";!function(e){e.EXPUNGE_TASKS="SUGAR/TASK/EXPUNGE_TASKS",e.UPDATE_TASKS="SUGAR/TASK/UPDATE_TASKS",e.SET_TASK_GROUP="SUGAR/TASK/SET_TASK_GROUP",e.SET_TASK_VIEW="SUGAR/TASK/SET_TASK_VIEW"}(Uo||(Uo={}));var Go={tasks:{},taskGroup:Eo.TASK_GROUP.NONE,taskView:Eo.TASK_VIEW.MY_TASKS},jo=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ao(this,_o(t).call(this,Go,"task",Co,!0))).subscribe=function(){var t=u.a.subscribe("task",function(t){switch(Io.log("Task subscriber ",t),t.type){case"updateTask":return e.Actions.updateTasks([t.data]);case"updateTasks":return e.Actions.updateTasks(t.data);case"expungeTask":return e.Actions.expungeTasks([t.data]);case"expungeTasks":return e.Actions.expungeTasks(t.data);case"setGroup":return e.Actions.setGroup(t.data);case"setView":return e.Actions.setView(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ro(e,t)}(t,b),No(t,[{key:"initialState",get:function(){return Go}},{key:"Constants",get:function(){return Uo}}]),No(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Uo.UPDATE_TASKS:var n=t.tasks,r=To({},e.tasks);return n.reduce(function(e,t){var n=t.guid;if(null==n)return e;var r=To({},e[n]||{},t);return e[n]=r,e},r),To({},e,{tasks:r});case Uo.EXPUNGE_TASKS:var o=t.guids,u=To({},e.tasks);return o.reduce(function(e,t){return delete e[t],e},u),To({},e,{tasks:u});case Uo.SET_TASK_GROUP:return To({},e,{taskGroup:t.taskGroup});case Uo.SET_TASK_VIEW:return To({},e,{taskView:t.taskView});default:return e}}},{key:"Actions",get:function(){var e=this;return{updateTasks:function(t){e.dispatch({type:Uo.UPDATE_TASKS,tasks:t})},expungeTasks:function(t){e.dispatch({type:Uo.EXPUNGE_TASKS,guids:t})},setGroup:function(t){e.dispatch({type:Uo.SET_TASK_GROUP,taskGroup:t})},setView:function(t){e.dispatch({type:Uo.SET_TASK_VIEW,taskView:t})}}}}]),t}()),xo=jo;u.a.register("task.datasource.getTask",function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Oo(u,r,o,i,a,"next",e)}function a(e){Oo(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",jo.getState().tasks[t]);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var Do,Lo=n(384),Ko=n(465),Fo=(n(59),function(e,t){return ft.a.find(e.sharedNotebooks,["recipientUserId",t])});function Bo(e){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Vo(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Ho(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){Vo(u,r,o,i,a,"next",e)}function a(e){Vo(u,r,o,i,a,"throw",e)}i(void 0)})}}function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Wo(e,t,n[t])})}return e}function Wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xo(e,t){return!t||"object"!==Bo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yo(e){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qo(e,t,n){return t&&qo(e.prototype,t),n&&qo(e,n),e}function Jo(e,t){return(Jo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(Do||(Do={})).UPDATE_THREADS_FROM_SERVICE="SUGAR/THREADS/UPDATE_THREADS_FROM_SERVICE";var Zo="SUGAR/THREADS_DATASOURCE",$o={threads:{}},eu=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Xo(this,Yo(t).call(this,$o,"threads",Zo,!0))).subscribe=function(){var t=u.a.subscribe("service.threads",function(t){switch(t.type){case"update":e.ServiceActions.update(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jo(e,t)}(t,b),Qo(t,[{key:"initialState",get:function(){return $o}},{key:"Constants",get:function(){return Do}}]),Qo(t,[{key:"mapInternalToExternalState",value:function(e){return zo({},e.threads)}},{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case Do.UPDATE_THREADS_FROM_SERVICE:return{threads:zo({},e.threads,t.threads)};default:return e}}},{key:"Actions",get:function(){var e=this;return{getThreadForParticipants:function(){var t=Ho(regeneratorRuntime.mark(function t(n){var r,o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.call("identity.actions.getidentitiesforusers",n);case 2:if(r=t.sent,o=[],i=!1,r.forEach(function(e){e.id||(i=!0),o.push(e.id)}),!i){t.next=8;break}return t.abrupt("return",null);case 8:return a=null,Object.keys(e.state.threads).forEach(function(t){var n=e.state.threads[t];if(n&&n.participantIds){var r=n.participantIds,u=!1;o.forEach(function(e){-1===r.indexOf(e)&&(u=!0)});var i=!1;r.forEach(function(e){-1===o.indexOf(e)&&(i=!0)}),u||i||(a=n)}}),t.abrupt("return",a);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),createMessageThread:function(){var e=Ho(regeneratorRuntime.mark(function e(t,n){var r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.call("identity.actions.getidentitiesforusers",t);case 3:return r=e.sent,o=[],t.forEach(function(e){for(var t=!1,n=0;n<r.length;n++){var u=r[n],i="number"==typeof e&&u.userId===e||"string"==typeof e&&u.contact&&u.contact.id===e;if(u.contact&&i){t=!0,o.push(u.contact);break}}t||o.push({type:Xe.ContactType.EVERNOTE,id:String(e)})}),i=new Ko.CreateMessageThreadSpec({message:n,participants:o,groupThread:o.length>2}),e.next=9,u.a.call("workchat.actions.createMessageThread",{threadSpec:i});case 9:u.a.publish("sync.actions.syncworkchat"),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t,n){return e.apply(this,arguments)}}(),sendMessage:function(){var t=Ho(regeneratorRuntime.mark(function t(n,r,o,i){var a,c,s,f,l,p,d,b,y,h,g,S,v;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.call("user.actions.getactiveuser");case 3:if((a=t.sent)&&a.id){t.next=6;break}throw new Error("#sendMessage: no user provided");case 6:if(!(c=Object(Lo.d)())){t.next=13;break}return t.next=10,u.a.call("user.actions.getvaultuserid");case 10:t.t0=t.sent,t.next=14;break;case 13:t.t0=a.id;case 14:if(s=t.t0,!c){t.next=21;break}return t.next=18,u.a.call("business.getshard");case 18:t.t1=t.sent,t.next=22;break;case 21:t.t1=a.shardId;case 22:return f=t.t1,(l=Mo(n)).push(a.id||0),l=ft.a.uniq(l),t.next=28,e.Actions.getThreadForParticipants(l);case 28:if(p=t.sent,d=function(t,n,a,c){var d=new Ko.MessageAttachment({type:t,title:a,guid:o.guid,shardId:i?n:f,userId:i?c:s}),b=new Ko.Message({body:r,attachments:[d]});return p?(b.messageThreadId=p.id,u.a.call("workchat.actions.sendMessageToThread",{message:b})):e.Actions.createMessageThread(l,b)},!o){t.next=48;break}if(y=a.shardId,h=a.id,!o.notebookGuid){t.next=40;break}return b=Ko.MessageAttachmentType.NOTE,t.next=37,u.a.call("attachments.actions.getattachment",o.guid);case 37:return(g=t.sent)&&(y=g.shardId,h=g.senderId),t.abrupt("return",d(b,y,o.title,h));case 40:return b=Ko.MessageAttachmentType.NOTEBOOK,t.next=43,u.a.call("linkednotebook.actions.getlinkednotebook",o.guid);case 43:return S=t.sent,v=Fo(o,h),S&&(y=S.shardId),v&&(h=v.sharerUserId),t.abrupt("return",d(b,y,o.name,h));case 48:t.next=53;break;case 50:throw t.prev=50,t.t2=t.catch(0),t.t2;case 53:case"end":return t.stop()}},t,null,[[0,50]])}));return function(e,n,r,o){return t.apply(this,arguments)}}()}}},{key:"ServiceActions",get:function(){var e=this;return{update:function(t){if(t){var n={};t.forEach(function(e){var t=e.messageThread,r=e.lastReadMessageId;n[t.id]=zo({},t,{lastReadMessageId:r||null})}),e.dispatch({type:Do.UPDATE_THREADS_FROM_SERVICE,threads:n})}}}}}]),t}()),tu=eu;function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ru(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function ou(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){ru(u,r,o,i,a,"next",e)}function a(e){ru(u,r,o,i,a,"throw",e)}i(void 0)})}}function uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){iu(e,t,n[t])})}return e}function iu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function au(e,t){return!t||"object"!==nu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cu(e){return(cu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fu(e,t,n){return t&&su(e.prototype,t),n&&su(e,n),e}function lu(e,t){return(lu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a.register("threads.actions.sendmessage",function(){var e=Ho(regeneratorRuntime.mark(function e(t){var n,r,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userIds,r=t.message,o=t.attachment,u=t.isExternal,e.next=3,eu.Actions.sendMessage(n,r,o,u);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var pu="SUGAR/USER_DATASOURCE",du={UPDATE_SYNC_STATE:"SUGAR/USERS/UPDATE_SYNC_STATE",UPDATE_USER:"SUGAR/USERS/UPDATE_USER",UPDATE_VAULT_USER:"SUGAR/USERS/UPDATE_VAULT_USER",UPDATE_BUSINESS_SHARD:"SUGAR/USERS/UPDATE_BUSINESS_SHARD",UPDATE_USER_LAST_UPDATED:"SUGAR/USERS/UPDATE_USER_LAST_UPDATED"},bu={user:null,vaultUser:null,vaultUserId:null,businessShardId:null,userLastUpdated:0},yu=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=au(this,cu(t).call(this,bu,"user",pu,!0))).subscribe=function(){var t=u.a.subscribe("user",function(t){switch(t.type){case"update":return e.Actions.update(t.data);case"setvaultuser":return e.Actions.updateVaultUser(t.data);case"setbusinessshard":return e.Actions.updateBusinessShard(t.data);case"setUserLastUpdated":return e.Actions.updateUserLastUpdated(t.data)}});e.unsubscribeFns=[t]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lu(e,t)}(t,b),fu(t,[{key:"initialState",get:function(){return bu}},{key:"Constants",get:function(){return du}}]),fu(t,[{key:"reducer",value:function(e,t){switch(Object.freeze(e),t.type){case du.UPDATE_USER:return uu({},e,{user:t.user});case du.UPDATE_VAULT_USER:return uu({},e,{vaultUserId:ft.a.isEmpty(t.vaultUser)?bu.vaultUserId:t.vaultUser.id,vaultUser:t.vaultUser});case du.UPDATE_BUSINESS_SHARD:return uu({},e,{businessShardId:t.businessShardId});case du.UPDATE_USER_LAST_UPDATED:return uu({},e,{userLastUpdated:t.userLastUpdated});default:return e}}},{key:"Actions",get:function(){var e=this;return{getActiveUser:function(){var t=ou(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getState().user);case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getActiveUserId:function(){var t=ou(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getState(),null!=(r=n.user)){t.next=3;break}return t.abrupt("return",null);case 3:return t.abrupt("return",r.id);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getVaultUser:function(){var t=ou(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getState().vaultUserId);case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),update:function(t){e.dispatch({type:du.UPDATE_USER,user:t})},updateVaultUser:function(t){e.dispatch({type:du.UPDATE_VAULT_USER,vaultUser:t})},updateBusinessShard:function(t){e.dispatch({type:du.UPDATE_BUSINESS_SHARD,businessShardId:t})},updateUserLastUpdated:function(t){e.dispatch({type:du.UPDATE_USER_LAST_UPDATED,userLastUpdated:t})}}}}]),t}()),hu=yu;function gu(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}u.a.register("user.actions.getactiveuser",ou(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.dataSourceInitialized;case 2:return e.abrupt("return",yu.Actions.getActiveUser());case 3:case"end":return e.stop()}},e)}))),u.a.register("user.actions.getactiveuserid",ou(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.dataSourceInitialized;case 2:return e.abrupt("return",yu.Actions.getActiveUserId());case 3:case"end":return e.stop()}},e)}))),u.a.register("user.actions.getvaultuserid",ou(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.dataSourceInitialized;case 2:return e.abrupt("return",yu.Actions.getVaultUser());case 3:case"end":return e.stop()}},e)}))),u.a.register("user.actions.getUserLastUpdated",ou(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yu.dataSourceInitialized;case 2:return e.abrupt("return",yu.getState().userLastUpdated||0);case 3:case"end":return e.stop()}},e)}))),n.d(t,"clearTables",function(){return ku}),n.d(t,"logDataSources",function(){return Tu}),n.d(t,"logCompressedDataSources",function(){return wu}),n.d(t,"Attachments",function(){return R}),n.d(t,"CommEngine",function(){return V}),n.d(t,"Config",function(){return re}),n.d(t,"Flow",function(){return Re}),n.d(t,"HVA",function(){return ze}),n.d(t,"Identity",function(){return at}),n.d(t,"LinkedNotebook",function(){return wt}),n.d(t,"Note",function(){return Zn}),n.d(t,"Notebook",function(){return gn}),n.d(t,"Preference",function(){return dr}),n.d(t,"Profile",function(){return Rr}),n.d(t,"QuickSwitcher",function(){return Vr}),n.d(t,"Survey",function(){return mo}),n.d(t,"Tag",function(){return Cn}),n.d(t,"Task",function(){return xo}),n.d(t,"Threads",function(){return tu}),n.d(t,"User",function(){return hu}),n.d(t,"Workspace",function(){return Zt});var Su,vu,mu=Object(i.default)("ion:sugar"),Eu={Attachments:R,CommEngine:V,Config:re,Flow:Re,HVA:ze,Identity:at,LinkedNotebook:wt,Note:Zn,Notebook:gn,Preference:dr,Profile:Rr,Promotion:ve,QuickSwitcher:Vr,Search:ro,Survey:mo,Tag:Cn,Task:xo,Threads:tu,User:hu,Workspace:Zt};t.default=Eu;function Ou(){return(Ou=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){gu(u,r,o,i,a,"next",e)}function a(e){gu(u,r,o,i,a,"throw",e)}i(void 0)})}}(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!vu){e.next=5;break}return b.reset(),t=b.getInstances().map(function(e){return e.deInit()}),e.next=5,Promise.all(t);case 5:Su="",vu=null;case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ku(){b.getInstances().forEach(function(e){e.deleteState(Su)})}function Tu(){mu.log("DataSource getInstances returns",b.getInstances())}function wu(){var e={};b.getInstances().forEach(function(t){r.default.get(Object(o.a)(t.namespace),t.tableName).then(function(n){for(var r={},o=Object.keys(n),u=0;u<o.length;u++){var i=o[u];Array.isArray(n[i])?r[i]=n[i].length:r[i]=Object.keys(n[i]).length}e["".concat(t.namespace,"_").concat(t.tableName)]=r})}),mu.log("logCompressedDataSources returns",JSON.stringify(e))}u.a.register("sugar.init",function(e){return vu?String(e)!==Su?Promise.reject():vu:vu=new Promise(function(t){Su=String(e);var n=b.getInstances().map(function(e){return e.init(Su)});Promise.all(n).then(function(){return t()})})}),u.a.register("sugar.deinit",function(){return Ou.apply(this,arguments)})},519:function(e,t,n){"use strict";n.r(t);var r=n(29),o=n(107),u=n(22);function i(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function a(e){i(u,r,o,a,c,"next",e)}function c(e){i(u,r,o,a,c,"throw",e)}a(void 0)})}}var c=Object(u.default)("ion:cupboard:migration"),s=[],f=function(){var e=a(regeneratorRuntime.mark(function e(t,n,r){var o,u,i,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){var e=o(t),r=o(n);if(-1===r)throw new Error("No migration object found for target version ".concat(n));if(e>r)throw new Error("Downgrade operation is not supported. ".concat(t," ").concat(n));if(e!==r)return i(u(e,r));c.warn("Migration path called for same current and target versions ".concat(t," ").concat(n))},f=function(){return(f=a(regeneratorRuntime.mark(function e(o){var u,i,a,s,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.info("Starting cupboard upgrade from ".concat(t," to ").concat(n)),u=!0,i=!1,a=void 0,e.prev=4,s=o[Symbol.iterator]();case 6:if(u=(f=s.next()).done){e.next=13;break}return l=f.value,e.next=10,l.upgradeFn(r);case 10:u=!0,e.next=6;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),i=!0,a=e.t0;case 19:e.prev=19,e.prev=20,u||null==s.return||s.return();case 22:if(e.prev=22,!i){e.next=25;break}throw a;case 25:return e.finish(22);case 26:return e.finish(19);case 27:c.info("Finished cupboard upgrade from ".concat(t," to ").concat(n));case 28:case"end":return e.stop()}},e,null,[[4,15,19,27],[20,,22,26]])}))).apply(this,arguments)},i=function(e){return f.apply(this,arguments)},u=function(e,t){return s.slice(e+1,t+1)},o=function(e){return s.findIndex(function(t){return t.key===e})},e.abrupt("return",l());case 6:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),l={key:"ION_9071",upgradeFn:function(e){if(null==e||""===e)return Promise.resolve();return o.a.call("cupboard.clearNamespace",{namespace:e})}};s.push(l);var p=f,d=n(43),b=n.n(d);function y(e,t,n,r,o,u,i){try{var a=e[u](i),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var u=e.apply(t,n);function i(e){y(u,r,o,i,a,"next",e)}function a(e){y(u,r,o,i,a,"throw",e)}i(void 0)})}}var g=Object(u.default)("ion:cupboard"),S=Object(r.b)().objectPersistence,v=function(e,t){return null==e?t:"".concat(e,"_").concat(t)},m={clear:function(){return new Promise(function(e){S.clear().then(function(){return e()}).catch(g.error)})},clearNamespace:function(){var e=h(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.keys();case 2:return n=e.sent,r=n.filter(function(e){return e.startsWith(t)}),e.next=6,Promise.all(r.map(function(e){return S.removeItem(e)}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),get:function(e,t){return new Promise(function(n){var r=v(e,t);S.getItem(r).then(function(e){return n(e)}).catch(function(e){return g.error(e)})})},set:function(){var e=h(regeneratorRuntime.mark(function e(t,n,r){var o,u,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.length>3&&void 0!==i[3]&&i[3],e.next=3,this.get(t,"SCHEMA_VERSION");case 3:if(u=e.sent,o||u===b.a.SCHEMA_VERSION){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,S.setItem(v(t,n),r);case 8:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),migrate:function(){var e=h(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t,"SCHEMA_VERSION");case 2:if(n=e.sent,e.prev=3,n===b.a.SCHEMA_VERSION){e.next=7;break}return e.next=7,p(n,b.a.SCHEMA_VERSION,t);case 7:e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(3),g.error("Failed to migrate to version ".concat(b.a.SCHEMA_VERSION," from ").concat(n," error ").concat(JSON.stringify(e.t0),". Clearing cupboard.")),e.next=14,this.clear();case 14:return e.prev=14,e.next=17,this.set(t,"SCHEMA_VERSION",b.a.SCHEMA_VERSION,!0);case 17:return e.finish(14);case 18:case"end":return e.stop()}},e,this,[[3,9,14,18]])}));return function(t){return e.apply(this,arguments)}}()};o.a.register("cupboard.get",function(e){var t=e.namespace,n=e.key;return m.get(t,n)}),o.a.register("cupboard.set",function(e){var t=e.namespace,n=e.key,r=e.value,o=e.forceWrite;return m.set(t,n,r,o)}),o.a.register("cupboard.clear",function(){return m.clear()}),o.a.register("cupboard.clearNamespace",function(e){var t=e.namespace;return m.clearNamespace(t)}),o.a.register("cupboard.migrate",function(e){var t=e.namespace;return m.migrate(t)});t.default=m},555:function(e,t,n){var r,o,u;o=[],void 0===(u="function"==typeof(r=function(){function e(e,t){for(prop in t)e.hasOwnProperty(prop)||(e[prop]=t[prop])}var t="_PLURAL";return function(n){var r=n||{};e(r,{locale:"en",autoPlurals:!0,strict:!0});var o={ach:function(e){return 0},af:function(e){return 1!=e?1:0},ak:function(e){return e>1?1:0},am:function(e){return e>1?1:0},an:function(e){return 1!=e?1:0},ar:function(e){return 0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},arn:function(e){return e>1?1:0},ast:function(e){return 1!=e?1:0},ay:function(e){return 0},az:function(e){return 1!=e?1:0},be:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},bg:function(e){return 1!=e?1:0},bn:function(e){return 1!=e?1:0},bo:function(e){return 0},br:function(e){return e>1?1:0},bs:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},ca:function(e){return 1!=e?1:0},cgg:function(e){return 0},cs:function(e){return 1==e?0:e>=2&&e<=4?1:2},csb:function(e){return 1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},cy:function(e){return 1==e?0:2==e?1:8!=e&&11!=e?2:3},da:function(e){return 1!=e?1:0},de:function(e){return 1!=e?1:0},dz:function(e){return 0},el:function(e){return 1!=e?1:0},en:function(e){return 1!=e?1:0},eo:function(e){return 1!=e?1:0},es:function(e){return 1!=e?1:0},"es-ar":function(e){return 1!=e?1:0},et:function(e){return 1!=e?1:0},eu:function(e){return 1!=e?1:0},fa:function(e){return 0},fi:function(e){return 1!=e?1:0},fil:function(e){return e>1?1:0},fo:function(e){return 1!=e?1:0},fr:function(e){return e>1?1:0},fur:function(e){return 1!=e?1:0},fy:function(e){return 1!=e?1:0},ga:function(e){return 1==e?0:2==e?1:e<7?2:e<11?3:4},gl:function(e){return 1!=e?1:0},gu:function(e){return 1!=e?1:0},gun:function(e){return e>1?1:0},ha:function(e){return 1!=e?1:0},he:function(e){return 1!=e?1:0},hi:function(e){return 1!=e?1:0},hy:function(e){return 0},hr:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},hu:function(e){return 1!=e?1:0},ia:function(e){return 1!=e?1:0},id:function(e){return 0},is:function(e){return e%10!=1||e%100==11},it:function(e){return 1!=e?1:0},ja:function(e){return 0},jv:function(e){return 0!=e?1:0},ka:function(e){return 0},kk:function(e){return 0},km:function(e){return 0},kn:function(e){return 1!=e?1:0},ko:function(e){return 0},ku:function(e){return 1!=e?1:0},kw:function(e){return 1==e?0:2==e?1:3==e?2:3},ky:function(e){return 0},lb:function(e){return 1!=e},ln:function(e){return e>1?1:0},lo:function(e){return 0},lt:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2},lv:function(e){return e%10==1&&e%100!=11?0:0!=e?1:2},mfe:function(e){return e>1?1:0},mg:function(e){return e>1?1:0},mi:function(e){return e>1?1:0},mk:function(e){return 1==e||e%10==1?0:1},ml:function(e){return 1!=e?1:0},mn:function(e){return 1!=e?1:0},mr:function(e){return 1!=e?1:0},ms:function(e){return 0},mt:function(e){return 1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3},nah:function(e){return 1!=e?1:0},nap:function(e){return 1!=e?1:0},nb:function(e){return 1!=e?1:0},ne:function(e){return 1!=e?1:0},nl:function(e){return 1!=e?1:0},se:function(e){return 1!=e?1:0},nn:function(e){return 1!=e?1:0},no:function(e){return 1!=e?1:0},nso:function(e){return 1!=e?1:0},oc:function(e){return e>1?1:0},or:function(e){return 1!=e?1:0},ps:function(e){return 1!=e?1:0},pa:function(e){return 1!=e?1:0},pap:function(e){return 1!=e?1:0},pl:function(e){return 1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},pms:function(e){return 1!=e?1:0},pt:function(e){return 1!=e?1:0},"pt-br":function(e){return e>1?1:0},rm:function(e){return 1!=e},ro:function(e){return 1==e?0:0==e||e%100>0&&e%100<20?1:2},ru:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},sco:function(e){return 1!=e?1:0},si:function(e){return 1!=e?1:0},sk:function(e){return 1==e?0:e>=2&&e<=4?1:2},sl:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0},so:function(e){return 1!=e?1:0},son:function(e){return 0},sq:function(e){return 1!=e?1:0},sr:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},su:function(e){return 0},sw:function(e){return 1!=e?1:0},sv:function(e){return 1!=e?1:0},ta:function(e){return 1!=e?1:0},te:function(e){return 1!=e?1:0},tg:function(e){return 1!=e?1:0},ti:function(e){return e>1?1:0},th:function(e){return 0},tk:function(e){return 1!=e?1:0},tr:function(e){return 0},tt:function(e){return 0},ug:function(e){return 0},uk:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},ur:function(e){return 1!=e?1:0},uz:function(e){return 0},vi:function(e){return 0},wa:function(e){return e>1?1:0},zh:function(e){return 0},"zh-personal":function(e){return e>1?1:0}};this.setLocale=function(e){this.plural=o[e]},this.format=function(n,u,i){if("object"!=typeof u)throw new TypeError("'params' is not a hash");if(void 0!==i&&"object"!=typeof i)throw new TypeError("'options' is not a hash");var a="locale"in(i=i||{})?o[i.locale]||o.en:this.plural;e(i,r);for(var c=!!i.strict,s=!!i.autoPlurals,f=i.callback,l=n.split(/([\{\}])/),p=[""],d=0,b=0,y=l.length;b<y;b++){var h=l[b];if("{"!=h)if("}"!=h)p[p.length-1]+=h;else{if(--d<0)throw new SyntaxError("Unmatched } found");var g,S,v=p.pop(),m=v.indexOf(":");if(c&&0==m)throw new TypeError("Empty placeholder name");if(!((g=-1==m?v:v.substr(0,m))in u)){var E=g.indexOf(t);if(s&&-1!=E&&E==g.length-t.length){var O=g.substr(0,E);if(!(O in u))if(f)u[O]=f(O);else if(c)throw new TypeError("Neither '"+g+"' nor '"+O+"' are defined");var k=parseInt(u[O]);if(k!=u[O]||k<0){if(c)throw new RangeError("Value of '"+O+"' is not a zero or positive integer number");k=0}u[g]=a(k)}else if(f)u[g]=f(g);else if(c)throw new TypeError("'"+g+"' not defined")}if(-1==m)S=u[g];else{var T=v.length;if(c&&m==T-1)throw new TypeError("Empty list of variants");var w=parseInt(u[g]);if(w!=u[g]||w<0){if(c)throw new RangeError("Value of '"+g+"' is not a zero or positive integer number");w=0}for(var A=0,_=m+1,P=T,N=-1;-1!=(N=v.indexOf("|",N+1));)++A<=w?_=N+1:A==w+1&&(P=N);S=v.substr(_,P-_)}p[p.length-1]+=S}else d++,p.push("")}if(d>0)throw new SyntaxError("Unmatched { found");return p[0]},this.setLocale(r.locale||"en")}})?r.apply(t,o):r)||(e.exports=u)}}]);