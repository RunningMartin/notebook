# Nginx学习笔记—性能优化

## 优化方向

### 从软件层面提高硬件使用效率

- 增大CPU使用效率：
- 增大内存使用效率
- 增大磁盘IO的利用率
- 增大网络带宽的利用率

### 提高硬件规格

- 网卡
- 磁盘
- CPU
- 内存

### 超出硬件性能上限后采用DNS，构建集群

## CPU使用

### 如何增大Nginx使用CPU的有效时长

- 使用全部CPU资源
  - master-worker多进程结构
  - 优化方案：worker进程数量应大于等于CPU核数
- Nginx进程间不做无用功，浪费CPU资源
  - `worker`进程不能再繁忙时，主动让出CPU。
    - `worker`进程间发生争抢，造成资源损耗：`worker`进程数==`CPU`核数。
    - `worker`进程调用API导致主动让出CPU：拒绝类似的第三方模块。
- 不被其他进程争抢资源
  - 提升优先级，占用更长的时间。
  - 减少操作系统上消耗资源的非Nginx进程。

相应的指令：

- `worker_processes number|auto`：配置`worker`进程数，默认为`1`，为`auto`时，会自动匹配。

### 进程切换

一个CPU核心上

